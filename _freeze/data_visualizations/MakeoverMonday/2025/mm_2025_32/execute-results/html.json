{
  "hash": "e8e257dbc48a525587a1e5e3c78d33b4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"The economics of corruption perceptions: structure vs change, 2012-2024\"\nsubtitle: \"How economic development shapes corruption perceptions, yet dramatic improvements remain possible\"\ndescription: \"A comprehensive analysis of global corruption perceptions revealing how economic development strongly predicts governance quality, while individual countries can still achieve dramatic improvements. Using World Bank income classifications and 13 years of Transparency International data, this Makeover Monday project transforms a static table into an engaging dual-chart story showing both structural patterns and exceptional cases of anti-corruption progress across 180+ countries.\"\nauthor: \"Steven Ponce\"\ndate: \"2025-08-05\" \ncategories: [\"MakeoverMonday\", \"Data Visualization\", \"R Programming\", \"2025\"]   \ntags: [\n  \"corruption-perceptions-index\",\n  \"transparency-international\", \n  \"world-bank-income-groups\",\n  \"governance-analysis\",\n  \"economic-development\",\n  \"beeswarm-plot\",\n  \"dumbbell-chart\",\n  \"ggplot2\",\n  \"data-transformation\",\n  \"comparative-analysis\",\n  \"global-governance\",\n  \"anti-corruption\",\n  \"policy-insights\"\n]\nimage: \"thumbnails/mm_2025_32.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                      \n  cache: true                                       \n  error: false\n  message: false\n  warning: false\n  eval: true\n---\n\n\n\n### Original\n\nThe original visualization **Corruption Perceptions Index (CPI)** comes from [Our orld in Data](https://ourworldindata.org/grapher/ti-corruption-perception-index?tab=table&time=earliest..2024&country=~NZL)\n\n<!-- ![Original visualization](https://raw.githubusercontent.com/poncest/MakeoverMonday/refs/heads/master/2025/Week_32/original_chart.png) -->\n ![Original visualization](https://raw.githubusercontent.com/poncest/MakeoverMonday/refs/heads/master/2025/Week_32/original_chart.png)\n\n\n### Makeover\n\n![Two-panel chart showing corruption perceptions by income level. Left panel: beeswarm plot reveals higher-income countries (orange dots) cluster at better corruption scores (60-90), while lower-income countries (blue dots) spread across worse scores (10-60). Right panel: The dumbbell chart shows the largest changes from 2012 to 2024, with Seychelles leading at a +20-point improvement and Estonia at a +12-point improvement, demonstrating that countries across all income levels can achieve dramatic anti-corruption progress.](mm_2025_32.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: load\n#| warning: false\n#| message: false\n#| results: \"hide\"\n\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\n  if (!require(\"pacman\")) install.packages(\"pacman\")\n  pacman::p_load(\ntidyverse,      # Easily Install and Load the 'Tidyverse'\n  ggtext,         # Improved Text Rendering Support for 'ggplot2'\n  showtext,       # Using Fonts More Easily in R Graphs\n  scales,         # Scale Functions for Visualization\n  glue,           # Interpreted String Literals\n  ggbeeswarm,     # Categorical Scatter (Violin Point) Plots\n  patchwork       # The Composer of Plots\n  )\n})\n\n### |- figure size ----\ncamcorder::gg_record(\n    dir    = here::here(\"temp_plots\"),\n    device = \"png\",\n    width  =  12,\n    height =  10,\n    units  = \"in\",\n    dpi    = 320\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n````\n:::\n\n\n#### 2. Read in the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: read\n#| include: true\n#| eval: true\n#| warning: false\n#|\ncpi_raw <- readxl::read_excel(\n  here::here('data/MakeoverMonday/2025/Corruption Perception Index.xlsx')) |> \n  janitor::clean_names()\n```\n````\n:::\n\n\n#### 3. Examine the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: examine\n#| include: true\n#| eval: true\n#| results: 'hide'\n#| warning: false\n\nglimpse(cpi_raw)\nskimr::skim(cpi_raw)\n```\n````\n:::\n\n\n#### 4. Tidy Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: tidy\n#| warning: false\n\n# Data cleaning and preparation\ncpi_clean <- cpi_raw |>\n  filter(!is.na(corruption_perceptions_index)) |>\n  filter(year >= 2012, year <= 2024)\n\n# Helper function to assign World Bank income groups (FY2024 classification)\ncreate_income_groups <- function(data) {\n  data |>\n    mutate(\n      income_group = case_when(\n        # ---- High Income Countries (based on WB FY2024) ----\n        code %in% c(\n          # Western Europe & North America\n          \"DNK\", \"NOR\", \"SWE\", \"CHE\", \"SGP\", \"NZL\", \"FIN\", \"DEU\", \"NLD\",\n          \"LUX\", \"AUT\", \"AUS\", \"CAN\", \"USA\", \"GBR\", \"BEL\", \"JPN\", \"FRA\",\n          \"IRL\", \"ISL\", \"ESP\", \"ITA\", \"KOR\", \"ISR\", \n          # Eastern Europe (High Income)\n          \"SVN\", \"CZE\", \"EST\", \"SVK\", \"PRT\", \"POL\", \"LTU\", \"LVA\", \"HUN\", \n          \"HRV\", \"GRC\", \"CYP\", \"MLT\",\n          # Other High Income\n          \"URY\", \"CHL\", \"PAN\", \"ARE\", \"QAT\", \"KWT\", \"BHR\", \"OMN\",\n          \"SAU\", \"BRB\", \"TTO\"\n        ) ~ \"High\\nIncome\",\n        \n        # ---- Upper Middle Income ----\n        code %in% c(\n          # Latin America\n          \"ARG\", \"MYS\", \"THA\", \"MEX\", \"CRI\", \"BRA\", \"COL\", \"PER\", \"ECU\", \"DOM\",\n          # Europe & Central Asia\n          \"ROU\", \"BGR\", \"TUR\", \"MNE\", \"SRB\", \"MKD\", \"ALB\", \"BIH\", \"ARM\", \"GEO\", \n          \"AZE\", \"KAZ\", \"BLR\",\n          # Other Upper Middle\n          \"CHN\", \"RUS\", \"ZAF\", \"BWA\", \"NAM\", \"JAM\", \"LBN\", \"JOR\", \"TUN\", \n          \"DZA\", \"IRQ\", \"IRN\", \"LBY\", \"GAB\"\n        ) ~ \"Upper Middle\\nIncome\",\n        \n        # ---- Lower Middle Income ----\n        code %in% c(\n          # South & East Asia\n          \"IND\", \"IDN\", \"PHL\", \"VNM\", \"BGD\", \"PAK\", \"LKA\", \"NPL\", \"KHM\",\n          \"LAO\", \"MMR\", \"MNG\",\n          # Europe & Central Asia\n          \"UZB\", \"KGZ\", \"TJK\", \"UKR\", \"MDA\", \n          # Middle East & North Africa\n          \"MAR\", \"EGY\", \"PSE\", \"SYR\", \"YEM\", \"SDN\", \"DJI\",\n          # Latin America\n          \"BOL\", \"PRY\", \"GTM\", \"HND\", \"NIC\", \"SLV\", \"GUY\", \"SUR\",\n          # Sub-Saharan Africa\n          \"KEN\", \"TZA\", \"UGA\", \"RWA\", \"ZMB\", \"AGO\", \"CIV\", \"GHA\", \n          \"CMR\", \"SEN\", \"NGA\", \"BEN\"\n        ) ~ \"Lower Middle\\nIncome\",\n        \n        # ---- Default: Low Income ----\n        TRUE ~ \"Low\\nIncome\"\n      ),\n      # Create ordered factor for logical display\n      income_group = factor(\n        income_group,\n        levels = c(\"Low\\nIncome\", \"Lower Middle\\nIncome\", \n                   \"Upper Middle\\nIncome\", \"High\\nIncome\"),\n        ordered = TRUE\n      )\n    )\n}\n\n# Apply income classification\ncpi_with_income <- cpi_clean |>\n  create_income_groups()\n\n# Calculate country trends for dumbbell chart\ncountry_trends <- cpi_with_income |>\n  group_by(entity) |>\n  filter(any(year == 2012) & any(year == 2024)) |>\n  summarise(\n    trend = corruption_perceptions_index[year == 2024][1] - corruption_perceptions_index[year == 2012][1],\n    latest_score = corruption_perceptions_index[year == 2024][1],\n    earliest_score = corruption_perceptions_index[year == 2012][1],\n    income_group = first(income_group),\n    .groups = \"drop\"\n  ) |>\n  filter(!is.na(trend), !is.na(latest_score), !is.na(earliest_score))\n\n# Beeswarm plot data\nlatest_data_income <- cpi_with_income |>\n  filter(year == 2024) |>\n  arrange(desc(corruption_perceptions_index))\n\n# Dumbbell plot data\nbiggest_movers <- country_trends |>\n  filter(abs(trend) >= 5) |>\n  arrange(desc(trend)) |>\n  slice_head(n = 20) |>\n  mutate(\n    income_abbrev = case_when(\n      income_group == \"High\\nIncome\" ~ \"HI\",\n      income_group == \"Upper Middle\\nIncome\" ~ \"UMI\",\n      income_group == \"Lower Middle\\nIncome\" ~ \"LMI\",\n      income_group == \"Low\\nIncome\" ~ \"LI\",\n      TRUE ~ \"Unknown\"\n    ),\n    entity_with_income = glue(\"{entity} ({income_abbrev})\"),\n    entity_short = if_else(\n      nchar(entity_with_income) > 25,\n      glue(\"{str_sub(entity, 1, 18)}... ({income_abbrev})\"),\n      entity_with_income\n    ),\n    entity_short = fct_reorder(entity_short, latest_score)\n  )\n```\n````\n:::\n\n\n#### 5. Visualization Parameters\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: params\n#| include: true\n#| warning: false\n\n### |-  plot aesthetics ----\n# Get base colors with custom palette\ncolors <- get_theme_colors(palette = list(\n  \"Low\\nIncome\" = \"#2166AC\",\n  \"Lower Middle\\nIncome\" = \"#5AAE61\",\n  \"Upper Middle\\nIncome\" = \"#9970AB\",\n  \"High\\nIncome\" = \"#E08214\"\n))\n\n### |-  titles and caption ----\ntitle_text <- str_glue(\"The economics of corruption perceptions: structure vs change, 2012-2024\")\n\nsubtitle_text <- str_glue(\n  \"How economic development shapes corruption perceptions, yet dramatic improvements remain possible\"\n)\n\n# Create caption\ncaption_text <- create_mm_caption(\n  mm_year = current_year,\n  mm_week = current_week,\n  source_text = paste0(\"Our World in Data\")\n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n  base_theme,\n  theme(\n    plot.title = element_text(\n      size = rel(1.4), family = fonts$title, face = \"bold\",\n      color = colors$title, lineheight = 1.1, hjust = 0,\n      margin = margin(t = 5, b = 10)\n    ),\n    plot.subtitle = element_text(\n      size = rel(0.9), hjust = 0, family = fonts$subtitle,\n      color = alpha(colors$subtitle, 0.9), lineheight = 1.1,\n      margin = margin(t = 0, b = 20)\n    ),\n\n    # Legend formatting\n    legend.position = \"plot\",\n    legend.box.margin = margin(b = 10),\n    legend.margin = margin(b = 5),\n    legend.title = element_text(face = \"bold\"),\n\n    # Axis formatting\n    axis.ticks.y = element_blank(),\n    axis.ticks.x = element_line(color = \"gray\", linewidth = 0.5),\n    axis.ticks.length = unit(0.2, \"cm\"),\n    axis.title.x = element_text(\n      face = \"bold\", size = rel(0.85),\n      margin = margin(t = 10)\n    ),\n    axis.title.y = element_text(\n      face = \"bold\", size = rel(0.85),\n      margin = margin(r = 10)\n    ),\n    axis.text.x = element_text(\n      size = rel(0.85), family = fonts$subtitle,\n      color = colors$text\n    ),\n    axis.text.y = element_text(\n      size = rel(0.85), family = fonts$subtitle,\n      color = colors$text\n    ),\n\n    # Grid lines\n    panel.grid.major = element_line(color = \"#ecf0f1\", linewidth = 0.4),\n    panel.grid.minor = element_blank(),\n\n    # Margin\n    plot.margin = margin(20, 20, 20, 20)\n  )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n````\n:::\n\n\n#### 6. Plot\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: plot\n#| warning: false\n\n### |- P1  Income beeswarm plot----\nbeeswarm_plot <- ggplot(\n  latest_data_income,\n  aes(\n    x = income_group, y = corruption_perceptions_index,\n    color = income_group\n  )\n) +\n  # Geoms\n  geom_quasirandom(size = 2.5, alpha = 0.75, width = 0.35) +\n  stat_summary(\n    fun = median, geom = \"crossbar\", width = 0.6,\n    color = \"black\", size = 1, alpha = 0.8\n  ) +\n  # Scales\n  scale_color_manual(values = colors$palette, guide = \"none\") +\n  scale_y_continuous(\n    breaks = seq(0, 100, 20), limits = c(0, 100),\n    expand = expansion(mult = c(0.02, 0.02))\n  ) +\n  coord_flip(clip = \"off\") +\n  # Labs\n  labs(\n    title = \"Wealth strongly predicts clean governance\",\n    subtitle = str_glue(\n      \"2024 Corruption perceptions index by income level\\n\",\n      \"Each dot represents one country | Black bars show group medians\"\n    ),\n    x = NULL,\n    y = \"Corruption Perceptions Index (0 = Most Corrupt, 100 = Least Corrupt)\",\n  ) +\n  # Theme\n  theme(\n    panel.grid.minor = element_blank(),\n    panel.grid.major.y = element_blank(),\n    panel.grid.major.x = element_line(color = \"gray95\", size = 0.25),\n    axis.line.x = element_line(color = \"gray30\", size = 0.5),\n  )\n### |- P2  Dumbbell plot----\ndumbbell_plot <- ggplot(biggest_movers, aes(y = entity_short)) +\n  # Geoms\n  geom_segment(aes(x = earliest_score, xend = latest_score),\n               color = \"gray60\", size = 1.2, alpha = 0.8\n  ) +\n  geom_point(aes(x = earliest_score), color = \"gray40\", size = 3.5, alpha = 0.9) +\n  geom_point(aes(x = latest_score, color = income_group), size = 3.5, alpha = 0.9) +\n  geom_text(\n    aes(\n      x = pmax(earliest_score, latest_score) + 3,\n      label = paste0(ifelse(trend > 0, \"+\", \"\"), round(trend))\n    ),\n    size = 3, fontface = \"bold\", color = \"gray30\", hjust = 0.1\n  ) +\n  # Scales\n  scale_color_manual(values = colors$palette, guide = \"none\") +\n  scale_x_continuous(\n    breaks = seq(0, 100, 20), limits = c(0, 105),\n    expand = expansion(mult = c(0.02, 0.02))\n  ) +\n  # Labs\n  labs(\n    title = \"Yet dramatic improvements are possible\",\n    subtitle = str_glue(\n      \"Largest changes in corruption perceptions (2012â€“2024)\\n\",\n      \"Gray dots: 2012 scores | Colored dots: 2024 scores (by income group)\"\n    ),\n    x = \"Corruption Perceptions Index\",\n    y = NULL,\n  ) +\n  # Theme\n  theme(\n    panel.grid.minor = element_blank(),\n    panel.grid.major = element_blank(),\n    axis.line.x = element_line(color = \"gray30\", size = 0.5),\n  )\n\n### |-  combined plot ----\ncombined_plots <- beeswarm_plot | dumbbell_plot\n\ncombined_plots <- combined_plots +\n  plot_annotation(\n    title = title_text,\n    subtitle = subtitle_text,\n    caption = caption_text,\n    theme = theme(\n      plot.title = element_text(\n        size = rel(1.7),\n        family = fonts$title,\n        face = \"bold\",\n        color = colors$title,\n        lineheight = 1.1,\n        margin = margin(t = 5, b = 5)\n      ),\n      plot.subtitle = element_text(\n        size = rel(1.1),\n        family = fonts$subtitle,\n        color = alpha(colors$subtitle, 0.9),\n        lineheight = 0.9,\n        margin = margin(t = 5, b = 0)\n      ),\n      plot.caption = element_markdown(\n        size = rel(0.70),\n        family = fonts$caption,\n        color = colors$caption,\n        hjust = 0.5,\n        margin = margin(t = 10)\n      )\n    )\n  )\n```\n````\n:::\n\n\n#### 7. Save\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: save\n#| warning: false\n\n### |-  plot image ----  \nsave_plot_patchwork(\n  plot = combined_plots, \n  type = \"makeovermonday\", \n  year = current_year,\n  week = current_week,\n  width = 12.5, \n  height = 10\n  )\n```\n````\n:::\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 22631)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] here_1.0.1       patchwork_1.3.0  ggbeeswarm_0.7.2 glue_1.8.0      \n [5] scales_1.3.0     showtext_0.9-7   showtextdb_3.0   sysfonts_0.8.9  \n [9] ggtext_0.1.2     lubridate_1.9.3  forcats_1.0.0    stringr_1.5.1   \n[13] dplyr_1.1.4      purrr_1.0.2      readr_2.1.5      tidyr_1.3.1     \n[17] tibble_3.2.1     ggplot2_3.5.1    tidyverse_2.0.0  pacman_0.5.1    \n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.6       beeswarm_0.4.0     xfun_0.49          htmlwidgets_1.6.4 \n [5] tzdb_0.5.0         yulab.utils_0.1.8  vctrs_0.6.5        tools_4.4.0       \n [9] generics_0.1.3     curl_6.0.0         gifski_1.32.0-1    fansi_1.0.6       \n[13] pkgconfig_2.0.3    ggplotify_0.1.2    skimr_2.1.5        readxl_1.4.3      \n[17] lifecycle_1.0.4    compiler_4.4.0     farver_2.1.2       munsell_0.5.1     \n[21] repr_1.1.7         janitor_2.2.0      codetools_0.2-20   snakecase_0.11.1  \n[25] vipor_0.4.7        htmltools_0.5.8.1  yaml_2.3.10        pillar_1.9.0      \n[29] camcorder_0.1.0    magick_2.8.5       commonmark_1.9.2   tidyselect_1.2.1  \n[33] digest_0.6.37      stringi_1.8.4      rsvg_2.6.1         rprojroot_2.0.4   \n[37] fastmap_1.2.0      grid_4.4.0         colorspace_2.1-1   cli_3.6.4         \n[41] magrittr_2.0.3     base64enc_0.1-3    utf8_1.2.4         withr_3.0.2       \n[45] timechange_0.3.0   rmarkdown_2.29     cellranger_1.1.0   hms_1.1.3         \n[49] evaluate_1.0.1     knitr_1.49         markdown_1.13      gridGraphics_0.5-1\n[53] rlang_1.1.6        gridtext_0.1.5     Rcpp_1.0.13-1      xml2_1.3.6        \n[57] renv_1.0.3         svglite_2.1.3      rstudioapi_0.17.1  jsonlite_1.8.9    \n[61] R6_2.5.1           fs_1.6.5           systemfonts_1.1.0 \n```\n\n\n:::\n:::\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [mm_2025_32.qmd](https://github.com/poncest/personal-website/blob/master/data_visualizations/MakeoverMonday/2025/mm_2025_32.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n#### 10. References\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1.  Data:\n\n-   Makeover Monday 2025 Week 32: [Corruption Perceptions Index (CPI)](https://data.world/makeovermonday/corruption)\n\n2.  Article\n\n-   [Corruption](https://ourworldindata.org/grapher/ti-corruption-perception-index?tab=table&time=earliest..2024&country=~NZL)\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}