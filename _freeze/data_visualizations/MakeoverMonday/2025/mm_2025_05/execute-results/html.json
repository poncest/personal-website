{
  "hash": "b7851f34c730f84fd2cc3a833838c5e0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"World Happiness Report 2024\"\nsubtitle: \"Figure 2.1: Distribution of Contributing Factors to Life Evaluations\"\ndescription: \"A visual exploration of happiness factors across nations, transforming the World Happiness Report's stacked bar chart into an intuitive beeswarm plot that highlights the distribution and relationships between different contributors to national happiness.\"\nauthor: \"Steven Ponce\"\ndate: \"2025-01-30\" \ncategories: [MakeoverMonday, Data Visualization, R Programming]  \ntags: [\n  \"beeswarm\",\n  \"happiness-index\",\n  \"data-transformation\",\n  \"visualization-makeover\",\n  \"world-happiness\",\n  \"social-metrics\",\n  \"distribution-plot\",\n  \"geom-quasirandom\",\n]\nimage: \"thumbnails/mm_2025_05.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                                  \n  cache: true                                                   \n  error: false\n  message: false\n  warning: false\n  eval: true\nfilters:\n  - social-share\nshare:                     \n  permalink: \"https://stevenponce.netlify.app/data_visualizations/MakeoverMonday/2025/mm_2025_05.html\"\n  description: \"Visualizing the distribution of happiness factors across nations using R and ggplot2. #MakeoverMonday #rstats #dataviz\"\n  twitter: true\n  linkedin: true\n  email: true\n  facebook: false\n  reddit: false\n  stumble: false\n  tumblr: false\n  mastodon: true\n  bsky: true\n---\n\n\n\n### Original\n\nThe original visualization comes from the World Happiness Report 2024, Figure 2.1, showing country rankings by life evaluations in 2021-2023. \n\nYou can view the interactive visualization [here on Tableau Public](https://public.tableau.com/app/profile/worldhappiness/viz/2024Draft/Figure2_1).\n\n![Original visualization from World Happiness Report 2024](https://raw.githubusercontent.com/poncest/MakeoverMonday/master/2025/Week_05/original_chart.png)\n\nSource: [World Happiness Report 2024](https://worldhappiness.report/)\n\n### Makeover\n\n![A beeswarm plot showing the distribution of different factors contributing to happiness scores across countries. Factors include Generosity, Low Corruption, Health, Freedom, Social Support, GDP, and overall Happiness Score. Each point represents a country, with Finland and Afghanistan often appearing as extremes. Values are color-coded from blue (low) to brown (high), with red diamond markers showing mean values for each factor.](mm_2025_05.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\npacman::p_load(\ntidyverse,      # Easily Install and Load the 'Tidyverse'\n    ggtext,         # Improved Text Rendering Support for 'ggplot2'\n    showtext,       # Using Fonts More Easily in R Graphs\n    janitor,        # Simple Tools for Examining and Cleaning Dirty Data\n    skimr,          # Compact and Flexible Summaries of Data\n    scales,         # Scale Functions for Visualization\n    glue,           # Interpreted String Literals\n    here,           # A Simpler Way to Find Your Files\n    camcorder,      # Record Your Plot History \n    readxl,         # Read Excel Files\n    ggbeeswarm,     # Categorical Scatter (Violin Point) Plots \n    scico,          # Colour Palettes Based on the Scientific Colour-Maps \n    ggrepel         # Automatically Position Non-Overlapping Text Labels with 'ggplot2'\n)\n})\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n:::\n\n\n\n#### 2. Read in the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nworld_happiness_2024 <- read_excel(\n  here::here('data/DataForFigure2.1 with sub bars 2024.xlsx')) |> \n  clean_names()\n```\n:::\n\n\n\n#### 3. Examine the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(world_happiness_2024)\nskim(world_happiness_2024)\n```\n:::\n\n\n\n#### 4. Tidy Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  tidy data ----\nhappiness_long <- world_happiness_2024 |>\n  select(\n    # Rename columns\n    country_name,\n    \"Happiness Score\" = ladder_score,\n    \"GDP\" = explained_by_log_gdp_per_capita,\n    \"Social Support\" = explained_by_social_support,\n    \"Health\" = explained_by_healthy_life_expectancy,\n    \"Freedom\" = explained_by_freedom_to_make_life_choices,\n    \"Generosity\" = explained_by_generosity,\n    \"Low Corruption\" = explained_by_perceptions_of_corruption\n  ) |>\n  # Pivot longer\n  pivot_longer(\n    -country_name,\n    names_to = \"metric\",\n    values_to = \"value\"\n  ) |>\n  # add metric mea\n  group_by(metric) |>\n  mutate(\n    metric_mean = mean(value, na.rm = TRUE)\n  ) |>\n  ungroup() |>\n  # Factor reorder by mean\n  mutate(\n    metric = fct_reorder(metric, metric_mean, .desc = TRUE)\n  )\n\n# data labels df\nlabel_data <- bind_rows(\n  # Get minimum values\n  happiness_long |>\n    group_by(metric) |>\n    slice_min(order_by = value, n = 1, with_ties = FALSE),\n  \n  # Get maximum values\n  happiness_long |>\n    group_by(metric) |>\n    slice_max(order_by = value, n = 1, with_ties = FALSE)\n  ) |>\n  ungroup() |>\n  distinct(metric, country_name, value)\n```\n:::\n\n\n\n#### 5. Visualization Parameters\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot aesthetics ----\n# Get base colors with custom palette\ncolors <- get_theme_colors()\n\n### |-  titles and caption ----\ntitle_text <- str_glue(\"World Happiness Report 2024\")\nsubtitle_text <- str_glue(\"Figure 2.1: Distribution of Contributing Factors to Life Evaluations\")\n\n# Create caption\ncaption_text <- create_mm_caption(\n    mm_year = 2025,\n    mm_week = 05,\n    source_text = \"World Happiness Report Data Dashboard | The World Happiness Report\"\n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n    base_theme,\n    theme(\n      # Legend\n      legend.position = c(0.8, 1.1),    \n      legend.justification = c(0.5, 1),\n      legend.margin = margin(b = 5),\n      legend.title = element_text(size = rel(0.7)),\n      legend.text = element_text(size = rel(0.6)),\n      legend.direction = \"horizontal\",\n      \n      # Axis formatting\n      axis.title = element_text(color = colors$text, size = rel(1), face = \"bold\"),\n      axis.text.y = element_text(color = colors$text, size = rel(0.95), face = \"bold\"),\n      \n      # Grid customization\n      panel.grid.minor = element_blank(),\n      panel.grid.major.y = element_blank(),\n    \n      # Plot margins \n      plot.margin = margin(t = 20, r = 20, b = 20, l = 20)\n    )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n:::\n\n\n\n#### 6. Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  Plot  ----\np <- ggplot(happiness_long, aes(x = metric, y = value)) +\n  # Geom\n  geom_hline(\n    yintercept = seq(0, 8, by = 2),\n    color = \"gray90\",\n    linewidth = 0.5\n  ) +\n  geom_quasirandom(\n    aes(color = value),\n    width = 0.4,\n    size = 2.5,\n    alpha = 0.7,\n    shape = 21,\n    stroke = 0.5\n  ) +\n  geom_text_repel(\n    data = label_data,\n    aes(label = country_name),\n    size = 3,\n    fontface = \"plain\",\n    max.overlaps = Inf,\n    box.padding = 0.5,\n    point.padding = 0.3,\n    segment.color = \"gray40\",\n    segment.size = 0.3,\n    min.segment.length = 0,\n    seed = 123,           \n    direction = \"both\",   \n    force = 1,           \n    force_pull = 0.5     \n  ) +\n  geom_point(                     # Mean indicators\n    data = distinct(happiness_long, metric, metric_mean),\n    aes(y = metric_mean),\n    color = \"red\",\n    fill = \"white\",\n    size = 3,\n    shape = 23\n  ) +\n  # Scales\n  scale_x_discrete() +\n  scale_y_continuous(\n    expand = expansion(mult = c(0.35, 0)),\n    breaks = seq(0, 8, by = 2),\n    limits = c(0, 9)) +\n  scale_color_scico(\n    palette = \"roma\",\n    direction = -1,\n    guide = guide_colorbar(\n      title.position = \"top\",\n      barwidth = 10,\n      barheight = 1,\n      ticks.linewidth = 1,\n      title.hjust = 0.5\n    )\n  ) +\n  coord_flip(clip = 'off') +\n  # Labs\n  labs(\n    x = NULL,\n    y = \"Value\",\n    color = \"Value\",\n    title = title_text,\n    subtitle = subtitle_text,\n    caption = caption_text,\n  ) +\n  # Theme\n  theme(\n    plot.title = element_text(\n      size   = rel(2),\n      family = fonts$title,\n      face   = \"bold\",\n      color  = colors$title,\n      lineheight = 1.1,\n      margin = margin(t = 5, b = 5)\n    ),\n    plot.subtitle = element_text(\n      size   = rel(0.95),\n      family = fonts$subtitle,\n      color  = colors$subtitle,\n      lineheight = 1.2,\n      margin = margin(t = 5, b = 15)\n    ),\n    plot.caption = element_markdown(\n      size   = rel(0.6),\n      family = fonts$caption,\n      color  = colors$caption,\n      hjust  = 0.5,\n      margin = margin(t = 10)\n    )\n  )\n```\n:::\n\n\n\n#### 7. Save\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot image ----  \nsave_plot (\n  p, type = \"makeovermonday\", \n  year = 2025, week = 05, width = 10, height = 8\n  )\n```\n:::\n\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 22631)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] ggrepel_0.9.6    scico_1.5.0      ggbeeswarm_0.7.2 readxl_1.4.3    \n [5] camcorder_0.1.0  here_1.0.1       glue_1.8.0       scales_1.3.0    \n [9] skimr_2.1.5      janitor_2.2.0    showtext_0.9-7   showtextdb_3.0  \n[13] sysfonts_0.8.9   ggtext_0.1.2     lubridate_1.9.3  forcats_1.0.0   \n[17] stringr_1.5.1    dplyr_1.1.4      purrr_1.0.2      readr_2.1.5     \n[21] tidyr_1.3.1      tibble_3.2.1     ggplot2_3.5.1    tidyverse_2.0.0 \n\nloaded via a namespace (and not attached):\n [1] beeswarm_0.4.0    gtable_0.3.6      xfun_0.49         htmlwidgets_1.6.4\n [5] tzdb_0.4.0        vctrs_0.6.5       tools_4.4.0       generics_0.1.3   \n [9] curl_6.0.0        gifski_1.32.0-1   fansi_1.0.6       pacman_0.5.1     \n[13] pkgconfig_2.0.3   lifecycle_1.0.4   farver_2.1.2      compiler_4.4.0   \n[17] textshaping_0.4.0 munsell_0.5.1     repr_1.1.7        codetools_0.2-20 \n[21] snakecase_0.11.1  vipor_0.4.7       htmltools_0.5.8.1 yaml_2.3.10      \n[25] pillar_1.9.0      magick_2.8.5      commonmark_1.9.2  tidyselect_1.2.1 \n[29] digest_0.6.37     stringi_1.8.4     labeling_0.4.3    rsvg_2.6.1       \n[33] rprojroot_2.0.4   fastmap_1.2.0     grid_4.4.0        colorspace_2.1-1 \n[37] cli_3.6.3         magrittr_2.0.3    base64enc_0.1-3   utf8_1.2.4       \n[41] withr_3.0.2       timechange_0.3.0  rmarkdown_2.29    cellranger_1.1.0 \n[45] ragg_1.3.3        hms_1.1.3         evaluate_1.0.1    knitr_1.49       \n[49] markdown_1.13     rlang_1.1.4       gridtext_0.1.5    Rcpp_1.0.13-1    \n[53] xml2_1.3.6        renv_1.0.3        svglite_2.1.3     rstudioapi_0.17.1\n[57] jsonlite_1.8.9    R6_2.5.1          systemfonts_1.1.0\n```\n\n\n:::\n:::\n\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`mm_2025_05.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/MakeoverMonday/2025/mm_2025_05.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n\n#### 10. References\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1. Article:\n   - World Happiness Report 2024: [Figure 2.1: Country Rankings by Life Evaluations in 2021-2023 (Tab 2)](https://worldhappiness.report/ed/2024/happiness-of-the-younger-the-older-and-those-in-between/#ranking-of-happiness-2021-2023)\n\n\n2. Data:\n- Makeover Monday 2025 Week 05: [World Happiness Report 2024](https://data.world/makeovermonday/2025-week-4-world-happiness-report-2024/workspace/project-summary?agentid=makeovermonday&datasetid=2025-week-4-world-happiness-report-2024)\n \n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}