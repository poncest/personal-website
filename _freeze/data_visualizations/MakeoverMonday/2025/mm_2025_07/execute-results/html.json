{
  "hash": "24b24ecca1f9c065d248bdd00f22ac42",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Most Popular Valentine's Candy Across U.S. States (2024)\"\nsubtitle: \"Number of states ranking each candy as their 1st, 2nd, or 3rd choice\"\ndescription: \"Explore the sweet preferences across America with this visualization of Valentine's candy rankings. Using data from Candystore.com, this analysis reveals which candies dominate the Valentine's season, with Conversation Hearts and Heart-Shaped Chocolates emerging as clear favorites among U.S. states.\"\nauthor: \"Steven Ponce\"\ndate: \"2025-02-09\" \ncategories: [\"MakeoverMonday\", \"Data Visualization\", \"R Programming\", \"2025\"]   \ntags: [\n \"ggplot2\",\n  \"tidyverse\",\n  \"Valentine's Day\",\n  \"candy\",\n  \"rankings\",\n  \"consumer preferences\",\n  \"state data\",\n  \"stacked bar chart\",\n  \"candystore\"\n]\nimage: \"thumbnails/mm_2025_07.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                                  \n  cache: true                                                   \n  error: false\n  message: false\n  warning: false\n  eval: true\nfilters:\n  - social-share\nshare:                     \n  permalink: \"https://stevenponce.netlify.app/data_visualizations/MakeoverMonday/2025/mm_2025_07.html\"\n  description: \"Discover which Valentine's candies are most popular across U.S. states in 2024! From Conversation Hearts to M&M's, see how different states rank their favorite sweet treats. #DataViz #MakeoverMonday #rstats\"\n  twitter: true\n  linkedin: true\n  email: true\n  facebook: false\n  reddit: false\n  stumble: false\n  tumblr: false\n  mastodon: true\n  bsky: true\n---\n\n\n\n### Original\n\nThe original visualization Most Popular Valentine's Candy by State comes from [Candystore.com](https://www.candystore.com/blogs/holidays/valentines-candy-popular-states)\n\n![Original visualization](https://raw.githubusercontent.com/poncest/MakeoverMonday/master/2025/Week_07/original_chart.png)\n\n### Makeover\n\n![A horizontal stacked bar chart showing Valentine's candy preferences across U.S. states in 2024. Each bar represents a candy type, with segments indicating the number of states ranking it as 1st, 2nd, or 3rd choice. Conversation Hearts leads with 46 states, followed by Heart-Shaped Box of Chocolates with 37 states. The remaining candies, including M&M's, Hershey Kisses, and others, received fewer state rankings.](mm_2025_07.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\npacman::p_load(\n    tidyverse,      # Easily Install and Load the 'Tidyverse'\n    ggtext,         # Improved Text Rendering Support for 'ggplot2'\n    showtext,       # Using Fonts More Easily in R Graphs\n    janitor,        # Simple Tools for Examining and Cleaning Dirty Data\n    skimr,          # Compact and Flexible Summaries of Data\n    scales,         # Scale Functions for Visualization\n    glue,           # Interpreted String Literals\n    here,           # A Simpler Way to Find Your Files\n    lubridate,      # Make Dealing with Dates a Little Easier\n    camcorder       # Record Your Plot History \n)\n})\n\n### |- figure size ----\ngg_record(\n    dir    = here::here(\"temp_plots\"),\n    device = \"png\",\n    width  =  8,\n    height =  8,\n    units  = \"in\",\n    dpi    = 320\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n:::\n\n\n\n#### 2. Read in the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsv_candies_raw <- read_csv(\n  here::here('data/MakeoverMonday_ SV_day.csv')) |> \n  clean_names()\n```\n:::\n\n\n\n#### 3. Examine the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(sv_candies_raw)\nskim(sv_candies_raw)\n```\n:::\n\n\n\n#### 4. Tidy Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  tidy data ----\nsv_candies_clean <- sv_candies_raw |>\n  rename_with(~str_remove(., \"^x\"), starts_with(\"x\"))\n\n# Create long format data\ncandies_long <- sv_candies_clean |>\n  pivot_longer(\n    cols = ends_with(\"2024\"),\n    names_to = \"rank\",\n    values_to = \"candy\"\n  ) |>\n  # Clean up rank names\n  mutate(rank = case_when(\n    rank == \"1st_place_2024\" ~ \"1st Place\",\n    rank == \"2nd_place_2024\" ~ \"2nd Place\",\n    rank == \"3rd_place_2024\" ~ \"3rd Place\"\n  ),\n  rank = factor(rank, levels = c(\"1st Place\", \"2nd Place\", \"3rd Place\"))\n  )\n\n# Prepare data with totals\ncandies_with_counts <- candies_long |>\n  mutate(rank = factor(rank, levels = c(\"1st Place\", \"2nd Place\", \"3rd Place\"))) |> \n  count(candy, rank) |>\n  group_by(candy) |>  \n  mutate(\n    total = sum(n)\n  ) |>\n  ungroup() |>\n  arrange(-total, candy)\n\n# Create total summary data\ntotal_summary <- candies_with_counts |> \n  group_by(candy) |> \n  summarize(\n    total = sum(n),\n    y = total,\n    rank = \"1st Place\"  \n  )\n```\n:::\n\n\n\n#### 5. Visualization Parameters\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot aesthetics ----\n# Get base colors with custom palette\ncolors <- get_theme_colors(palette = c(\"1st Place\" = \"#FFB6C1\",    \n                                       \"2nd Place\" = \"#FF69B4\",     \n                                       \"3rd Place\" = \"#C71585\"))\n\n### |-  titles and caption ----\ntitle_text <- str_glue(\"Most Popular Valentine's Candy Across U.S. States (2024)\")\nsubtitle_text <- str_glue(\"Number of states ranking each candy as their 1st, 2nd, or 3rd choice\")\n\n# Create caption\ncaption_text <- create_mm_caption(\n    mm_year = 2025,\n    mm_week = 07,\n    source_text = \"Candystore.com\"\n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n  base_theme,\n  theme(\n    # Weekly-specific modifications\n    axis.line.x           = element_line(color = \"#252525\", linewidth = .2),\n    \n    panel.spacing.x       = unit(2, 'lines'),\n    panel.spacing.y       = unit(1, 'lines'),\n    panel.grid.major.x    = element_line(color = alpha(colors[5], 0.2), linewidth = 0.2),\n    panel.grid.major.y    = element_blank(),\n    panel.grid.minor      = element_blank(),\n    \n    legend.position = \"top\"\n    \n  )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n:::\n\n\n\n#### 6. Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  Plot  ----\np <- ggplot(candies_with_counts, \n       aes(x = reorder(candy, total), \n           y = n,\n           fill = rank)) +  \n  \n  # Geoms\n  geom_col() +\n  geom_text(aes(label = n),\n            position = position_stack(vjust = 0.5),\n            color = \"white\",\n            size = 3) +\n  geom_text(data = total_summary,\n            aes(y = y, label = paste0(\"(\", total, \")\")),\n            hjust = -0.2,\n            color = colors$text,\n            size = 3) +\n  \n  # Scales\n  scale_x_discrete() +\n  scale_y_continuous(\n    expand = expansion(mult = c(0, 0.1))\n  ) +\n  coord_flip() +\n  scale_fill_manual(values = colors$palette) +\n  \n  # Labs\n  labs(\n    x = NULL,\n    y = \"Number of States\",\n    fill = \"Ranking\",\n    title = title_text,\n    subtitle = subtitle_text,\n    caption = caption_text\n  ) +\n  \n  # Theme\n  theme(\n    plot.title = element_text(\n      size   = rel(1.6),\n      family = fonts$title,\n      face   = \"bold\",\n      color  = colors$title,\n      lineheight = 1.1,\n      margin = margin(t = 5, b = 5)\n    ),\n    plot.subtitle = element_markdown(\n      size   = rel(1),\n      family = fonts$subtitle,\n      color  = colors$subtitle,\n      lineheight = 1.2,\n      margin = margin(t = 5, b = 15)\n    ),\n    plot.caption = element_markdown(\n      size   = rel(0.6),\n      family = fonts$caption,\n      color  = colors$caption,\n      hjust  = 0.5,\n      margin = margin(t = 10)\n    )\n  )\n```\n:::\n\n\n\n#### 7. Save\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot image ----  \nsave_plot(\n  p, \n  type = \"makeovermonday\", \n  year = 2025,\n  week = 07,\n  width = 8, \n  height = 8\n  )\n```\n:::\n\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 22631)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] camcorder_0.1.0 here_1.0.1      glue_1.8.0      scales_1.3.0   \n [5] skimr_2.1.5     janitor_2.2.0   showtext_0.9-7  showtextdb_3.0 \n [9] sysfonts_0.8.9  ggtext_0.1.2    lubridate_1.9.3 forcats_1.0.0  \n[13] stringr_1.5.1   dplyr_1.1.4     purrr_1.0.2     readr_2.1.5    \n[17] tidyr_1.3.1     tibble_3.2.1    ggplot2_3.5.1   tidyverse_2.0.0\n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.6      xfun_0.49         htmlwidgets_1.6.4 tzdb_0.4.0       \n [5] vctrs_0.6.5       tools_4.4.0       generics_0.1.3    curl_6.0.0       \n [9] parallel_4.4.0    gifski_1.32.0-1   fansi_1.0.6       pacman_0.5.1     \n[13] pkgconfig_2.0.3   lifecycle_1.0.4   farver_2.1.2      compiler_4.4.0   \n[17] textshaping_0.4.0 munsell_0.5.1     repr_1.1.7        codetools_0.2-20 \n[21] snakecase_0.11.1  htmltools_0.5.8.1 yaml_2.3.10       crayon_1.5.3     \n[25] pillar_1.9.0      magick_2.8.5      commonmark_1.9.2  tidyselect_1.2.1 \n[29] digest_0.6.37     stringi_1.8.4     labeling_0.4.3    rsvg_2.6.1       \n[33] rprojroot_2.0.4   fastmap_1.2.0     grid_4.4.0        colorspace_2.1-1 \n[37] cli_3.6.3         magrittr_2.0.3    base64enc_0.1-3   utf8_1.2.4       \n[41] withr_3.0.2       bit64_4.5.2       timechange_0.3.0  rmarkdown_2.29   \n[45] bit_4.5.0         ragg_1.3.3        hms_1.1.3         evaluate_1.0.1   \n[49] knitr_1.49        markdown_1.13     rlang_1.1.4       gridtext_0.1.5   \n[53] Rcpp_1.0.13-1     xml2_1.3.6        renv_1.0.3        svglite_2.1.3    \n[57] rstudioapi_0.17.1 vroom_1.6.5       jsonlite_1.8.9    R6_2.5.1         \n[61] systemfonts_1.1.0\n```\n\n\n:::\n:::\n\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`mm_2025_07.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/MakeoverMonday/2025/mm_2025_07.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n\n#### 10. References\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1. Article:\n   - Most Popular Valentine's Candy by State: [Most Popular Valentine's Candy by State](https://www.candystore.com/blogs/holidays/valentines-candy-popular-states)\n\n\n2. Data:\n- Makeover Monday 2025 Week 07: [Candystore.com](https://data.world/makeovermonday/2025-week-7-most-popular-valentines-candy-by-state)\n \n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}