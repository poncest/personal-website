{
  "hash": "240299daf257434cf3f2fc602679a04f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"The Stakes for U.S. Truck Manufacturing Under Shifting Federal Policy\"\nsubtitle: \"Employment impact analysis across clean vehicle scenarios and policy retreat alternatives\"\ndescription: \"Analysis of how federal clean vehicle policies could create up to 19,122 manufacturing jobs or eliminate 3,332 jobs under policy retreat. Using EPI economic modeling data, this dual-chart visualization reveals the employment consequences of different policy scenarios across assembly and supply chain sectors in America's truck manufacturing industry.\"\nauthor: \"Steven Ponce\"\ndate: \"2025-06-02\" \ncategories: [\"MakeoverMonday\", \"Data Visualization\", \"R Programming\", \"2025\"]   \ntags: [\n\"economic-policy\", \"manufacturing-jobs\", \"clean-vehicles\", \"employment-analysis\", \n  \"heatmap\", \"waterfall-chart\", \"policy-impact\", \"truck-manufacturing\", \"ggplot2\", \n  \"patchwork\", \"federal-policy\", \"EPI-data\", \"supply-chain\", \"union-wages\"\n]\nimage: \"thumbnails/mm_2025_23.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                                  \n  cache: true                                                   \n  error: false\n  message: false\n  warning: false\n  eval: true\n---\n\n### Original\n\nThe original visualization **Figure B: Change in employment from baseline scenario, Job-years, 2024–2032** comes from [Economic Policy Institute+](https://www.epi.org/publication/future-clean-trucks-buses/)\n\n![Original visualization](https://raw.githubusercontent.com/poncest/MakeoverMonday/refs/heads/master/2025/Week_23/original_chart.png)\n\n### Makeover\n\n![Dual-chart visualization showing U.S. truck manufacturing employment impacts. The top heatmap displays five policy scenarios (rows) versus three job categories (columns), with green indicating job gains and red showing losses. The policy Retreat row shows red losses (-596 to -3,332 jobs), while other scenarios show green gains. The bottom waterfall chart shows progressive job creation from baseline through four positive scenarios, building from +11,182 to +19,122 total jobs, with a separate red bar showing -3,332 job loss under the Policy Retreat alternative.](mm_2025_23.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: load\n#| warning: false\n#| message: false\n#| results: \"hide\"\n\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\n  if (!require(\"pacman\")) install.packages(\"pacman\")\n  pacman::p_load(\n    tidyverse,      # Easily Install and Load the 'Tidyverse'\n    ggtext,         # Improved Text Rendering Support for 'ggplot2'\n    showtext,       # Using Fonts More Easily in R Graphs\n    scales,         # Scale Functions for Visualization\n    glue,           # Interpreted String Literals\n    lubridate,      # Make Dealing with Dates a Little Easier\n    patchwork       # The Composer of Plots\n  )\n})\n\n### |- figure size ----\ncamcorder::gg_record(\n    dir    = here::here(\"temp_plots\"),\n    device = \"png\",\n    width  =  10,\n    height =  12,\n    units  = \"in\",\n    dpi    = 320\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n````\n:::\n\n\n#### 2. Read in the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: read\n#| include: true\n#| eval: true\n#| warning: false\n\n## Original Chart\n# Change in employment from baseline scenario, Job-years, 2024–2032, Figure B\n# https://www.epi.org/publication/future-clean-trucks-buses/\n\n## Article\n# What future will U.S. truck manufacturing have under Trump?\n# https://www.epi.org/publication/future-clean-trucks-buses/\n\n## Data\n# What future will U.S. truck manufacturing have under Trump?\n# https://data.world/makeovermonday/what-future-will-us-truck-manufacturing-have-under-trump\n\ntruck_manufacturing_raw <- readxl::read_excel(\n  here::here('data/MakeoverMonday/2025/US truck manufacturing under Trump.xlsx')) |> \n  janitor::clean_names()\n```\n````\n:::\n\n\n#### 3. Examine the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: examine\n#| include: true\n#| eval: true\n#| results: 'hide'\n#| warning: false\n\nglimpse(truck_manufacturing_raw)\nskimr::skim(truck_manufacturing_raw)\n```\n````\n:::\n\n\n#### 4. Tidy Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: tidy\n#| warning: false\n\n# P1. heatmap data----\nheatmap_data <- truck_manufacturing_raw |>\n  mutate(\n    scenario_clean = case_when(\n      str_detect(scenario, \"policy retreat\") ~ \"Policy Retreat\",\n      str_detect(scenario, \"union wages\") ~ \"Clean + Market + Union\",\n      str_detect(scenario, \"50% clean.*10% market\") ~ \"Clean + Market Share\",\n      str_detect(scenario, \"Baseline.*10%\") ~ \"Baseline + Market\",\n      str_detect(scenario, \"50% clean\") ~ \"50% Clean Vehicles\",\n      TRUE ~ scenario\n    ),\n    # Order scenarios logically\n    scenario_factor = factor(scenario_clean,\n      levels = c(\n        \"50% Clean Vehicles\",\n        \"Baseline + Market\",\n        \"Clean + Market Share\",\n        \"Clean + Market + Union\",\n        \"Policy Retreat\"\n      )\n    )\n  ) |>\n  # Transform to long format\n  select(scenario_factor, assembly, supply_chain, total) |>\n  pivot_longer(\n    cols = -scenario_factor,\n    names_to = \"job_category\",\n    values_to = \"jobs\"\n  ) |>\n  # Create clean category labels\n  mutate(\n    job_category_clean = case_when(\n      job_category == \"assembly\" ~ \"Assembly\",\n      job_category == \"supply_chain\" ~ \"Supply Chain\",\n      job_category == \"total\" ~ \"Total\"\n    ),\n    job_category_factor = factor(job_category_clean,\n      levels = c(\"Assembly\", \"Supply Chain\", \"Total\")\n    ),\n    # Create scaled values for color intensity (-1 to 1 scale)\n    jobs_scaled = case_when(\n      jobs < 0 ~ pmax(jobs / abs(min(jobs)), -1), # negative values\n      jobs > 0 ~ pmin(jobs / max(jobs), 1), # positive values\n      TRUE ~ 0\n    ),\n    # Text color based on intensity\n    text_color = ifelse(abs(jobs_scaled) > 0.6, \"white\", \"black\"),\n    # Formatted labels\n    jobs_label = case_when(\n      jobs == 0 ~ \"0\",\n      jobs > 0 ~ paste0(\"+\", comma(jobs, accuracy = 1)),\n      jobs < 0 ~ comma(jobs, accuracy = 1)\n    )\n  )\n\n# P2. waterfall chart data -----\nwaterfall_data <- tibble(\n  category = c(\n    \"Baseline\", \"50% Clean Vehicles\", \"Add Market Share\",\n    \"Add Union Wages\", \"Policy Retreat Alternative\"\n  ),\n  # Calculate incremental values\n  value = c(\n    0, # Baseline starting point\n    truck_manufacturing_raw$total[1], # 50% clean vehicles: 11,182\n    truck_manufacturing_raw$total[2] - truck_manufacturing_raw$total[1], # Market share increment: 13,272 - 11,182 = 2,090\n    truck_manufacturing_raw$total[4] - truck_manufacturing_raw$total[3], # Union wages increment: 19,122 - 15,441 = 3,681\n    truck_manufacturing_raw$total[5] # Policy retreat: -3,332 (standalone negative scenario)\n  ),\n  type = c(\"baseline\", \"positive\", \"positive\", \"positive\", \"negative\")\n) |>\n  # Calculate cumulative totals and bar positioning\n  mutate(\n    cumulative = case_when(\n      category == \"Policy Retreat Alternative\" ~ value,\n      TRUE ~ cumsum(value)\n    ),\n    # Calculate where each bar should start and end\n    ymin = case_when(\n      category == \"Baseline\" ~ 0,\n      category == \"Policy Retreat Alternative\" ~ 0,\n      TRUE ~ lag(cumulative, default = 0)\n    ),\n    ymax = case_when(\n      category == \"Policy Retreat Alternative\" ~ value,\n      TRUE ~ cumulative\n    ),\n    # Labels\n    category_label = case_when(\n      category == \"Baseline\" ~ \"Baseline\\n(Starting Point)\",\n      category == \"50% Clean Vehicles\" ~ \"50% Clean\\nVehicles\",\n      category == \"Add Market Share\" ~ \"Increase\\nMarket Share\",\n      category == \"Add Union Wages\" ~ \"Add Union\\nWages\",\n      category == \"Policy Retreat Alternative\" ~ \"Policy Retreat\\n(Alternative Path)\"\n    ),\n    category = factor(category, levels = category),\n    category_label = factor(category_label, levels = category_label)\n  )\n```\n````\n:::\n\n\n#### 5. Visualization Parameters\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: params\n#| include: true\n#| warning: false\n\n### |-  plot aesthetics ----\n# Get base colors with custom palette\ncolors <- get_theme_colors(palette = c(\n  \"#DC143C\", \"#FFFFFF\",  \"#2E8B57\",                                         # heatmap    \n  \"baseline\" = \"#708090\", \"positive\" = \"#2E8B57\", \"negative\" = \"#DC143C\"    # waterfall chart\n))\n  \n### |-  titles and caption ----\ntitle_text <- str_glue(\"The Stakes for U.S. Truck Manufacturing Under Shifting Federal Policy\")\nsubtitle_text <- str_glue(\"Employment impact analysis across clean vehicle scenarios and policy retreat alternatives\")\n\n\n# Create caption\ncaption_text <- create_mm_caption(\n    mm_year = 2025,\n    mm_week = 23,\n    source_text = \"<br>EPI analysis of S&P Global (2024), IMPLAN (2024), and FRED data | Job-years, 2024-2032\"\n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n  base_theme,\n  theme(\n\n    # Legend formatting\n    legend.position = \"plot\",\n    legend.title = element_text(face = \"bold\"),\n\n    axis.ticks.y = element_blank(),\n    axis.ticks.x = element_line(color = \"gray\", linewidth = 0.5), \n    axis.ticks.length = unit(0.2, \"cm\"), \n\n    # Axis formatting\n    axis.title.x = element_text(face = \"bold\", size = rel(0.85)),\n    axis.title.y = element_text(face = \"bold\", size = rel(0.85)),\n    axis.text.y = element_text(face = \"bold\", size = rel(0.85)),\n    \n    # Grid lines\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor = element_blank(),\n\n    # Margin\n    plot.margin = margin(20, 20, 20, 20)\n  )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n````\n:::\n\n\n#### 6. Plot\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: plot\n#| warning: false\n\n# P1. Heatmap ----\np1 <- heatmap_data |>\n  ggplot(aes(x = job_category_factor, y = scenario_factor)) +\n\n  # Geoms\n  geom_tile(aes(fill = jobs_scaled),\n    color = \"white\",\n    linewidth = 1.5,\n    alpha = 0.9\n  ) +\n  geom_text(aes(label = jobs_label, color = text_color),\n    fontface = \"bold\",\n    size = 4.2\n  ) +\n\n  # Scales\n  scale_fill_gradient2(\n    low = colors$palette[1],\n    mid = colors$palette[2],\n    high = colors$palette[3],\n    midpoint = 0,\n    name = \"Job Impact\\nIntensity\",\n    labels = c(\"High Loss\", \"Neutral\", \"High Gain\"),\n    breaks = c(-1, 0, 1),\n    guide = guide_colorbar(\n      title.position = \"top\",\n      title.hjust = 0.5,\n      barwidth = 1.2,\n      barheight = 8,\n      frame.colour = \"gray70\",\n      ticks.colour = \"gray70\"\n    )\n  ) +\n  scale_color_identity() +\n  scale_x_discrete(expand = c(0, 0)) +\n  scale_y_discrete(expand = c(0, 0)) +\n\n  # Labs\n  labs(\n    subtitle = \"Job breakdown shows potential gains and losses across Assembly and Supply Chain sectors\",\n    x = \"Job Category\",\n    y = \"Policy Scenario\"\n  ) +\n\n  # Theme\n  theme_minimal(base_size = 11) +\n  theme(\n    plot.subtitle = element_text(\n      size = 12,\n      color = \"gray40\",\n      margin = margin(b = 15)\n    ),\n    axis.title = element_text(\n      size = 10,\n      face = \"bold\",\n      color = \"gray30\"\n    ),\n    axis.title.x = element_text(margin = margin(t = 10)),\n    axis.title.y = element_text(margin = margin(r = 10)),\n    axis.text = element_text(\n      size = 9,\n      color = \"gray20\",\n      face = \"bold\"\n    ),\n    legend.position = \"right\",\n    legend.title = element_text(\n      size = 9,\n      face = \"bold\",\n      color = \"gray30\"\n    ),\n    legend.text = element_text(\n      size = 8,\n      color = \"gray40\"\n    ),\n    legend.margin = margin(l = 15),\n    panel.grid = element_blank(),\n    plot.margin = margin(10, 15, 15, 15),\n    plot.background = element_rect(fill = colors$background, color = NA),\n    panel.background = element_rect(fill = colors$background, color = NA)\n  )\n\n# P2. waterfall chart -----\np2 <- waterfall_data |>   \n  ggplot(aes(x = category_label)) +\n\n  # Geoms\n  geom_segment(\n    data = waterfall_data[2:4, ],\n    aes(\n      x = as.numeric(category_label) + 0.45,\n      xend = as.numeric(category_label) + 1 - 0.45,\n      y = ymax,\n      yend = ymax\n    ),\n    linetype = \"dashed\", alpha = 0.6, linewidth = 0.8, color = \"gray50\"\n  ) +\n  geom_rect(\n    aes(\n      xmin = as.numeric(category_label) - 0.35,\n      xmax = as.numeric(category_label) + 0.35,\n      ymin = ymin,\n      ymax = ymax,\n      fill = type\n    ),\n    alpha = 0.9, color = \"white\", linewidth = 0.5\n  ) +\n  geom_text(\n    aes(\n      y = (ymin + ymax) / 2,\n      label = ifelse(value == 0, \"0\",\n        paste0(ifelse(value > 0, \"+\", \"\"), comma(value, accuracy = 1))\n      )\n    ),\n    fontface = \"bold\", size = 4, color = \"white\"\n  ) +\n  geom_text(\n    data = filter(waterfall_data, type != \"baseline\" & type != \"negative\"),\n    aes(\n      y = ymax + 500,\n      label = paste(\"Total:\", comma(cumulative, accuracy = 1))\n    ),\n    fontface = \"bold\", size = 3.5, color = \"gray30\"\n  ) +\n  geom_hline(yintercept = 0, color = \"black\", linewidth = 1, alpha = 0.8) +\n\n  # Scales\n  scale_fill_manual(values = colors$palette, guide = \"none\") +\n  scale_y_continuous(\n    labels = function(x) {\n      case_when(\n        x >= 0 ~ paste0(\"+\", comma(x)),\n        x < 0 ~ comma(x),\n        TRUE ~ as.character(x)\n      )\n    },\n    breaks = pretty_breaks(n = 6),\n    expand = expansion(mult = c(0.15, 0.1))\n  ) +\n  scale_x_discrete() +\n\n  # Labs\n  labs(\n    subtitle = \"Policy scenarios build progressively from baseline to maximum employment potential\",\n    x = NULL,\n    y = \"Change in Employment (Job-years)\"\n  ) +\n\n  # Theme\n  theme_minimal(base_size = 11) +\n  theme(\n    plot.subtitle = element_text(\n      size = 12,\n      color = \"gray40\",\n      margin = margin(b = 15)\n    ),\n    axis.title.y = element_text(\n      size = 10,\n      face = \"bold\",\n      color = \"gray30\",\n      margin = margin(r = 15)\n    ),\n    axis.text.x = element_text(\n      size = 9,\n      face = \"bold\",\n      color = \"gray20\",\n      lineheight = 1.1\n    ),\n    axis.text.y = element_text(\n      size = 9,\n      color = \"gray30\"\n    ),\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor = element_blank(),\n    panel.grid.major.y = element_line(color = \"gray90\", linewidth = 0.5),\n    plot.margin = margin(15, 15, 10, 15),\n    plot.background = element_rect(fill = colors$background, color = NA),\n    panel.background = element_rect(fill = colors$background, color = NA)\n  )\n\n# Combined Plot ----\ncombined_plot <- p1 / p2 +\n  plot_annotation(\n    title = title_text,\n    subtitle = subtitle_text,\n    caption = caption_text,\n    theme = theme(\n      plot.title = element_markdown(\n        size = rel(1.6),\n        family = fonts$title,\n        face = \"bold\",\n        color = colors$title,\n        lineheight = 1.1,\n        margin = margin(t = 5, b = 5)\n      ),\n      plot.subtitle = element_text(\n        size = rel(1),\n        family = fonts$subtitle,\n        color = alpha(colors$subtitle, 0.9),\n        lineheight = 0.9,\n        margin = margin(t = 5, b = 10)\n      ),\n      plot.caption = element_markdown(\n        size = rel(0.6),\n        family = fonts$caption,\n        color = colors$caption,\n        hjust = 0.5,\n        margin = margin(t = 10)\n      ),\n     plot.margin = margin(25, 25, 25, 25),\n    )\n  )\n```\n````\n:::\n\n\n#### 7. Save\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: save\n#| warning: false\n\n### |-  plot image ----  \nsave_plot_patchwork(\n  plot = combined_plot, \n  type = \"makeovermonday\", \n  year = 2025,\n  week = 23,\n  width = 10, \n  height = 12\n  )\n```\n````\n:::\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 22631)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] here_1.0.1      patchwork_1.3.0 glue_1.8.0      scales_1.3.0   \n [5] showtext_0.9-7  showtextdb_3.0  sysfonts_0.8.9  ggtext_0.1.2   \n [9] lubridate_1.9.3 forcats_1.0.0   stringr_1.5.1   dplyr_1.1.4    \n[13] purrr_1.0.2     readr_2.1.5     tidyr_1.3.1     tibble_3.2.1   \n[17] ggplot2_3.5.1   tidyverse_2.0.0 pacman_0.5.1   \n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.6       xfun_0.49          htmlwidgets_1.6.4  tzdb_0.5.0        \n [5] yulab.utils_0.1.8  vctrs_0.6.5        tools_4.4.0        generics_0.1.3    \n [9] curl_6.0.0         gifski_1.32.0-1    fansi_1.0.6        pkgconfig_2.0.3   \n[13] ggplotify_0.1.2    skimr_2.1.5        readxl_1.4.3       lifecycle_1.0.4   \n[17] compiler_4.4.0     farver_2.1.2       munsell_0.5.1      janitor_2.2.0     \n[21] repr_1.1.7         codetools_0.2-20   snakecase_0.11.1   htmltools_0.5.8.1 \n[25] yaml_2.3.10        pillar_1.9.0       camcorder_0.1.0    magick_2.8.5      \n[29] commonmark_1.9.2   tidyselect_1.2.1   digest_0.6.37      stringi_1.8.4     \n[33] rsvg_2.6.1         rprojroot_2.0.4    fastmap_1.2.0      grid_4.4.0        \n[37] colorspace_2.1-1   cli_3.6.4          magrittr_2.0.3     base64enc_0.1-3   \n[41] utf8_1.2.4         withr_3.0.2        timechange_0.3.0   rmarkdown_2.29    \n[45] cellranger_1.1.0   hms_1.1.3          evaluate_1.0.1     knitr_1.49        \n[49] markdown_1.13      gridGraphics_0.5-1 rlang_1.1.6        gridtext_0.1.5    \n[53] Rcpp_1.0.13-1      xml2_1.3.6         renv_1.0.3         svglite_2.1.3     \n[57] rstudioapi_0.17.1  jsonlite_1.8.9     R6_2.5.1           fs_1.6.5          \n[61] systemfonts_1.1.0 \n```\n\n\n:::\n:::\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`mm_2025_23.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/MakeoverMonday/2025/mm_2025_23.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n#### 10. References\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1.  Data:\n\n-   Makeover Monday 2025 Week 23: [What future will U.S. truck manufacturing have under Trump?](https://data.world/makeovermonday/what-future-will-us-truck-manufacturing-have-under-trump)\n\n2.  Article\n\n-   Economic Policy Institute: [What future will U.S. truck manufacturing have under Trump?](https://www.epi.org/publication/future-clean-trucks-buses/)\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}