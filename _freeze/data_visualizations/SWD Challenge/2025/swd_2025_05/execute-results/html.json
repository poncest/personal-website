{
  "hash": "7453451871615ac25caef24f95ea978e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Disaster Death Distributions: 1950-2020\"\nsubtitle: \"How the patterns of mortality from natural disasters changed over time\"\ndescription: \"This visualization explores the evolving patterns of natural disaster-related deaths from 1950 to 2020 using ridgeline plots. The analysis reveals how mortality distributions have shifted across five major disaster types: drought, flood, earthquake, extreme weather, and extreme temperature.\"\nauthor: \"Steven Ponce\"\ndate: \"2025-05-02\"\ncategories: [\"SWDchallenge\", \"Data Visualization\", \"R Programming\", \"2025\"]\ntags: [\n  \"ridgeline plots\", \"natural disasters\", \"mortality patterns\", \"ggridges\", \"temporal analysis\", \"distribution visualization\", \"log scale\", \"disaster trends\", \"environmental data\", \"public health\", \"AI\", \"claude.ai\"\n]\nimage: \"thumbnails/swd_2025_05.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                          \n  cache: true                                                   \n  error: false\n  message: false\n  warning: false\n  eval: true\nshare:\n  permalink: \"https://stevenponce.netlify.app/data_visualizations/SWD Challenge/2025/swd_2025_05.html\" \n  description: \"Exploring seven decades of natural disaster mortality distributions through innovative ridgeline plots. See how death patterns from droughts, floods, earthquakes, and extreme weather events have evolved over time.\"\n  linkedin: true\n  twitter: true\n  email: true\n---\n\n\n\n### Original\n\nThis month's Storytelling with Data exercise aims to find a graph or slide that is ripe for improvement. Consider what you want to improve within the visual and implement those changes. Then, select an AI tool that can create visuals from prompts and a starting image. Ask the tool to consider the original image and prompt it to outline potential improvements. \n\n![Original chart](https://raw.githubusercontent.com/poncest/SWDchallenge/main/2025/05_May/img/original_chart.png\n){#fig-1}\n\nAdditional information can be found [HERE](https://community.storytellingwithdata.com/challenges/may-2025-compare-human-vs-machine)\n\n\n### AI (claude.ai)\n\n**Prompt Title:** Improve this chart on natural disaster deaths\n\n**Prompt:**\n\nThis is a historical stacked bar chart showing the decadal average number of deaths from natural disasters globally, segmented by disaster type (e.g., droughts, floods, earthquakes). The original chart is from Our World in Data and spans from 1900 to 2020.\nHelp redesign this visual to improve clarity, storytelling, and visual appeal. Please:\n\n-\tSimplify the visual by reducing clutter and using a limited, colorblind-friendly palette.\n-\tHighlight major insights, like the sharp decline in deaths over time and changing causes.\n-\tUse modern fonts, consistent scales, and clear legends.\n-\tCreate a layout that is easy to read and suitable for a web article or presentation.\n\nOutput a cleaner, more engaging visual that tells the story effectively to a broad audience.\n\n**Chat link:** https://claude.ai/chat/e8de4711-f7b5-4f82-b128-3a7f3568cc3f\n\n\n::: {layout-ncol=2}\n![AI-generated chart (a)](https://raw.githubusercontent.com/poncest/SWDchallenge/main/2025/05_May/img/claude.ai_01.png){#fig-2}\n\n![AI-generated chart (b)](https://raw.githubusercontent.com/poncest/SWDchallenge/main/2025/05_May/img/claude.ai_02.png){#fig-3}\n:::\n\n\n### Makeover\n\n![A ridgeline plot shows how disaster death distributions changed from 1950 to 2020 across five major disaster types: Drought, Flood, Earthquake, Extreme Weather, and Extreme Temperature. The visualization uses a rainbow color gradient from blue (1950s) to red (2020s) to display density curves of death patterns for each decade. The graph reveals shifting mortality distributions over time, with apparent variations in pattern and magnitude across different disaster types. Deaths are shown on a logarithmic scale from 0.1 to 1M.](swd_2025_05.png){#fig-4}\n\n\n### <mark> __Steps to Create this Graphic__ </mark>\n\n#### 1. Load Packages & Setup \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\n   tidyverse,         # Easily Install and Load the 'Tidyverse'\n  ggtext,            # Improved Text Rendering Support for 'ggplot2'\n  showtext,          # Using Fonts More Easily in R Graphs\n  scales,            # Scale Functions for Visualization\n  glue,              # Interpreted String Literals\n  here,              # A Simpler Way to Find Your Files\n  janitor,           # Simple Tools for Examining and Cleaning Dirty Data\n  skimr,             # Compact and Flexible Summaries of Data\n  ggridges,          # Ridgeline Plots in 'ggplot2'\n  RColorBrewer,      # ColorBrewer Palettes\n  camcorder          # Record Your Plot History\n) \n\n### |- figure size ---- \ngg_record( \n  dir    = here::here(\"temp_plots\"), \n  device = \"png\",\n  width  = 10,\n  height = 10,\n  units  = \"in\",\n  dpi    = 320)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n:::\n\n\n\n#### 2. Read in the Data \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeaths_disasters_type_raw <- read_csv(\n  here::here(\"data/MakeoverMonday/2025/decadal-deaths-disasters-type.csv\")) |> \n  clean_names() \n```\n:::\n\n\n\n#### 3. Examine the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(deaths_disasters_type_raw)\nskim(deaths_disasters_type_raw)\n```\n:::\n\n\n\n#### 4. Tidy Data \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pivot longer\ndeaths_long <- deaths_disasters_type_raw |>\n  pivot_longer(\n    cols = starts_with(\"deaths_\"),\n    names_to = \"disaster_type\",\n    values_to = \"deaths\"\n  ) |>\n  # Clean disaster type names\n  mutate(\n    disaster_type = str_remove(disaster_type, \"deaths_\"),\n    disaster_type = str_remove(disaster_type, \"_decadal\"),\n    disaster_type = str_replace_all(disaster_type, \"_\", \" \"),\n    disaster_type = str_to_title(disaster_type)\n  )\n\n# Summary by disaster type\ndisaster_summary <- deaths_long |>\n  group_by(disaster_type) |>\n  summarize(\n    total_deaths = sum(deaths, na.rm = TRUE),\n    countries_affected = sum(deaths > 0, na.rm = TRUE),\n    max_deaths = max(deaths, na.rm = TRUE), \n    .groups = \"drop\" \n  ) |>  \n  arrange(desc(total_deaths))\n\n# Top 5 disaster types\ntop5_disasters <- disaster_summary |>\n  top_n(5, total_deaths) |>\n  pull(disaster_type)\n\n# Plot data\nplot_data <- deaths_long |>\n  filter(\n    deaths > 0,\n    year >= 1950,  \n    disaster_type %in% top5_disasters\n  ) |>\n  # Reorder disaster types by total deaths\n  mutate(\n    disaster_type = factor(\n      disaster_type,   \n      levels = disaster_summary |> \n        filter(disaster_type %in% top5_disasters) |> \n        arrange(desc(total_deaths)) |> \n        pull(disaster_type)\n    ),\n    decade = as.factor(year)\n  )\n```\n:::\n\n\n\n\n#### 5. Visualization Parameters \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot aesthetics ----\n# Get base colors with custom palette\ncolors <- get_theme_colors(palette = rev(brewer.pal(8, \"Spectral\")))\n\n### |-  titles and caption ----\ntitle_text   <- str_glue(\"Disaster Death Distributions: 1950-2020\") \nsubtitle_text <- str_glue(\"How the patterns of mortality from natural disasters changed over time\")\n\n# Create caption\ncaption_text <- create_swd_caption(\n    year = 2025,\n    month = \"May\",\n    source_text = \"Data Source: Our World in Data, 'Death from Natural Disasters'\"\n  )\n\n# |- fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n  base_theme,\n  theme(\n    # Text styling \n    plot.title = element_text(face = \"bold\", family = fonts$title, size = rel(1.14), margin = margin(b = 10)),\n    plot.subtitle = element_text(family = fonts$subtitle, color = colors$text, size = rel(0.78), margin = margin(b = 20)),\n    \n    # Axis elements\n    axis.title = element_text(color = colors$text, size = rel(0.8)),\n    axis.text = element_text(color = colors$text, size = rel(0.7)),\n    \n    # Grid elements\n    panel.grid.minor = element_blank(),\n    panel.grid.major = element_line(color = \"grey95\", linewidth = 0.1),\n    \n    # Legend elements\n    legend.position = \"plot\",\n    legend.title = element_text(family = fonts$text, size = rel(0.8)),\n    legend.text = element_text(family = fonts$text, size = rel(0.7)),\n    \n    # Plot margins \n    plot.margin = margin(t = 20, r = 20, b = 20, l = 20),\n  )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n:::\n\n\n\n\n#### 6. Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- ggplot(plot_data, \n            aes(x = deaths, y = decade, fill = decade, height = after_stat(density))\n            ) +\n  # Geoms\n  geom_density_ridges(\n    scale = 3,\n    alpha = 0.85,\n    rel_min_height = 0.01,\n    bandwidth = 0.5,\n    color = \"white\",\n    linewidth = 0.2\n  ) +\n  # Scales\n  scale_x_log10(\n    # Special transformation with pseudo-log scale starting at 0\n    breaks = c(0, 1, 10, 100, 1000, 10000, 100000, 1000000, 10000000),\n    labels = c(\"0\", \"1\", \"10\", \"100\", \"1K\", \"10K\", \"100K\", \"1M\", \"10M\"),\n    expand = c(0.01, 0),\n    # Add small offset to avoid log(0) issue\n    trans = scales::pseudo_log_trans(base = 10)\n  ) +\n  scale_fill_manual(values = colors$palette) +\n  scale_y_discrete(expand = c(0, 0)) +\n  # Facets\n  facet_wrap(\n    ~disaster_type,\n    ncol = 3,\n    scales = \"fixed\"\n  ) +\n  # Labs\n  labs(\n    title = title_text,\n    subtitle = subtitle_text,\n    caption = caption_text,\n    x = \"Deaths per Decade (log scale)\",\n    y = NULL,\n  ) +\n  # Theme\n  theme(\n    plot.title = element_text(\n      size = rel(2),\n      family = fonts$title,\n      face = \"bold\",\n      color = colors$title,\n      lineheight = 1.1,\n      margin = margin(t = 5, b = 5)\n    ),\n    plot.subtitle = element_text(\n      size = rel(0.85),\n      family = fonts$subtitle,\n      color = colors$subtitle,\n      lineheight = 1.2,\n      margin = margin(t = 5, b = 20)\n    ),\n    plot.caption = element_markdown(\n      size = rel(0.6),\n      family = fonts$caption,\n      color = colors$caption,\n      hjust = 0.5,\n      margin = margin(t = 10)\n    ),\n    strip.background = element_rect(fill = \"#e0e0e0\", color = NA),\n    panel.spacing.x = unit(1, \"lines\"),\n    panel.spacing.y = unit(1, \"lines\"),\n  )\n```\n:::\n\n\n\n#### 7. Save\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot image ----  \n\nsource(here::here(\"R/image_utils.R\"))\nsave_plot(\n  p, type = 'swd', year = 2025, month = 05, \n  width = 10, height = 10\n  )\n```\n:::\n\n\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 22631)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] camcorder_0.1.0    RColorBrewer_1.1-3 ggridges_0.5.6     skimr_2.1.5       \n [5] janitor_2.2.0      here_1.0.1         glue_1.8.0         scales_1.3.0      \n [9] showtext_0.9-7     showtextdb_3.0     sysfonts_0.8.9     ggtext_0.1.2      \n[13] lubridate_1.9.3    forcats_1.0.0      stringr_1.5.1      dplyr_1.1.4       \n[17] purrr_1.0.2        readr_2.1.5        tidyr_1.3.1        tibble_3.2.1      \n[21] ggplot2_3.5.1      tidyverse_2.0.0    pacman_0.5.1      \n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.6      xfun_0.49         htmlwidgets_1.6.4 tzdb_0.5.0       \n [5] vctrs_0.6.5       tools_4.4.0       generics_0.1.3    curl_6.0.0       \n [9] parallel_4.4.0    gifski_1.32.0-1   fansi_1.0.6       pkgconfig_2.0.3  \n[13] lifecycle_1.0.4   farver_2.1.2      compiler_4.4.0    textshaping_0.4.0\n[17] munsell_0.5.1     repr_1.1.7        codetools_0.2-20  snakecase_0.11.1 \n[21] htmltools_0.5.8.1 yaml_2.3.10       crayon_1.5.3      pillar_1.9.0     \n[25] magick_2.8.5      commonmark_1.9.2  tidyselect_1.2.1  digest_0.6.37    \n[29] stringi_1.8.4     rsvg_2.6.1        rprojroot_2.0.4   fastmap_1.2.0    \n[33] grid_4.4.0        colorspace_2.1-1  cli_3.6.4         magrittr_2.0.3   \n[37] base64enc_0.1-3   utf8_1.2.4        withr_3.0.2       bit64_4.5.2      \n[41] timechange_0.3.0  rmarkdown_2.29    bit_4.5.0         ragg_1.3.3       \n[45] hms_1.1.3         evaluate_1.0.1    knitr_1.49        markdown_1.13    \n[49] rlang_1.1.6       gridtext_0.1.5    Rcpp_1.0.13-1     xml2_1.3.6       \n[53] renv_1.0.3        svglite_2.1.3     rstudioapi_0.17.1 vroom_1.6.5      \n[57] jsonlite_1.8.9    R6_2.5.1          systemfonts_1.1.0\n```\n\n\n:::\n:::\n\n\n:::\n\n\n#### 9. GitHub Repository\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n \nThe complete code for this analysis is available in [`swd_2025_05.qmd`](https://github.com/poncest/personal-website/tree/master/data_visualizations/SWD%20Challenge/2025/swd_2025_05.qmd).\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n#### 10. References\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n \nData Sources:\n\n- Death from Natural Disasters: [Our World in Data via Makeover Monday 2024 week 25](https://data.world/makeovermonday/a-century-of-global-deaths-from-disasters)\n\nArticle:\n\n- Our World in Data: [Natural Disasters: How many people die from disasters, and how are these impacts changing over time?](https://ourworldindata.org/natural-disasters)\n\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}