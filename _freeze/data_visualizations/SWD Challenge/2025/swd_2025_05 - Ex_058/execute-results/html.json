{
  "hash": "c900c9468a224c126fe48e712bd0d7b9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Client Contact Program: Uneven Success Demands Strategic Response\"\nsubtitle: \"Overall program succeeded, but stark performance gaps require immediate resource reallocation\"\ndescription: \"A strategic data visualization exercise demonstrating how to select and combine chart types for maximum business impact. Using client contact program data, this analysis shows how diverging bar charts paired with slope charts can drive executive decision-making by highlighting performance gaps that demand immediate resource reallocation and accountability discussions.\"\nauthor: \"Steven Ponce\"\ndate: \"2025-05-23\"\ncategories: [\"SWDchallenge\", \"Exercise\", \"Data Visualization\", \"R Programming\", \"2025\"]\ntags: [\n  \"patchwork\", \"diverging-charts\", \"slope-charts\", \"business-analytics\",\n  \"executive-reporting\", \"performance-analysis\", \"chart-selection\",\n  \"strategic-visualization\", \"ggplot2\", \"data-storytelling\",\n  \"concierge-services\", \"client-management\", \"resource-allocation\",\n  \"accountability-metrics\", \"visual-hierarchy\", \"color-strategy\"\n]\nimage: \"thumbnails/swd_2025_05-Ex_0058.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                          \n  cache: true                                                   \n  error: false\n  message: false\n  warning: false\n  eval: true\n---\n\n### Original\n\nThe goal of this exercise is to learn how to select and combine the most effective chart types that drive specific business decisions rather than just displaying data.\n\nIn essence, it's about becoming a strategic data storyteller who can:\n\n-   Evaluate multiple visualization options critically\n-   Choose charts that support clear business actions\n-   Combine visualizations to tell a complete, compelling story\n-   Transform raw data into executive-ready insights that drive immediate decisions\n\nThe exercise teaches you that chart selection is a strategic business skill, not just a technical one!\n\n![Original chart](https://stwd-prod-static-back.s3.amazonaws.com/media/Screenshot_2025-05-19_at_14.44.08.png){#fig-1}\n\nAdditional information can be found [HERE](https://community.storytellingwithdata.com/exercises/which-chart-shows-it-best)\n\n### Makeover\n\n![Combined chart showing client contact program results. Top panel: horizontal bar chart with Executive Services showing +20 percentage point improvement (blue), Travel & Experiences +8pp (dark gray), Elite Access +2pp (light gray), and Lifestyle Services -3pp decline (red). Bottom panel: slope chart showing performance trends from before to after the program, with Executive Services rising steeply from 69% to 89% (blue line), while Lifestyle Services declined from 75% to 72% (red line). Gray lines show Travel & Experiences and Elite Access with modest improvements. A 90% target line is marked.](swd_2025_05-Ex_0058.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: load\n\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\ntidyverse,         # Easily Install and Load the 'Tidyverse'\n  ggtext,            # Improved Text Rendering Support for 'ggplot2'\n  showtext,          # Using Fonts More Easily in R Graphs\n  scales,            # Scale Functions for Visualization\n  glue,              # Interpreted String Literals\n  patchwork          # The Composer of Plots \n) \n\n### |- figure size ---- \ncamcorder::gg_record( \n  dir    = here::here(\"temp_plots\"), \n  device = \"png\",\n  width  = 8,\n  height = 8,\n  units  = \"in\",\n  dpi    = 320)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n````\n:::\n\n\n#### 2. Read in the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: read\n\nraw_data <- readxl::read_excel(\n  here::here(\"data\", \"SWDchallenge\", \"2025\", \"swdexercise058 DATA.xlsx\"),\n  sheet   = \"MAIN\",\n  range   = \"B4:D9\",\n  trim_ws = TRUE\n) |>\n  janitor::clean_names()\n```\n````\n:::\n\n\n#### 3. Examine the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: examine\n#| include: true\n#| eval: true\n#| results: 'hide'\n#| warning: false\n\nglimpse(raw_data)\n```\n````\n:::\n\n\n#### 4. Tidy Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: tidy\n\ntidy_data <- raw_data |>\n  filter(category != \"Total\") |>\n  pivot_longer(cols = c(last_quarter, this_quarter), \n               names_to = \"period\", \n               values_to = \"contact_rate\") |>\n  mutate(\n    period = case_when(\n      period == \"last_quarter\" ~ \"Before Program\",\n      period == \"this_quarter\" ~ \"After Program\"\n    ),\n    period = factor(period, levels = c(\"Before Program\", \"After Program\"))\n  ) |> \n  mutate(\n    category_short = case_when(\n      category == \"Elite access & bespoke requests\" ~ \"Elite Access\",\n      category == \"Travel & experiences\" ~ \"Travel & Experiences\", \n      category == \"Executive services\" ~ \"Executive Services\",\n      category == \"Lifestyle services\" ~ \"Lifestyle Services\",\n      TRUE ~ category\n    )\n  )\n\nchange_data <- raw_data |>  \n  filter(category != \"Total\") |>\n  mutate(\n    change = this_quarter - last_quarter,\n    # Shorter category names for better display\n    category_short = case_when(\n      category == \"Elite access & bespoke requests\" ~ \"Elite Access\",\n      category == \"Travel & experiences\" ~ \"Travel & Experiences\", \n      category == \"Executive services\" ~ \"Executive Services\",\n      category == \"Lifestyle services\" ~ \"Lifestyle Services\",\n      TRUE ~ category\n    ),\n    strategic_color = case_when(\n      change >= 0.15 ~ \"exceptional\",     \n      change >= 0.05 ~ \"strong\",        \n      change >= -0.01 ~ \"stable\",       \n      TRUE ~ \"concerning\"               \n    ),\n    action_needed = case_when(\n      change >= 0.15 ~ \"Recognize & Scale\",\n      change >= 0.05 ~ \"Reinforce Success\", \n      change >= -0.01 ~ \"Monitor Closely\",\n      TRUE ~ \"Immediate Intervention\"\n    )\n  )\n```\n````\n:::\n\n\n#### 5. Visualization Parameters\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: params\n\n### |-  plot aesthetics ----\ncolors <- get_theme_colors(\n  palette = c(\n    \"exceptional\"= \"#1f77b4\", \"strong\"= \"#969696\", \"stable\" = \"#bdbdbd\", \"concerning\" = \"#d62728\",\n    \"Executive services\"= \"#1f77b4\", \"Travel & experiences\"= \"#969696\", \n    \"Elite access & bespoke requests\" = \"#bdbdbd\", \"Lifestyle services\" = \"#d62728\"\n  )\n)\n\n### |-  titles and caption ----\ntitle_text <- str_glue(\"Client Contact Program: Uneven Success Demands Strategic Response\")\nsubtitle_text <- str_glue(\"Overall program succeeded, but stark performance gaps require immediate\\nresource reallocation\")\n\n# Create caption\ncaption_text <- create_swd_exe_caption(\n  year = 2025,\n  month = \"May\",\n  source_text =  \"Let's Practice! Exercise 5.8\"\n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n  base_theme,\n  theme(\n    # Text styling \n    plot.title = element_text(face = \"bold\", family = fonts$title, color = colors$title, size = rel(1.14), margin = margin(b = 10)),\n    plot.subtitle = element_text(family = fonts$subtitle, color = colors$text, size = rel(0.78), margin = margin(b = 20)),\n    \n    # Axis elements\n    axis.title = element_text(color = colors$text, size = rel(0.8)),\n    axis.text = element_text(color = colors$text, size = rel(0.7)),\n    \n    # Grid elements\n    panel.grid.minor = element_blank(),\n    panel.grid.major = element_line(color = \"grey95\", linewidth = 0.1),\n    \n    # Legend elements\n    legend.position = \"plot\",\n    legend.title = element_text(family = fonts$text, size = rel(0.8)),\n    legend.text = element_text(family = fonts$text, size = rel(0.7)),\n    \n    # Plot margins \n    plot.margin = margin(t = 10, r = 15, b = 10, l = 15),\n  )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n````\n:::\n\n\n#### 6. Plot\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: plot\n\n# P1. Diverging Chart ----\np1 <- ggplot(change_data, aes(\n  x = reorder(category_short, change),\n  y = change, fill = strategic_color\n)) +\n  geom_hline(yintercept = 0, color = \"gray40\", linewidth = 0.5, alpha = 0.8) +\n  geom_col(width = 0.7, alpha = 0.9) +\n  geom_text(aes(label = paste0(ifelse(change > 0, \"+\", \"\"), round(change * 100, 1), \"pp\")),\n    hjust = ifelse(change_data$change > 0, -0.1, 1.1),\n    size = 4.2, fontface = \"bold\", color = \"black\"\n  ) +\n  # Scales\n  scale_y_continuous(\n    labels = function(x) paste0(ifelse(x > 0, \"+\", \"\"), x * 100, \"pp\"),\n    breaks = seq(-0.1, 0.20, 0.05),\n    expand = expansion(mult = c(0.15, 0.15))\n  ) +\n  scale_fill_manual(values = colors$palette) +\n  coord_flip() +\n  # Labs\n  labs(\n    title = \"Executive Services Soars (+20pp), Lifestyle Services Stumbles (-3pp)\",\n    subtitle = \"Performance gaps this wide demand immediate strategic intervention\",\n    x = \"\",\n    y = \"Change in Contact Rate\"\n  ) +\n  # Theme\n  theme(\n    plot.title = element_text(size = rel(1), face = \"bold\", color = colors$title, family = fonts$title),\n    plot.subtitle = element_text(size = rel(0.71), color = colors$subtitle, family = fonts$subtitle),\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n  )\n\n# P2. Slope Chart ----\np2 <- ggplot(tidy_data, aes(x = period, y = contact_rate, group = category_short, color = category)) +\n  # Geoms\n  geom_hline(yintercept = 0.90, linetype = \"dashed\", color = \"gray40\", alpha = 0.6, size = 0.5) +\n  geom_line(\n    aes(size = ifelse(category_short == \"Executive Services\", 3,\n      ifelse(category_short == \"Lifestyle Services\", 2.0, 1.0)\n    )),\n    alpha = 0.9\n  ) +\n  geom_point(aes(size = ifelse(category_short %in% c(\"Executive Services\", \"Lifestyle Services\"), 3, 2))) +\n  geom_text(\n    data = tidy_data |>\n      filter(\n        period == \"After Program\",\n        category_short %in% c(\"Executive Services\", \"Lifestyle Services\")\n      ),\n    aes(label = category_short),\n    hjust = -0.1, vjust = 0.5, size = 3.2, color = \"black\"\n  ) +\n  # Annotate\n  annotate(\"text\",\n    x = 1.5, y = 0.92, label = \"90% Target\",\n    size = 3, color = \"gray40\", fontface = \"italic\"\n  ) +\n  # Scales\n  scale_y_continuous(\n    labels = percent_format(accuracy = 1),\n    limits = c(0.65, 1.0),\n    breaks = seq(0.70, 1.0, 0.10)\n  ) +\n  scale_x_discrete(expand = expansion(mult = c(0.1, 0.35))) +\n  scale_color_manual(values = colors$palette) +\n  scale_size_identity() +\n  labs(\n    title = \"The Journey: Dramatic Trajectories Reveal Strategic Opportunities\",\n    subtitle = \"Steepest slopes indicate departments to celebrate and investigate\",\n    x = \"\",\n    y = \"Client Contact Rate\"\n  ) +\n  # Theme\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(size = rel(1), face = \"bold\", color = colors$title, family = fonts$title),\n    plot.subtitle = element_text(size = rel(0.71), color = colors$subtitle, family = fonts$subtitle),\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_line(color = \"gray60\", linewidth = 0.25),\n  )\n\n# Combined Plot -----\ncombined_plot <- (p1 / p2) +\n  plot_layout(heights = c(1, 1.1))\n\ncombined_plot <- combined_plot +\n  plot_annotation(\n    title = title_text,\n    subtitle = subtitle_text,\n    caption = caption_text,\n    theme = theme(\n      plot.title = element_text(\n        size = rel(1.25),\n        family = fonts$title,\n        face = \"bold\",\n        color = colors$title,\n        lineheight = 1.1,\n        margin = margin(t = 5, b = 5)\n      ),\n      plot.subtitle = element_text(\n        size = rel(0.9),\n        family = fonts$subtitle,\n        color = colors$subtitle,\n        lineheight = 1.2,\n        margin = margin(t = 5, b = 10)\n      ),\n      plot.caption = element_markdown(\n        size   = rel(0.6),\n        family = fonts$caption,\n        color  = colors$caption,\n        hjust  = 0.5,\n        margin = margin(t = 10)\n      ),\n      plot.margin = margin(t = 20, r = 10, b = 20, l = 10),\n    )\n  )\n```\n````\n:::\n\n\n#### 7. Save\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: save\n\n### |-  plot image ----  \nsave_plot_patchwork(\n  combined_plot, \n  type = 'swd', \n  year = 2025, \n  month = 05, \n  exercise = 058,\n  width = 8, \n  height = 8\n  )\n```\n````\n:::\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 22631)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] here_1.0.1      patchwork_1.3.0 glue_1.8.0      scales_1.3.0   \n [5] showtext_0.9-7  showtextdb_3.0  sysfonts_0.8.9  ggtext_0.1.2   \n [9] lubridate_1.9.3 forcats_1.0.0   stringr_1.5.1   dplyr_1.1.4    \n[13] purrr_1.0.2     readr_2.1.5     tidyr_1.3.1     tibble_3.2.1   \n[17] ggplot2_3.5.1   tidyverse_2.0.0 pacman_0.5.1   \n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.6       xfun_0.49          htmlwidgets_1.6.4  tzdb_0.5.0        \n [5] yulab.utils_0.1.8  vctrs_0.6.5        tools_4.4.0        generics_0.1.3    \n [9] curl_6.0.0         gifski_1.32.0-1    fansi_1.0.6        pkgconfig_2.0.3   \n[13] ggplotify_0.1.2    readxl_1.4.3       rematch_2.0.0      lifecycle_1.0.4   \n[17] compiler_4.4.0     farver_2.1.2       munsell_0.5.1      janitor_2.2.0     \n[21] codetools_0.2-20   snakecase_0.11.1   htmltools_0.5.8.1  yaml_2.3.10       \n[25] pillar_1.9.0       camcorder_0.1.0    magick_2.8.5       commonmark_1.9.2  \n[29] tidyselect_1.2.1   digest_0.6.37      stringi_1.8.4      rsvg_2.6.1        \n[33] rprojroot_2.0.4    fastmap_1.2.0      grid_4.4.0         colorspace_2.1-1  \n[37] cli_3.6.4          magrittr_2.0.3     utf8_1.2.4         withr_3.0.2       \n[41] timechange_0.3.0   rmarkdown_2.29     cellranger_1.1.0   hms_1.1.3         \n[45] evaluate_1.0.1     knitr_1.49         markdown_1.13      gridGraphics_0.5-1\n[49] rlang_1.1.6        gridtext_0.1.5     Rcpp_1.0.13-1      xml2_1.3.6        \n[53] renv_1.0.3         svglite_2.1.3      rstudioapi_0.17.1  jsonlite_1.8.9    \n[57] R6_2.5.1           fs_1.6.5           systemfonts_1.1.0 \n```\n\n\n:::\n:::\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`swd_2025_05 - Ex_058.qmd`](https://github.com/poncest/personal-website/tree/master/data_visualizations/SWD%20Challenge/2025/swd_2025_05-Ex_058.qmd). For the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n#### 10. References\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\nData Sources:\n\n1.  Data Sources:\n\n    -   Storytelling with Data Exercise \\| which chart shows it best?: [Download the data](https://docs.google.com/spreadsheets/d/125uh8nYavGu-tYc3tlulDIchmoVZQqBk/edit?gid=1444625075#gid=1444625075)\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}