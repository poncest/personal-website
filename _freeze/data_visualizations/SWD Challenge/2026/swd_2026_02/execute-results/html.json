{
  "hash": "f728ab32f5df31e86e97a27670cf1423",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"If It Feels Hard to Read, It Probably Is\"\nsubtitle: \"Grouped bars make comparison difficult. A dumbbell chart instantly reveals the education gap -- years of schooling promised to children vs. what adults actually completed.\"\ndescription: \"A before-and-after visualization demonstrating the SWD lesson 'Trust Your Instincts' from Chapter 5 of storytelling with data: before & after. When comparing paired values across many categories, grouped bar charts create visual clutter. Switching to a dumbbell chart makes the education gap between expected and actual years of schooling instantly clear.\"\nauthor: \"Steven Ponce\"\ndate: \"2026-02-01\" \ncategories: [\"SWDchallenge\", \"Data Visualization\", \"R Programming\", \"2026\"]\ntags: [\n  \"dumbbell-chart\",\n  \"connected-dot-plot\",\n  \"grouped-bar-chart\",\n  \"before-after\",\n  \"education-data\",\n  \"UNDP\",\n  \"ggplot2\",\n  \"patchwork\",\n  \"chart-makeover\"\n]\nimage: \"thumbnails/swd_2026_02.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                          \n  cache: true                                                   \n  error: false\n  message: false\n  warning: false\n  eval: true\n---\n\n### Challenge\n\nThis month's challenge invites you to share your favorite SWD-inspired tip or lesson and bring it to life through a visual. Create something new or highlight an SWD example that illustrates it well.\n\nAdditional information can be found [HERE](https://community.storytellingwithdata.com/challenges/feb-2026-share-your-favorite-swd-tip)\n\n### Visualization\n\n![Before-and-after comparison of the same education data. The left panel shows a grouped bar chart comparing expected vs. actual years of schooling across 15 countries â€” the paired bars make it hard to compare gaps. The right panel shows the same data as a dumbbell chart, where connected dots instantly reveal the education gap for each country. Australia, China, and Brazil have the largest gaps (7+ years), while USA, South Africa, and Japan have the smallest (around 2-3 years). The visualization demonstrates the SWD lesson: if a chart feels hard to read, try a different format.](swd_2026_02.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: load\n\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\ntidyverse, ggtext, showtext, janitor,\n  scales, glue, readxl, patchwork\n)\n\n### |- figure size ---- \ncamcorder::gg_record(\n  dir    = here::here(\"temp_plots\"),\n  device = \"png\",\n  width  = 14,\n  height = 8,\n  units  = \"in\",\n  dpi    = 320\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n````\n:::\n\n\n#### 2. Read in the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: read\n\nhdi_url   <- \"https://hdr.undp.org/sites/default/files/2025_HDR/HDR25_Statistical_Annex_HDI_Table.xlsx\"\ntemp_file <- tempfile(fileext = \".xlsx\")\ndownload.file(hdi_url, temp_file, mode = \"wb\")\n\nhdi_raw <- read_excel(temp_file, skip = 5) |>\n  clean_names()\n\n### |- Data Source ----\n# Primary Source: UNDP Human Development Report 2025\n# URL: https://hdr.undp.org/sites/default/files/2025_HDR/HDR25_Statistical_Annex_HDI_Table.xlsx\n# Date Accessed: February 1, 2026\n# Table: Statistical Annex Table 1 - Human Development Index and components\n# Variables: Expected years of schooling, Mean years of schooling\n# Documentation: https://hdr.undp.org/data-center/documentation-and-downloads\n```\n````\n:::\n\n\n#### 3. Examine the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: examine\n#| include: true\n#| eval: true\n#| results: 'hide'\n#| warning: false\n\nglimpse(hdi_raw)\nskimr::skim_without_charts(hdi_raw) \n```\n````\n:::\n\n\n#### 4. Tidy Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: tidy\n\neducation_data <- hdi_raw |>\n  select(\n    country,\n    expected_years = years_7,\n    actual_years   = years_9\n  ) |>\n  mutate(actual_years = as.numeric(actual_years)) |>\n  filter(\n    !is.na(country),\n    !is.na(expected_years),\n    !is.na(actual_years),\n    !str_detect(country, \"development$|OECD|countries$|World\")\n  )\n\nselected_countries <- c(\n  \"Australia\", \"Germany\", \"United Kingdom\", \"United States\", \"Japan\", \"Korea (Republic of)\",\n  \"Chile\", \"Mexico\", \"Brazil\", \"China\",\n  \"Indonesia\", \"India\", \"South Africa\",\n  \"Nigeria\", \"Kenya\"\n)\n\neducation_plot <- education_data |>\n  filter(country %in% selected_countries) |>\n  mutate(\n    country = case_when(\n      country == \"Korea (Republic of)\" ~ \"South Korea\",\n      country == \"United Kingdom\" ~ \"UK\",\n      country == \"United States\" ~ \"USA\",\n      TRUE ~ country\n    ),\n    gap = expected_years - actual_years,\n    gap_mid = (expected_years + actual_years) / 2,\n    gap_lab = paste0(\"+\", sprintf(\"%.1f\", gap), \" yrs\")\n  ) |>\n  arrange(desc(gap)) |>\n  mutate(country = factor(country, levels = rev(country)))\n\neducation_long <- education_plot |>\n  select(country, expected_years, actual_years) |>\n  pivot_longer(\n    cols      = c(expected_years, actual_years),\n    names_to  = \"measure\",\n    values_to = \"years\"\n  ) |>\n  mutate(\n    # Self-explanatory legend labels\n    measure = recode(\n      measure,\n      expected_years = \"Years children are promised\",\n      actual_years   = \"Years adults completed\"\n    ),\n    measure = factor(measure, levels = c(\"Years children are promised\", \"Years adults completed\"))\n  )\n```\n````\n:::\n\n\n#### 5. Visualization Parameters\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: params\n\n### |-  plot aesthetics ----\ncolors <- get_theme_colors(\n  palette = list(\n    expected   = \"#E07A5F\",\n    actual     = \"#3D405B\",\n    connector  = \"gray75\",\n    gap_text   = \"#457B6D\"\n  )\n)\n\n### |-  titles and caption ----\ntitle_text <- \"If It Feels Hard to Read, It Probably Is\"\n\nsubtitle_text <- str_glue(\n  \"Grouped bars make comparison difficult. A dumbbell chart instantly reveals the education gap\\nyears of schooling promised to children vs. what adults actually completed.\"\n)\n\ncaption_text <- create_swd_caption(\n  year = 2026,\n  month = \"Feb\",\n  source_text = \"UNDP Human Development Report 2025\"\n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n  base_theme,\n  theme(\n    # Text styling\n    plot.title = element_text(\n      face = \"bold\", family = fonts$title, size = rel(1.4),\n      color = colors$palette$title, margin = margin(b = 10), hjust = 0\n    ),\n    plot.subtitle = element_text(\n      family = fonts$subtitle, lineheight = 1.2,\n      color = colors$palette$subtitle, size = rel(0.9), margin = margin(b = 20), hjust = 0\n    ),\n    \n    ## Grid\n    panel.grid = element_blank(),\n    panel.grid.major.x = element_blank(),\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.x = element_blank(),\n    panel.grid.minor.y = element_blank(),\n    \n    # Axes\n    axis.title.x =  element_text(size = rel(0.9), color = \"gray30\", margin = margin(t = 20)),\n    axis.title.y = element_text(size = rel(0.9), color = \"gray30\",  margin = margin(r = 20)),\n    axis.text = element_text(color = \"gray30\"),\n    # axis.text.y = element_text(size = rel(0.95)),\n    axis.ticks = element_blank(),\n    \n    # Facets\n    strip.background = element_rect(fill = \"gray95\", color = NA),\n    strip.text = element_text(\n      face = \"bold\",\n      color = \"gray20\",\n      size = rel(1),\n      margin = margin(t = 8, b = 8)\n    ),\n    panel.spacing = unit(2, \"lines\"),\n    \n    # Legend elements\n    legend.position = \"right\",\n    legend.title = element_text(\n      family = fonts$subtitle,\n      color = colors$palette$text, size = rel(0.8), face = \"bold\"\n    ),\n    legend.text = element_text(\n      family = fonts$tsubtitle,\n      color = colors$palette$text, size = rel(0.7)\n    ),\n    legend.margin = margin(t = 0, r = 0, b = 0, l = 10),\n    \n    # Plot margin\n    plot.margin = margin(10, 20, 10, 20)\n  )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n````\n:::\n\n\n#### 6. Plot\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: plot\n\n### |- before plot ----\np_before <- ggplot(education_long, aes(x = country, y = years, fill = measure)) +\n  # Geoms\n  geom_col(position = position_dodge(width = 0.8), width = 0.7) +\n  # Scales\n  scale_fill_manual(\n    values = c(\n      \"Years children are promised\" = colors$palette$expected,\n      \"Years adults completed\" = colors$palette$actual\n    ),\n    name = NULL\n  ) +\n  scale_y_continuous(\n    limits = c(0, 25),\n    breaks = seq(0, 25, 5),\n    expand = expansion(mult = c(0, 0.02))\n  ) +\n  coord_flip(clip = \"off\") +\n  # Labs\n  labs(\n    title = \"BEFORE\",\n    subtitle = \"Grouped bar chart â€” hard to compare gaps\",\n    x = NULL,\n    y = \"Years of Schooling\"\n  ) +\n  # Theme\n  theme(\n    plot.subtitle = element_text(color = \"gray40\", size = 10),\n    legend.position = \"top\",\n    legend.justification = \"left\",\n    legend.text = element_text(color = \"gray40\", size = 8),\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor = element_blank(),\n    axis.text.y = element_text(size = 9)\n  )\n\n### |- after plot ----\np_after <- ggplot(education_plot, aes(y = country)) +\n  # Geoms\n  geom_segment(\n    aes(x = actual_years, xend = expected_years, yend = country),\n    linewidth = 1.5,\n    color = colors$palette$connector,\n    lineend = \"round\"\n  ) +\n  geom_point(aes(x = actual_years), color = colors$palette$actual, size = 3.6) +\n  geom_point(aes(x = expected_years), color = colors$palette$expected, size = 3.6) +\n  geom_text(\n    aes(x = gap_mid, label = gap_lab),\n    color = colors$palette$gap_text,\n    size = 2.8,\n    family = fonts$text,\n    fontface = \"bold\",\n    vjust = -0.9\n  ) +\n  # Annotate\n  annotate(\n    \"point\",\n    x = 2.5, y = 2,\n    color = colors$palette$actual, size = 3.2\n  ) +\n  annotate(\n    \"text\",\n    x = 3.2, y = 2, label = \"Years adults completed\",\n    color = colors$palette$actual, size = 2.8, hjust = 0, family = fonts$text\n  ) +\n  annotate(\n    \"point\",\n    x = 2.5, y = 1,\n    color = colors$palette$expected, size = 3.2\n  ) +\n  annotate(\n    \"text\",\n    x = 3.2, y = 1, label = \"Years children are promised\",\n    color = colors$palette$expected, size = 2.8, hjust = 0, family = fonts$text\n  ) +\n  # Scales\n  scale_x_continuous(\n    limits = c(0, 25),\n    breaks = seq(0, 25, 5),\n    expand = expansion(mult = c(0.02, 0.06))\n  ) +\n  # Labs\n  labs(\n    title = \"AFTER\",\n    subtitle = \"Dumbbell chart â€” gaps are instantly clear\",\n    x = \"Years of Schooling\",\n    y = NULL\n  ) +\n  # Theme\n  theme(\n    plot.subtitle = element_text(color = \"gray40\", size = 10),\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor = element_blank(),\n    axis.text.y = element_text(size = 9)\n  )\n\n### |- combined plots ----\ncombined_plot <- (p_before | p_after) +\n  plot_annotation(\n    title = title_text,\n    subtitle = subtitle_text,\n    caption = caption_text,\n    theme = theme(\n      plot.title = element_text(\n        size = rel(1.8),\n        family = fonts$title,\n        face = \"bold\",\n        color = colors$title,\n        lineheight = 1.15,\n        margin = margin(t = 5, b = 5)\n      ),\n      plot.subtitle = element_text(\n        size = rel(0.8),\n        family = fonts$subtitle,\n        color = alpha(colors$subtitle, 0.88),\n        lineheight = 1.3,\n        margin = margin(t = 5, b = 10)\n      ),\n      plot.caption = element_markdown(\n        size = rel(0.65),\n        family = fonts$subtitle,\n        color = colors$caption,\n        hjust = 0,\n        lineheight = 1.4,\n        margin = margin(t = 20, b = 5)\n      ),\n    )\n  )\n```\n````\n:::\n\n\n#### 7. Save\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: save\n\n### |-  plot image ----  \nsave_plot_patchwork(\n  combined_plot, \n  type = 'swd', \n  year = 2026, \n  month = 02, \n  width  = 14,\n  height = 8,\n  )\n```\n````\n:::\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 26100)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] here_1.0.1      patchwork_1.3.0 readxl_1.4.3    glue_1.8.0     \n [5] scales_1.3.0    janitor_2.2.0   showtext_0.9-7  showtextdb_3.0 \n [9] sysfonts_0.8.9  ggtext_0.1.2    lubridate_1.9.3 forcats_1.0.0  \n[13] stringr_1.5.1   dplyr_1.1.4     purrr_1.0.2     readr_2.1.5    \n[17] tidyr_1.3.1     tibble_3.2.1    ggplot2_3.5.1   tidyverse_2.0.0\n[21] pacman_0.5.1   \n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.6       xfun_0.49          htmlwidgets_1.6.4  tzdb_0.5.0        \n [5] yulab.utils_0.1.8  vctrs_0.6.5        tools_4.4.0        generics_0.1.3    \n [9] curl_6.0.0         gifski_1.32.0-1    fansi_1.0.6        pkgconfig_2.0.3   \n[13] ggplotify_0.1.2    skimr_2.1.5        lifecycle_1.0.4    compiler_4.4.0    \n[17] farver_2.1.2       munsell_0.5.1      repr_1.1.7         codetools_0.2-20  \n[21] snakecase_0.11.1   htmltools_0.5.8.1  yaml_2.3.10        pillar_1.9.0      \n[25] camcorder_0.1.0    magick_2.8.5       commonmark_1.9.2   tidyselect_1.2.1  \n[29] digest_0.6.37      stringi_1.8.4      rsvg_2.6.1         rprojroot_2.0.4   \n[33] fastmap_1.2.0      grid_4.4.0         colorspace_2.1-1   cli_3.6.4         \n[37] magrittr_2.0.3     base64enc_0.1-3    utf8_1.2.4         withr_3.0.2       \n[41] timechange_0.3.0   rmarkdown_2.29     cellranger_1.1.0   hms_1.1.3         \n[45] evaluate_1.0.1     knitr_1.49         markdown_1.13      gridGraphics_0.5-1\n[49] rlang_1.1.6        gridtext_0.1.5     Rcpp_1.0.13-1      xml2_1.3.6        \n[53] renv_1.0.3         svglite_2.1.3      rstudioapi_0.17.1  jsonlite_1.8.9    \n[57] R6_2.5.1           fs_1.6.5           systemfonts_1.1.0 \n```\n\n\n:::\n:::\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`swd_2026_02.qmd`](https://github.com/poncest/personal-website/tree/master/data_visualizations/SWD%20Challenge/2026/swd_2026_02.qmd). For the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n#### 10. References\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n**SWD Challenge:**\n\n- Storytelling with Data: [Feb 2026 - share your favorite SWD tip](https://community.storytellingwithdata.com/challenges/feb-2026-share-your-favorite-swd-tip)\n\n**Data Source:**\n- United Nations Development Programme. (2025). *Human Development Report 2025: Statistical Annex Table 1 - Human Development Index and components*. Retrieved February 1, 2026, from <https://hdr.undp.org/data-center/documentation-and-downloads>\n\n**Book Reference:**\n- Knaflic, C. N., Cisneros, A., & Velez, K. (2025). *storytelling with data: before & after*. Wiley. Chapter 5: Trust Your Instincts.\n\n:::\n\n\n#### 11. Custom Functions Documentation\n\n::: {.callout-note collapse=\"true\"}\n##### ðŸ“¦ Custom Helper Functions\n\nThis analysis uses custom functions from my personal module library for efficiency and consistency across projects.\n\n**Functions Used:**\n\n-   **`fonts.R`**: `setup_fonts()`, `get_font_families()` - Font management with showtext\n-   **`social_icons.R`**: `create_social_caption()` - Generates formatted social media captions\n-   **`image_utils.R`**: `save_plot()` - Consistent plot saving with naming conventions\n-   **`base_theme.R`**: `create_base_theme()`, `extend_weekly_theme()`, `get_theme_colors()` - Custom ggplot2 themes\n\n**Why custom functions?**\\\nThese utilities standardize theming, fonts, and output across all my data visualizations. The core analysis (data tidying and visualization logic) uses only standard tidyverse packages.\n\n**Source Code:**\\\nView all custom functions â†’ [GitHub: R/utils](https://github.com/poncest/personal-website/tree/master/R)\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}