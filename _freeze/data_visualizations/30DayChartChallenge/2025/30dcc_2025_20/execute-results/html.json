{
  "hash": "1b5984b97d7d5ba9d0b125a5fe3ca427",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"The Shifting Speeds of Urbanization (1960-2023)\"\nsubtitle: \"Annual growth rates show when countries urbanized fastest and when they slowed down\"\ndescription: \"Exploring the dynamic rates of urbanization across eight countries from 1960 to 2023 using World Bank data. This visualization reveals when countries underwent their most rapid urban transitions and when urbanization slowed or reversed.\"\ndate: \"2025-04-20\" \ncategories: [\"30DayChartChallenge\", \"Data Visualization\", \"R Programming\", \"2025\"]\ntags: [\n\"ggplot2\", \"timeseries\", \"urbanization\", \"World Bank\", \"WDI\", \"area chart\", \"demographic change\", \"urban development\", \"global trends\", \"comparative analysis\"\n  ]\nimage: \"thumbnails/30dcc_2025_20.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                                  \n  cache: true                                                   \n  error: false\n  message: false\n  warning: false\n  eval: true\nfilters:\n  - social-share\nshare:\n  permalink: \"https://stevenponce.netlify.app/data_visualizations/TidyTuesday/2025/30dcc_2025_20.html\"\n  description: \"Day 20 of #30DayChartChallenge: Visualizing how urbanization rates have shifted across countries from 1960-2023, showing the dramatic differences in when and how quickly nations urbanized.\"\n  twitter: true\n  linkedin: true\n  email: true\n  facebook: false\n  reddit: false\n  stumble: false\n  tumblr: false\n  mastodon: true\n  bsky: true\n---\n\n\n\n![A faceted area chart titled 'The Shifting Speeds of Urbanization (1960-2023)' showing annual percentage point changes in urban population for eight countries. Countries are arranged by their maximum rate of urbanization, with Japan showing the highest spike (over 1.5%) around 2000, followed by China with sustained high rates, and Brazil with early high rates that gradually decreased. Nigeria, India, Egypt, the United States, and Germany show more moderate urbanization rates. Negative urbanization periods appear in orange for countries like China, Egypt, and Germany.](30dcc_2025_20.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\npacman::p_load(\n  tidyverse,      # Easily Install and Load the 'Tidyverse'\n  ggtext,         # Improved Text Rendering Support for 'ggplot2'\n  showtext,       # Using Fonts More Easily in R Graphs\n  janitor,        # Simple Tools for Examining and Cleaning Dirty Data\n  skimr,          # Compact and Flexible Summaries of Data\n  scales,         # Scale Functions for Visualization\n  lubridate,      # Make Dealing with Dates a Little Easier\n  WDI,            # World Development Indicators and Other World Bank Data\n  camcorder       # Record Your Plot History\n  )\n})\n\n### |- figure size ----\ngg_record(\n    dir    = here::here(\"temp_plots\"),\n    device = \"png\",\n    width  = 8,\n    height = 8,\n    units  = \"in\",\n    dpi    = 320\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n:::\n\n\n\n#### 2. Read in the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Search for urbanization indicators\nurbanization_indicators <- WDIsearch(\"urban population\")\n# head(urbanization_indicators)\n\n# Select countries of interest\ncountries <- c(\"USA\", \"CHN\", \"IND\", \"BRA\", \"NGA\", \"DEU\", \"JPN\", \"EGY\")\n\n# Get the data\nurban_data <- WDI(\n  indicator = \"SP.URB.TOTL.IN.ZS\",    # Urban population (% of total population)\n  country = countries,\n  start = 1960,\n  end = 2024,  \n  extra = TRUE  \n)\n```\n:::\n\n\n\n#### 3. Examine the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(urban_data)\nskim(urban_data)\n```\n:::\n\n\n\n#### 4. Tidy Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |- Tidy ----\n# Clean and prepare the initial dataset\nurban_data_clean <- urban_data |>\n  select(country, year, SP.URB.TOTL.IN.ZS, region) |>\n  rename(urban_population_pct = SP.URB.TOTL.IN.ZS) |>\n  filter(!is.na(urban_population_pct))\n\n# Calculate annual change rates\nurban_change <- urban_data_clean |>\n  arrange(country, year) |>\n  group_by(country) |>\n  mutate(change_rate = c(NA, diff(urban_population_pct))) |>\n  filter(!is.na(change_rate)) |> \n  ungroup()\n\n# Calculate maximum change for each country (for ordering)\ncountry_max_change <- urban_change |>\n  group_by(country) |>\n  summarize(max_change = max(change_rate, na.rm = TRUE)) |>\n  arrange(desc(max_change)) |> \n  ungroup()\n\n# Apply the ordering to each country\nurban_change <- urban_change |>\n  mutate(country = factor(country, levels = country_max_change$country))\n\n# Create separate dataframes for positive and negative changes\nurban_change_pos <- urban_change |>\n  mutate(y_value = pmax(0, change_rate))\n\nurban_change_neg <- urban_change |>\n  mutate(y_value = pmin(0, change_rate))\n```\n:::\n\n\n\n#### 5. Visualization Parameters\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot aesthetics ----\ncolors <- get_theme_colors(\n  palette = c(\n    \"pos_color\" = \"#1B9E77\",\n    \"neg_color\" = \"#D95F02\"  \n  )\n)\n\n### |-  titles and caption ----\n# text\ntitle_text    <- str_wrap(\"The Shifting Speeds of Urbanization (1960-2023)\",\n                          width = 55) \n\nsubtitle_text <- str_wrap(\"Annual growth rates show when countries urbanized fastest and when they slowed down\",\n                          width = 85)\n\ncaption_text <- create_dcc_caption(\n  dcc_year = 2025,\n  dcc_day = 20,\n  source_text =  \"{ WDI } World Bank data in R\" \n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n  base_theme,\n  theme(\n\n    # Axis elements\n    axis.title.y = element_text(color = colors$text, size = rel(0.8), margin = margin(r = 10)),\n    axis.text = element_text(color = colors$text, size = rel(0.7)),\n\n    # Grid elements\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n    panel.grid.major.y = element_line(color = \"gray92\"),\n\n    # Legend elements\n    legend.position = \"plot\",\n    legend.title = element_blank(),\n    legend.text = element_text(family = fonts$text, size = rel(0.7)),\n    \n    # Facet elements\n    strip.background = element_rect(fill = \"gray90\", color = NA),\n    strip.text = element_text(face = \"bold\", size = rel(1), margin = margin(10, 0, 10, 0)),\n    \n    # Plot margins \n    plot.margin = margin(t = 10, r = 20, b = 10, l = 20),\n  )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n:::\n\n\n\n#### 6. Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  Plot ----\np <- ggplot() +\n  # Geoms\n  geom_area(\n    data = urban_change_pos, \n    aes(x = year, y = y_value), \n    fill = colors$palette[1], alpha = 0.7\n  ) +\n  geom_area(\n    data = urban_change_neg, \n    aes(x = year, y = y_value), \n    fill = colors$palette[2], alpha = 0.7 \n  ) +\n  geom_line(\n    data = urban_change, \n    aes(x = year, y = change_rate), \n    color = \"black\", \n    linewidth = 0.5\n  ) +\n  geom_hline(\n    yintercept = 0, \n    linetype = \"dashed\", \n    color = \"black\", \n    linewidth = 0.5\n  ) +\n  # Scales\n  scale_x_continuous(\n    breaks = seq(1960, 2020, by = 20)\n  ) +\n  # Labs\n  labs(\n    title = title_text,\n    subtitle = subtitle_text,\n    caption = caption_text,\n    x = \"Year\",\n    y = \"Change in Urban Population (%)\"\n  ) +\n  # Facet \n  facet_wrap(~ country, ncol = 3)  +\n  # Theme\n  theme(\n    plot.title = element_text(\n      size = rel(1.8),\n      family = fonts$title,\n      face = \"bold\",\n      color = colors$title,\n      margin = margin(t = 5, b = 5)\n    ),\n    plot.subtitle = element_text(\n      size = rel(0.85),\n      family = fonts$subtitle,\n      color = colors$subtitle,\n      lineheight = 1.2,\n      margin = margin(t = 5, b = 15)\n    ),\n    plot.caption = element_markdown(\n      size = rel(0.6),\n      family = fonts$caption,\n      color = colors$caption,\n      lineheight = 0.65,\n      hjust = 0.5,\n      halign = 0.5,\n      margin = margin(t = 10, b = 5)\n    ),\n  )\n```\n:::\n\n\n\n#### 7. Save\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot image ----  \n\nsave_plot(\n  p, \n  type = \"30daychartchallenge\", \n  year = 2025, \n  day = 20, \n  width = 8, \n  height = 8\n  )\n```\n:::\n\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 22631)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] here_1.0.1      camcorder_0.1.0 WDI_2.7.9       scales_1.3.0   \n [5] skimr_2.1.5     janitor_2.2.0   showtext_0.9-7  showtextdb_3.0 \n [9] sysfonts_0.8.9  ggtext_0.1.2    lubridate_1.9.3 forcats_1.0.0  \n[13] stringr_1.5.1   dplyr_1.1.4     purrr_1.0.2     readr_2.1.5    \n[17] tidyr_1.3.1     tibble_3.2.1    ggplot2_3.5.1   tidyverse_2.0.0\n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.6      xfun_0.49         htmlwidgets_1.6.4 tzdb_0.4.0       \n [5] vctrs_0.6.5       tools_4.4.0       generics_0.1.3    curl_6.0.0       \n [9] gifski_1.32.0-1   fansi_1.0.6       pacman_0.5.1      pkgconfig_2.0.3  \n[13] lifecycle_1.0.4   farver_2.1.2      compiler_4.4.0    textshaping_0.4.0\n[17] munsell_0.5.1     repr_1.1.7        codetools_0.2-20  snakecase_0.11.1 \n[21] htmltools_0.5.8.1 yaml_2.3.10       pillar_1.9.0      magick_2.8.5     \n[25] commonmark_1.9.2  tidyselect_1.2.1  digest_0.6.37     stringi_1.8.4    \n[29] labeling_0.4.3    rsvg_2.6.1        rprojroot_2.0.4   fastmap_1.2.0    \n[33] grid_4.4.0        colorspace_2.1-1  cli_3.6.3         magrittr_2.0.3   \n[37] base64enc_0.1-3   utf8_1.2.4        withr_3.0.2       timechange_0.3.0 \n[41] rmarkdown_2.29    ragg_1.3.3        hms_1.1.3         evaluate_1.0.1   \n[45] knitr_1.49        markdown_1.13     rlang_1.1.4       gridtext_0.1.5   \n[49] Rcpp_1.0.13-1     glue_1.8.0        xml2_1.3.6        renv_1.0.3       \n[53] svglite_2.1.3     rstudioapi_0.17.1 jsonlite_1.8.9    R6_2.5.1         \n[57] systemfonts_1.1.0\n```\n\n\n:::\n:::\n\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`30dcc_2025_20.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/TidyTuesday/2025/30dcc_2025_20.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n\n#### 10. References\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1. Data Sources:\n   - World Bank { World Bank data in R } [indicator =  Urban population (% of total population) (\"SP.URB.TOTL.IN.ZS\")](https://github.com/vincentarelbundock/WDI)\n  \n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}