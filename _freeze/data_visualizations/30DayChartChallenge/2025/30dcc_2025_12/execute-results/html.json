{
  "hash": "5a2bf06397b758cabd89084fa3d6a29b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Traffic Volume Distribution Analysis Across California Counties\"\nsubtitle: \"Empirical Cumulative Distribution Function (ECDF) of Annual Average Daily Traffic\"\ndescription: \"Analyzing traffic volume distributions across California counties using Empirical Cumulative Distribution Functions (ECDF). This visualization reveals striking differences between urban and rural counties, providing insights into traffic patterns throughout the state highway network.\"\nauthor: \"Steven Ponce\"\ndate: \"2025-04-12\" \ncategories: [\"30DayChartChallenge\", \"Data Visualization\", \"R Programming\", \"2025\"]\ntags: [\n\"ECDF\", \"ggplot2\", \"tidyverse\", \"distribution\", \"traffic analysis\",\n\"California\", \"log scale\", \"cumulative distribution\", \"highway data\", \"data.gov\"\n  ]\nimage: \"thumbnails/30dcc_2025_12.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                                  \n  cache: true                                                   \n  error: false\n  message: false\n  warning: false\n  eval: true\nfilters:\n  - social-share\nshare:\n  permalink: \"https://stevenponce.netlify.app/data_visualizations/TidyTuesday/2025/30dcc_2025_12.html\"\n  description: \"Day 12 of #30DayChartChallenge: Visualizing traffic volume distributions across California counties using ECDF plots, revealing the stark contrast between urban and rural highway traffic patterns.\"\n  twitter: true\n  linkedin: true\n  email: true\n  facebook: false\n  reddit: false\n  stumble: false\n  tumblr: false\n  mastodon: true\n  bsky: true\n---\n\n\n\n![A line graph showing Empirical Cumulative Distribution Functions (ECDF) of Annual Average Daily Traffic across ten California counties. The x-axis shows traffic volume from 100 to over 100,000 vehicles on a logarithmic scale. Horizontal dashed lines mark the 25th, 50th, and 75th percentiles. Urban counties like Los Angeles (LA) and Orange (ORA) show curves shifted right, indicating higher traffic volumes. In contrast, rural counties like Tulare (TUL) show curves shifted left, indicating lower traffic volumes.](30dcc_2025_12.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\npacman::p_load(\n  tidyverse,      # Easily Install and Load the 'Tidyverse'\n  ggtext,         # Improved Text Rendering Support for 'ggplot2'\n  showtext,       # Using Fonts More Easily in R Graphs\n  janitor,        # Simple Tools for Examining and Cleaning Dirty Data\n  skimr,          # Compact and Flexible Summaries of Data\n  scales,         # Scale Functions for Visualization\n  paletteer,      # Comprehensive Collection of Color Palettes\n  lubridate,      # Make Dealing with Dates a Little Easier\n  camcorder       # Record Your Plot History\n  )\n})\n\n### |- figure size ----\ngg_record(\n    dir    = here::here(\"temp_plots\"),\n    device = \"png\",\n    width  = 8,\n    height = 8,\n    units  = \"in\",\n    dpi    = 320\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n:::\n\n\n\n#### 2. Read in the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntraffic_volumnes_raw <- read_csv(here::here(\n  'data/30DayChartChallenge/2025/Traffic_Volumes_AADT.csv')\n  ) |>\n    clean_names()\n```\n:::\n\n\n\n#### 3. Examine the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(traffic_volumnes_raw)\nskim(traffic_volumnes_raw)\n```\n:::\n\n\n\n#### 4. Tidy Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |- Tidy ----\ntraffic_volumes_tidy <- traffic_volumnes_raw |>        \n  select(objectid, district, route, county, location_description, \n         back_aadt, ahead_aadt) |>\n  pivot_longer(\n    cols = c(back_aadt, ahead_aadt),\n    names_to = \"direction\",\n    values_to = \"aadt\"\n  ) |>\n  mutate(\n    direction = case_when(\n      direction == \"back_aadt\" ~ \"Back\",\n      direction == \"ahead_aadt\" ~ \"Ahead\",\n      TRUE ~ direction\n    )\n  ) |>\n  filter(!is.na(aadt))\n\n# County-level summaries\ncounty_traffic <- traffic_volumes_tidy |>\n  group_by(county) |>\n  summarize(\n    count = n(),\n    median_aadt = median(aadt, na.rm = TRUE)\n  ) |>\n  arrange(desc(count)) |>\n  slice_head(n = 10)  # Top 10 counties \n\n# ECDF for top counties\ntop_counties <- county_traffic$county\n\n# Data plot\necdf_data <- traffic_volumes_tidy |>\n  filter(county %in% top_counties)\n```\n:::\n\n\n\n#### 5. Visualization Parameters\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |- plot aesthetics ---- \ncolors <- get_theme_colors(\n  palette = paletteer::paletteer_d(\n    \"ggprism::prism_dark2\"\n    )\n  )\n\n### |-  titles and caption ----\n# text\ntitle_text    <- str_wrap(\"Traffic Volume Distribution Analysis Across California Counties\",\n                          width = 50) \nsubtitle_text <- str_wrap(\"Empirical Cumulative Distribution Function (ECDF) of Annual Average Daily Traffic\", \n                          width = 90)\n\n# Create caption\ncaption_text <- create_dcc_caption(\n  dcc_year = 2025,\n  dcc_day = 12,\n  source_text =  \"California AADT via data.gov\" \n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n  base_theme,\n  theme(\n    # Text styling \n    plot.title = element_text(face = \"bold\", family = fonts$title, size = rel(1.14), margin = margin(b = 10)),\n    plot.subtitle = element_text(family = fonts$subtitle, color = colors$text, size = rel(0.78), margin = margin(b = 20)),\n    \n    # Axis elements\n    axis.title = element_text(color = colors$text, size = rel(0.8)),\n    axis.text = element_text(color = colors$text, size = rel(0.7)),\n    axis.text.y = element_text(color = colors$text, size = rel(0.68)),\n    \n    axis.line.x = element_line(color = \"gray50\", linewidth = .2),\n\n    # Grid elements\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n \n    # Legend elements\n    legend.position = \"right\",\n    legend.title = element_text(family = fonts$text, size = rel(0.8)),\n    legend.text = element_text(family = fonts$text, size = rel(0.7)),\n\n    # Plot margins \n    plot.margin = margin(t = 10, r = 20, b = 10, l = 20),\n  )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n:::\n\n\n\n#### 6. Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  Plot ----\np <- ecdf_data |>\n  ggplot(aes(x = aadt, color = county)) +\n  # Geoms\n  stat_ecdf(geom = \"step\", linewidth = 1) +\n  geom_hline(\n    yintercept = c(0.25, 0.5, 0.75), linetype = \"dashed\", \n    color = \"gray50\", alpha = 0.7\n    ) +\n  # Annotate\n  annotate(\n    \"text\", x = min(traffic_volumes_tidy$aadt, na.rm = TRUE), \n    y = c(0.26, 0.51, 0.76), \n    label = c(\"25th\", \"50th\", \"75th\"), \n    hjust = 0, size = 3, color = \"gray30\"\n    ) +\n  # Scales\n  scale_x_log10(labels = scales::comma) +\n  scale_color_manual(values = colors$palette) +\n  # Labs\n  labs(\n    title = title_text,\n    subtitle = subtitle_text,\n    caption = caption_text,\n    x = \"Annual Average Daily Traffic (log scale)\",\n    y = \"Cumulative Probability\",\n    color = \"County\",\n  ) +\n  # Theme\n  theme(\n    plot.title = element_text(\n      size = rel(1.9),\n      family = fonts$title,\n      face = \"bold\",\n      color = colors$title,\n      margin = margin(t = 5, b = 5)\n    ),\n    plot.subtitle = element_text(\n      size = rel(.85),\n      family = fonts$subtitle,\n      color = colors$subtitle,\n      lineheight = 1.2,\n      margin = margin(t = 5, b = 10)\n    ),\n    plot.caption = element_markdown(\n      size = rel(0.6),\n      family = fonts$caption,\n      color = colors$caption,\n      lineheight = 0.65,\n      hjust = 0.5,\n      halign = 0.5,\n      margin = margin(t = 5, b = 15)\n    ),\n  )\n```\n:::\n\n\n\n#### 7. Save\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot image ----  \n\nsave_plot(\n  p, \n  type = \"30daychartchallenge\", \n  year = 2025, \n  day = 12, \n  width = 8, \n  height = 8\n  )\n```\n:::\n\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 22631)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] here_1.0.1      camcorder_0.1.0 paletteer_1.6.0 scales_1.3.0   \n [5] skimr_2.1.5     janitor_2.2.0   showtext_0.9-7  showtextdb_3.0 \n [9] sysfonts_0.8.9  ggtext_0.1.2    lubridate_1.9.3 forcats_1.0.0  \n[13] stringr_1.5.1   dplyr_1.1.4     purrr_1.0.2     readr_2.1.5    \n[17] tidyr_1.3.1     tibble_3.2.1    ggplot2_3.5.1   tidyverse_2.0.0\n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.6      xfun_0.49         htmlwidgets_1.6.4 tzdb_0.4.0       \n [5] vctrs_0.6.5       tools_4.4.0       generics_0.1.3    curl_6.0.0       \n [9] parallel_4.4.0    gifski_1.32.0-1   fansi_1.0.6       pacman_0.5.1     \n[13] pkgconfig_2.0.3   lifecycle_1.0.4   farver_2.1.2      compiler_4.4.0   \n[17] textshaping_0.4.0 munsell_0.5.1     repr_1.1.7        codetools_0.2-20 \n[21] snakecase_0.11.1  htmltools_0.5.8.1 yaml_2.3.10       crayon_1.5.3     \n[25] pillar_1.9.0      magick_2.8.5      commonmark_1.9.2  tidyselect_1.2.1 \n[29] digest_0.6.37     stringi_1.8.4     rematch2_2.1.2    labeling_0.4.3   \n[33] rsvg_2.6.1        rprojroot_2.0.4   fastmap_1.2.0     grid_4.4.0       \n[37] colorspace_2.1-1  cli_3.6.3         magrittr_2.0.3    base64enc_0.1-3  \n[41] utf8_1.2.4        withr_3.0.2       bit64_4.5.2       timechange_0.3.0 \n[45] rmarkdown_2.29    bit_4.5.0         ragg_1.3.3        hms_1.1.3        \n[49] evaluate_1.0.1    knitr_1.49        markdown_1.13     rlang_1.1.4      \n[53] gridtext_0.1.5    Rcpp_1.0.13-1     glue_1.8.0        xml2_1.3.6       \n[57] renv_1.0.3        vroom_1.6.5       svglite_2.1.3     rstudioapi_0.17.1\n[61] jsonlite_1.8.9    R6_2.5.1          prismatic_1.1.2   systemfonts_1.1.0\n```\n\n\n:::\n:::\n\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`30dcc_2025_12.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/TidyTuesday/2025/30dcc_2025_12.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n\n#### 10. References\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1. Data Sources:\n   - California Annual Average Daily Traffic Volumes, Metadata Updated: November 27, 2024 [data.gov](https://catalog.data.gov/dataset/traffic-volumes-aadt-ee8d6)\n  \n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}