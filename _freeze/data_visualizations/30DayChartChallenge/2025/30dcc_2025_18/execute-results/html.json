{
  "hash": "6d877a58017b874bffaf8ddf1caa6efe",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Relationship Between Peak Hour and Daily Traffic\"\nsubtitle: \"Major corridors in Los Angeles and Orange counties show higher traffic volumes than Bay Area routes\"\ndescription: \"Analysis of California traffic data showing the strong linear relationship between peak hour traffic volume and annual average daily traffic across different counties. This visualization, created for Day 18 of the #30DayChartChallenge with an El País-inspired design, reveals how traffic patterns vary between major urban areas.\"\ndate: \"2025-04-18\" \ncategories: [\"30DayChartChallenge\", \"Data Visualization\", \"R Programming\", \"2025\"]\ntags: [\n\"ggplot2\", \"transportation\", \"urban planning\", \"El Pais\", \"traffic analysis\", \"California\", \"scatter plot\", \"relationships\", \"county comparison\", \"peak hour traffic\"\n  ]\nimage: \"thumbnails/30dcc_2025_18.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                                  \n  cache: true                                                   \n  error: false\n  message: false\n  warning: false\n  eval: true\nfilters:\n  - social-share\nshare:\n  permalink: \"https://stevenponce.netlify.app/data_visualizations/TidyTuesday/2025/30dcc_2025_18.html\"\n  description: \"Day 18 of #30DayChartChallenge: Exploring the relationship between peak hour and daily traffic volumes across California counties in El País style\"\n  twitter: true\n  linkedin: true\n  email: true\n  facebook: false\n  reddit: false\n  stumble: false\n  tumblr: false\n  mastodon: true\n  bsky: true\n---\n\n\n\n![Scatter plot showing the relationship between peak hour traffic volume (x-axis) and annual average daily traffic (y-axis) across California counties. Los Angeles (dark blue) and Orange County (medium blue) data points generally show higher traffic volumes than other Bay Area counties (light blue). A trend line indicates daily traffic is approximately 10.5 times peak hour volume, with points clustering closely along this line.](30dcc_2025_18.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\npacman::p_load(\n  tidyverse,      # Easily Install and Load the 'Tidyverse'\n  ggtext,         # Improved Text Rendering Support for 'ggplot2'\n  showtext,       # Using Fonts More Easily in R Graphs\n  janitor,        # Simple Tools for Examining and Cleaning Dirty Data\n  skimr,          # Compact and Flexible Summaries of Data\n  scales,         # Scale Functions for Visualization\n  lubridate,      # Make Dealing with Dates a Little Easier\n  camcorder       # Record Your Plot History\n  )\n})\n\n### |- figure size ----\ngg_record(\n    dir    = here::here(\"temp_plots\"),\n    device = \"png\",\n    width  = 8,\n    height = 8,\n    units  = \"in\",\n    dpi    = 320\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n:::\n\n\n\n#### 2. Read in the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntraffic_volumnes_raw <- read_csv(here::here(\n  'data/30DayChartChallenge/2025/Traffic_Volumes_AADT.csv')\n  ) |>\n    clean_names()\n```\n:::\n\n\n\n#### 3. Examine the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(traffic_volumnes_raw)\nskim(traffic_volumnes_raw)\n```\n:::\n\n\n\n#### 4. Tidy Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |- Tidy ----\nsimple_traffic <- traffic_volumnes_raw |>                   \n  select(county, route, back_peak_hour, back_aadt) |>\n  filter(!is.na(back_peak_hour) & !is.na(back_aadt)) |>\n  # Major counties with substantial data\n  filter(county %in% c(\"LA\", \"SD\", \"ORA\", \"SF\", \"SCL\", \"ALA\", \"CC\")) |>\n  # Routes with higher traffic\n  filter(back_aadt > 50000) |>\n  # Remove extreme outliers (values beyond 3x the standard deviation)\n  filter(\n    back_peak_hour < mean(back_peak_hour) + 3*sd(back_peak_hour),\n    back_aadt < mean(back_aadt) + 3*sd(back_aadt)\n  ) |>\n  mutate(\n    peak_ratio = back_peak_hour / (back_aadt/24),\n    county_group = case_when(\n      county == \"LA\" ~ \"Los Angeles\",\n      county == \"ORA\" ~ \"Orange\",\n      TRUE ~ \"Other Bay Area Counties\"\n    )\n  )\n```\n:::\n\n\n\n#### 5. Visualization Parameters\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot aesthetics ----\ncolors <- get_theme_colors(\n  palette = c(\n    \"Los Angeles\" = \"#1D3557\",  \n    \"Orange\" = \"#457B9D\",      \n    \"Other Bay Area Counties\" = \"#A8DADC\" ,\n    NULL = \"#A8DADC40\"\n  )\n)\n\n### |-  titles and caption ----\n# text\ntitle_text    <- str_glue(\"Relationship Between Peak Hour and Daily Traffic\")\n\nsubtitle_text <- str_glue(\"Major corridors in Los Angeles and Orange counties show higher traffic volumes than Bay Area routes\")\n\ncaption_text <- create_dcc_caption(\n  dcc_year = 2025,\n  dcc_day = 18,\n  source_text =  \"California Department of Transportation via data.gov\" \n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n\n# El País theme (at least my interpretation)\nel_pais_theme <- function() {\n  theme_minimal(base_size = 14) +\n    theme(\n      # Typography\n      text = element_text(family = \"Helvetica\", color = \"#333333\"),\n      plot.title = element_text(size = rel(1), face = \"bold\", hjust = 0, margin = margin(b = 10)),\n      plot.subtitle = element_text(size = rel(0.79), color = \"#666666\", hjust = 0, margin = margin(b = 20)),\n      \n      # Axis styling\n      axis.title = element_text(size = rel(0.71), color = \"#666666\"),\n      axis.text = element_text(size = rel(0.64), color = \"#333333\"),\n      axis.line = element_line(color = \"black\", linewidth = 0.5),\n      \n      # Grid styling\n      panel.grid.major = element_line(color = \"#f0f0f0\", linewidth = 0.5),\n      panel.grid.minor = element_blank(),\n      \n      # Legend styling\n      legend.title = element_text(size = rel(0.71)),\n      legend.text = element_text(size = rel(0.64)),\n      legend.position = c(0.01, 1),\n      legend.justification = c(0, 1),\n      legend.background = element_rect(fill = \"white\", color = NA),\n      legend.key.size = unit(1.2, \"lines\"),\n      legend.margin = margin(t = 0, r = 10, b = 5, l = 0),\n      \n      # Margins & Others\n      plot.margin = margin(t = 20, r = 20, b = 15, l = 20),\n      plot.background = element_rect(fill = 'white', color = 'white'),\n      panel.background = element_rect(fill = 'white', color = 'white')\n    )\n}\n```\n:::\n\n\n\n#### 6. Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  Plot ----\np <- ggplot(simple_traffic, aes(x = back_peak_hour, y = back_aadt)) +\n  # Geoms\n  geom_point(\n    aes(color = county_group),\n    alpha = 0.8,\n    size = 2.5\n  ) +\n  geom_smooth(\n    method = \"lm\",\n    formula = y ~ x,\n    color = colors$palette[1],  \n    fill = colors$palette[5],  \n    size = 1,\n    fullrange = FALSE  # Only draw the trend line within the range of actual data\n  ) +\n  # Annotate\n  annotate(\n    \"text\",\n    x = max(simple_traffic$back_peak_hour) * 0.3,\n    y = max(simple_traffic$back_aadt) * 0.9,\n    label = \"Daily Traffic ≈ 10.5 × Peak Hour Volume\",\n    color = colors$palette[1], \n    fontface = \"italic\",\n    size = 3.5\n  ) +\n  # Scales\n  scale_color_manual(\n    values = colors$palette,\n    name = \"County\"\n  ) +\n  scale_y_continuous(\n    labels = function(x) paste0(x/1000, \"K\"),\n    name = \"Annual Average Daily Traffic (vehicles)\",\n    limits = c(0, max(simple_traffic$back_aadt) * 1.05)\n  ) +\n  scale_x_continuous(\n    labels = function(x) paste0(x/1000, \"K\"),\n    name = \"Peak Hour Traffic Volume (vehicles)\",\n    limits = c(0, max(simple_traffic$back_peak_hour) * 1.05)\n  ) +\n  # Labs\n  labs(\n    title = title_text,\n    subtitle = subtitle_text,\n    caption = caption_text\n  ) +\n  # Theme\n  el_pais_theme() +\n  theme(\n    plot.caption = element_markdown(\n      size = rel(0.65),\n      family = fonts$caption,\n      color = colors$caption,\n      hjust = 0.5,\n      margin = margin(t = 10)\n    )\n  )\n```\n:::\n\n\n\n#### 7. Save\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot image ----  \n\nsave_plot(\n  p, \n  type = \"30daychartchallenge\", \n  year = 2025, \n  day = 18, \n  width = 8, \n  height = 8\n  )\n```\n:::\n\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 22631)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] here_1.0.1      camcorder_0.1.0 scales_1.3.0    skimr_2.1.5    \n [5] janitor_2.2.0   showtext_0.9-7  showtextdb_3.0  sysfonts_0.8.9 \n [9] ggtext_0.1.2    lubridate_1.9.3 forcats_1.0.0   stringr_1.5.1  \n[13] dplyr_1.1.4     purrr_1.0.2     readr_2.1.5     tidyr_1.3.1    \n[17] tibble_3.2.1    ggplot2_3.5.1   tidyverse_2.0.0\n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.6      xfun_0.49         htmlwidgets_1.6.4 lattice_0.22-6   \n [5] tzdb_0.4.0        vctrs_0.6.5       tools_4.4.0       generics_0.1.3   \n [9] curl_6.0.0        parallel_4.4.0    gifski_1.32.0-1   fansi_1.0.6      \n[13] pacman_0.5.1      pkgconfig_2.0.3   Matrix_1.7-0      lifecycle_1.0.4  \n[17] farver_2.1.2      compiler_4.4.0    textshaping_0.4.0 munsell_0.5.1    \n[21] repr_1.1.7        codetools_0.2-20  snakecase_0.11.1  htmltools_0.5.8.1\n[25] yaml_2.3.10       crayon_1.5.3      pillar_1.9.0      magick_2.8.5     \n[29] nlme_3.1-164      commonmark_1.9.2  tidyselect_1.2.1  digest_0.6.37    \n[33] stringi_1.8.4     labeling_0.4.3    splines_4.4.0     rsvg_2.6.1       \n[37] rprojroot_2.0.4   fastmap_1.2.0     grid_4.4.0        colorspace_2.1-1 \n[41] cli_3.6.3         magrittr_2.0.3    base64enc_0.1-3   utf8_1.2.4       \n[45] withr_3.0.2       bit64_4.5.2       timechange_0.3.0  rmarkdown_2.29   \n[49] bit_4.5.0         ragg_1.3.3        hms_1.1.3         evaluate_1.0.1   \n[53] knitr_1.49        markdown_1.13     mgcv_1.9-1        rlang_1.1.4      \n[57] gridtext_0.1.5    Rcpp_1.0.13-1     glue_1.8.0        xml2_1.3.6       \n[61] renv_1.0.3        svglite_2.1.3     rstudioapi_0.17.1 vroom_1.6.5      \n[65] jsonlite_1.8.9    R6_2.5.1          systemfonts_1.1.0\n```\n\n\n:::\n:::\n\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`30dcc_2025_18.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/TidyTuesday/2025/30dcc_2025_18.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n\n#### 10. References\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1. Data Sources:\n   - California Annual Average Daily Traffic Volumes, Metadata Updated: November 27, 2024 [data.gov](https://catalog.data.gov/dataset/traffic-volumes-aadt-ee8d6)\n  \n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}