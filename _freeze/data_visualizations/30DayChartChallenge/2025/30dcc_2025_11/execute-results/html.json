{
  "hash": "2f32e181079784918055e225074dacd2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"NBA Teams: Distribution of Assist-to-Turnover Ratios\"\nsubtitle: \"2024 NBA Season | Teams sorted by median ratio | Circle size represents number of players\"\ndescription: \"Visualizing NBA players' ball-handling efficiency through assist-to-turnover ratios. This dotplot combines distribution patterns with a striped design to show how players across different teams balance assists against turnovers, with teams ranked by median performance.\"\nauthor: \"Steven Ponce\"\ndate: \"2025-04-11\" \ncategories: [\"30DayChartChallenge\", \"Data Visualization\", \"R Programming\", \"2025\"]\ntags: [\n\"#30DayChartChallenge2025\", \"Day11\", \"Distribution\", \"Stripes\", \"NBA\", \"Basketball\", \"Sports Analytics\", \"hoopR\", \"ggplot2\", \"Player Performance\", \"Ball Handling\", \"Dotplot\"\n  ]\nimage: \"thumbnails/30dcc_2025_11.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                                  \n  cache: true                                                   \n  error: false\n  message: false\n  warning: false\n  eval: true\nfilters:\n  - social-share\nshare:\n  permalink: \"https://stevenponce.netlify.app/data_visualizations/TidyTuesday/2025/30dcc_2025_11.html\"\n  description: \"Day 11 of #30DayChartChallenge: Distribution & Stripes. Exploring NBA players' assist-to-turnover ratios across teams with a dotplot visualization showing which teams have the most efficient ball handlers.\"\n  twitter: true\n  linkedin: true\n  email: true\n  facebook: false\n  reddit: false\n  stumble: false\n  tumblr: false\n  mastodon: true\n  bsky: true\n---\n\n\n\n![A dotplot showing the distribution of assist-to-turnover ratios for NBA teams in the 2024 season. Teams are sorted vertically by median ratio, with Jazz at the top and Celtics at the bottom. Purple circles represent players, with larger circles indicating more players with that specific ratio value. Most players cluster between ratios of 1.0-2.5. Alternating gray background stripes highlight each team row. A vertical dashed line marks the league median.](30dcc_2025_11.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\npacman::p_load(\n  tidyverse,      # Easily Install and Load the 'Tidyverse'\n  ggtext,         # Improved Text Rendering Support for 'ggplot2'\n  showtext,       # Using Fonts More Easily in R Graphs\n  janitor,        # Simple Tools for Examining and Cleaning Dirty Data\n  skimr,          # Compact and Flexible Summaries of Data\n  scales,         # Scale Functions for Visualization\n  lubridate,      # Make Dealing with Dates a Little Easier\n  hoopR,          # Access Men's Basketball Play by Play Data \n  camcorder       # Record Your Plot History\n  )\n})\n\n### |- figure size ----\ngg_record(\n    dir    = here::here(\"temp_plots\"),\n    device = \"png\",\n    width  = 10,\n    height = 8,\n    units  = \"in\",\n    dpi    = 320\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n:::\n\n\n\n#### 2. Read in the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get player stats for 2024 NBA season\nnba_players <- load_nba_player_box(seasons = 2024)\n```\n:::\n\n\n\n#### 3. Examine the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(nba_players)\nskim(nba_players)\n```\n:::\n\n\n\n#### 4. Tidy Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |- Tidy ----\n# Aggregate to get season stats per player\nplayer_season_stats <- nba_players |>\n  filter(!did_not_play) |>\n  group_by(athlete_id, athlete_display_name, team_id, team_name) |>\n  summarize(\n    games_played = n(),\n    total_minutes = sum(minutes, na.rm = TRUE),\n    avg_minutes = total_minutes / games_played,\n    total_assists = sum(assists, na.rm = TRUE),\n    total_turnovers = sum(turnovers, na.rm = TRUE),\n    .groups = \"drop\"\n  )\n\n# Filter out players with minimal playing time\nfiltered_players <- player_season_stats |>             \n  filter(games_played >= 20, avg_minutes >= 10)\n\n# Calculate Assist-to-Turnover Ratio (capped at 5)\nfiltered_players <- filtered_players |>\n  mutate(AST_TO_Ratio = total_assists / pmax(total_turnovers, 1)) |>\n  mutate(AST_TO_Ratio = pmin(AST_TO_Ratio, 5))\n\n# Get team names to use for grouping\nfiltered_players$Team <- filtered_players$team_name\n\n# Create team summary stats\nteam_stats <- filtered_players |>\n  group_by(Team) |>\n  summarize(\n    median_ratio = median(AST_TO_Ratio, na.rm = TRUE),\n    mean_ratio = mean(AST_TO_Ratio, na.rm = TRUE),\n    min_ratio = min(AST_TO_Ratio, na.rm = TRUE),\n    max_ratio = max(AST_TO_Ratio, na.rm = TRUE),\n    q25 = quantile(AST_TO_Ratio, 0.25),\n    q75 = quantile(AST_TO_Ratio, 0.75),\n    players = n(),\n    .groups = \"drop\"\n  ) |>\n  arrange(desc(median_ratio))\n\n# Order teams by median ratio\nteam_order <- team_stats$Team\nfiltered_players$Team <- factor(filtered_players$Team, levels = team_order)\n\n# Create background stripes df\nbackground_stripes <- data.frame(\n  Team = team_order[seq(1, length(team_order), by = 2)],\n  xmin = rep(-Inf, length(team_order[seq(1, length(team_order), by = 2)])),\n  xmax = rep(Inf, length(team_order[seq(1, length(team_order), by = 2)])),\n  ymin = seq(1, length(team_order), by = 2) - 0.5,\n  ymax = seq(1, length(team_order), by = 2) + 0.5\n)\n\n# Prepare data for dot plot\ndotplot_data <- filtered_players |>\n  mutate(ratio_rounded = round(AST_TO_Ratio * 2) / 2) |>\n  group_by(Team, ratio_rounded) |>\n  summarize(count = n(), .groups = \"drop\")\n\ndotplot_data$Team <- factor(dotplot_data$Team, levels = team_order)\n\n# Create median indicators df\nmedian_indicators <- team_stats |>\n  select(Team, median_ratio) |>\n  mutate(Team = factor(Team, levels = team_order))\n```\n:::\n\n\n\n#### 5. Visualization Parameters\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |- plot aesthetics ---- \ncolors <- get_theme_colors(\n  palette = c(\"#6A0DAD\")  \n  )\n\n### |-  titles and caption ----\n# text\ntitle_text    <- str_wrap(\"NBA Teams: Distribution of Assist-to-Turnover Ratios\",\n                          width = 60) \nsubtitle_text <- str_wrap(\"2024 NBA Season | Teams sorted by median ratio | Circle size represents number of players\", \n                          width = 100)\n\n# Create caption\ncaption_text <- create_dcc_caption(\n  dcc_year = 2025,\n  dcc_day = 11,\n  source_text =  \"ESPN via { hoopR } package\" \n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n  base_theme,\n  theme(\n    # Text styling \n    plot.title = element_text(face = \"bold\", family = fonts$title, size = rel(1.14), margin = margin(b = 10)),\n    plot.subtitle = element_text(family = fonts$subtitle, color = colors$text, size = rel(0.78), margin = margin(b = 20)),\n    \n    # Axis elements\n    axis.title = element_text(color = colors$text, size = rel(0.8)),\n    axis.text = element_text(color = colors$text, size = rel(0.7)),\n    axis.text.y = element_text(color = colors$text, size = rel(0.68)),\n    \n    axis.line.x = element_line(color = \"gray50\", linewidth = .2),\n\n    # Grid elements\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n \n    # Legend elements\n    legend.position = \"bottom\",\n    legend.title = element_text(family = fonts$text, size = rel(0.8)),\n    legend.text = element_text(family = fonts$text, size = rel(0.7)),\n\n    # Plot margins \n    plot.margin = margin(t = 10, r = 20, b = 10, l = 20),\n  )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n:::\n\n\n\n#### 6. Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  Plot ----\np <- ggplot() +\n  # Geoms\n  geom_rect(\n    data = background_stripes,                                                  # Stripes\n    aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),\n    fill = \"gray80\", alpha = 0.4\n    ) +\n  geom_vline(\n    xintercept = seq(0, 5, by = 0.5), \n    color = \"gray90\", linewidth = 0.3\n    ) +\n  geom_vline(xintercept = median(team_stats$median_ratio), \n             linetype = \"dashed\", color = \"gray50\", linewidth = 0.5) +\n  geom_point(\n    data = dotplot_data,\n    aes(x = ratio_rounded, y = as.numeric(Team), \n    size = count),\n    color = colors$palette,\n    alpha = 0.6\n    ) +\n  # Annotations\n  annotate(\n    \"richtext\", x = 4.6, y = 3, label = \"Top-ranked<br>teams have<br>more players<br>with higher<br>assist-to-<br>turnover ratios\", \n    hjust = 0, vjust = 0.5, size = 3, fill = NA, label.color = NA\n    ) +\n  annotate(\n    \"richtext\", x = 0, y = 1, \n    label = \"Most teams have <span style='color:#2D708EFF;'>clusters</span> of<br>players with ratios between 1.0-2.5\",\n    hjust = 0, vjust = 0.5, size = 3, fill = NA, label.color = NA\n    ) +\n  annotate(\n    \"richtext\", x = 4.2, y = length(team_order) - 3.5,\n    label = \"Larger circles indicate<br>more players with that<br>specific ratio value\",\n    hjust = 0, vjust = 0, size = 3, fill = NA, label.color = NA\n    ) +\n  annotate(\n    \"text\", x = median(team_stats$median_ratio) + 0.05, y = length(team_order) + 1.1,\n    label = \"League median\", hjust = 0, size = 3, lineheight = 0.9\n    ) +\n  # Scales\n  scale_x_continuous(\n    breaks = seq(0, 5, 0.5),\n    limits = c(0, 5.2),\n    expand = expansion(add = c(0.1, 0))\n  ) +\n  scale_y_continuous(\n    breaks = 1:length(team_order), \n    labels = team_order,\n    expand = expansion(add = c(0.8, 0.8))\n    ) +\n  scale_size_continuous(\n    range = c(1, 9), \n    breaks = c(1, 3, 5, 7),\n    name = \"Number of Players\"\n    ) +\n  # Labs\n  labs(title = title_text,\n       subtitle = subtitle_text,\n       caption = caption_text,\n       x = \"Assist-to-Turnover Ratio (rounded to nearest 0.5)\",\n       y = NULL\n    ) +\n  # Theme\n  theme(\n    plot.title = element_text(\n      size = rel(2),\n      family = fonts$title,\n      face = \"bold\",\n      color = colors$title,\n      margin = margin(t = 5, b = 5)\n    ),\n    plot.subtitle = element_text(\n      size = rel(1),\n      family = fonts$subtitle,\n      color = colors$subtitle,\n      lineheight = 1.2,\n      margin = margin(t = 5, b = 10)\n    ),\n    plot.caption = element_markdown(\n      size = rel(0.6),\n      family = fonts$caption,\n      color = colors$caption,\n      lineheight = 0.65,\n      hjust = 0.5,\n      halign = 0.5,\n      margin = margin(t = 5, b = 5)\n    ),\n  )\n```\n:::\n\n\n\n#### 7. Save\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot image ----  \n\nsave_plot(\n  p, \n  type = \"30daychartchallenge\", \n  year = 2025, \n  day = 11, \n  width = 10, \n  height = 8\n  )\n```\n:::\n\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 22631)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] here_1.0.1      camcorder_0.1.0 hoopR_2.1.0     scales_1.3.0   \n [5] skimr_2.1.5     janitor_2.2.0   showtext_0.9-7  showtextdb_3.0 \n [9] sysfonts_0.8.9  ggtext_0.1.2    lubridate_1.9.3 forcats_1.0.0  \n[13] stringr_1.5.1   dplyr_1.1.4     purrr_1.0.2     readr_2.1.5    \n[17] tidyr_1.3.1     tibble_3.2.1    ggplot2_3.5.1   tidyverse_2.0.0\n\nloaded via a namespace (and not attached):\n [1] tidyselect_1.2.1    farver_2.1.2        fastmap_1.2.0      \n [4] pacman_0.5.1        promises_1.3.0      digest_0.6.37      \n [7] timechange_0.3.0    lifecycle_1.0.4     rsvg_2.6.1         \n[10] processx_3.8.4      magrittr_2.0.3      compiler_4.4.0     \n[13] rlang_1.1.4         tools_4.4.0         utf8_1.2.4         \n[16] yaml_2.3.10         data.table_1.16.2   knitr_1.49         \n[19] htmlwidgets_1.6.4   curl_6.0.0          xml2_1.3.6         \n[22] repr_1.1.7          websocket_1.4.2     withr_3.0.2        \n[25] grid_4.4.0          fansi_1.0.6         colorspace_2.1-1   \n[28] future_1.34.0       progressr_0.15.1    globals_0.16.3     \n[31] cli_3.6.3           rmarkdown_2.29      ragg_1.3.3         \n[34] generics_0.1.3      RcppParallel_5.1.10 rstudioapi_0.17.1  \n[37] httr_1.4.7          tzdb_0.4.0          commonmark_1.9.2   \n[40] chromote_0.4.0      rvest_1.0.4         parallel_4.4.0     \n[43] base64enc_0.1-3     vctrs_0.6.5         jsonlite_1.8.9     \n[46] hms_1.1.3           listenv_0.9.1       systemfonts_1.1.0  \n[49] magick_2.8.5        glue_1.8.0          parallelly_1.43.0  \n[52] gifski_1.32.0-1     codetools_0.2-20    ps_1.8.1           \n[55] stringi_1.8.4       gtable_0.3.6        later_1.3.2        \n[58] munsell_0.5.1       furrr_0.3.1         pillar_1.9.0       \n[61] htmltools_0.5.8.1   R6_2.5.1            textshaping_0.4.0  \n[64] rprojroot_2.0.4     evaluate_1.0.1      markdown_1.13      \n[67] gridtext_0.1.5      snakecase_0.11.1    renv_1.0.3         \n[70] Rcpp_1.0.13-1       svglite_2.1.3       xfun_0.49          \n[73] pkgconfig_2.0.3    \n```\n\n\n:::\n:::\n\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`30dcc_2025_11.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/TidyTuesday/2025/30dcc_2025_11.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n\n#### 10. References\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1. Data Sources:\n   - ESPN via { hoopR } package: [hoopR](https://github.com/sportsdataverse/hoopR)\n  \n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}