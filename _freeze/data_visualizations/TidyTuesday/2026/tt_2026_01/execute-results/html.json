{
  "hash": "b820cea98592fa4be9b1ebdbe6627ec8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"The Prescription Takeover\"\nsubtitle: \"U.S. Google searches show a dramatic shift: combined interest in GLP-1 drugs (Ozempic, Wegovy, Mounjaro) has overtaken fad diets (keto, Paleo) since late 2023.\" \ndescription: \"placeholder\"\ndate: \"2026-01-08\"\nauthor:\n  - name: \"Steven Ponce\"\n    url: \"https://stevenponce.netlify.app\"\ncitation:\n  url: \"https://stevenponce.netlify.app/data_visualizations/TidyTuesday/2026/tt_2026_01.html\" \ncategories: [\"TidyTuesday\", \"Data Visualization\", \"R Programming\", \"2026\"]\ntags: [\n  \"Lplaceholder\",\n  ]\nimage: \"thumbnails/tt_2026_01.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                    \n  cache: true                                       \n  error: false\n  message: false\n  warning: false\n  eval: true\n---\n\n![Line chart showing U.S. Google search trends from 2016 to 2025 for diet-related terms. Combined searches for GLP-1 drugs (Ozempic, Wegovy, Mounjaro) rose from near zero in 2020 to surpass fad diets (keto, Paleo) in late 2023. Fad diets peaked around 2019 at 120 combined search interest and declined to about 25 by 2025. The generic term 'diet' remained relatively stable around 50-75 throughout. A shaded 'Prescription Era' highlights the post-2023 period where pharmaceutical solutions dominate over behavioral diets.](tt_2026_01.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: load\n#| warning: false\n#| message: false\n#| results: \"hide\"\n\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\n    tidyverse,     # Easily Install and Load the 'Tidyverse'\n    ggtext,        # Improved Text Rendering Support for 'ggplot2'\n    showtext,      # Using Fonts More Easily in R Graphs\n    ggrepel,       # Non-overlapping Text Labels\n    janitor,       # Simple Tools for Examining and Cleaning Dirty Data\n    scales,        # Scale Functions for Visualization\n    glue           # Interpreted String Literals\n)\n})\n\n### |- figure size ----\ncamcorder::gg_record(\n  dir    = here::here(\"temp_plots\"),\n  device = \"png\",\n  width  = 8,\n  height = 6,\n  units  = \"in\",\n  dpi    = 320\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n````\n:::\n\n\n#### 2. Read in the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: read\n#| include: true\n#| eval: true\n#| warning: false\n\n# pak::pkg_install('gtrendsR')\n# library(gtrendsR)\n# library(tidyverse)\n\n# Pull first batch\n# terms_diet <- c(\"diet\", \"keto\", \"intermittent fasting\", \"calorie counting\", \"Ozempic\")\n# trends_diet <- gtrends(\n#     keyword = terms_diet,\n#     geo = \"US\",\n#     time = \"2016-01-01 2025-01-07\"\n# )\n\n# Pull second batch\n# terms_expanded <- c(\"Wegovy\", \"Mounjaro\", \"Paleo\")\n# trends_expanded <- gtrends(\n#     keyword = terms_expanded,\n#     geo = \"US\",\n#     time = \"2016-01-01 2025-01-07\"\n# )\n\n# Combine and clean\n# diet_combined <- bind_rows(\n#     trends_diet$interest_over_time,\n#     trends_expanded$interest_over_time\n# ) |>\n#     mutate(\n#         hits = case_when(\n#             hits == \"<1\" ~ \"0.5\",\n#             TRUE ~ hits\n#         ),\n#         hits = as.numeric(hits)\n#     )\n\n# Save combined data\n# write_csv(diet_combined, \"2026/Week_01/diet_trends_combined.csv\")\n\nraw_data <- read_csv(\n  here::here(\"data/TidyTuesday/2026/diet_trends_combined.csv\")) |> \n    clean_names()\n```\n````\n:::\n\n\n#### 3. Examine the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: examine\n#| include: true\n#| eval: true\n#| results: 'hide'\n#| warning: false\n\nglimpse(raw_data)\n```\n````\n:::\n\n\n#### 4. Tidy Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: tidy-fixed\n#| warning: false\n\n### |-  clean individual terms ----\ndiet_clean <- raw_data |>\n    mutate(\n        hits = case_when(\n            hits == \"<1\" ~ 0.5,\n            TRUE ~ as.numeric(hits)\n        ),\n        date = as.Date(date),\n        year = year(date),\n        month = month(date)\n    ) |>\n    select(date, year, month, keyword, hits)\n\n### |-  create grouped categories ----\ndiet_grouped <- diet_clean |>\n    mutate(\n        category = case_when(\n            keyword %in% c(\"keto\", \"Paleo\") ~ \"Fad Diets\",\n            keyword %in% c(\"Ozempic\", \"Wegovy\", \"Mounjaro\") ~ \"GLP-1 Drugs\",\n            keyword == \"diet\" ~ \"diet\",\n            TRUE ~ \"Other\"\n        )\n    ) |>\n    # Exclude minor terms\n    filter(category != \"Other\") |>\n    group_by(date, year, month, category) |>\n    summarise(\n        hits = sum(hits, na.rm = TRUE),\n        .groups = \"drop\"\n    )\n\n### |-  find the crossover point ----\ncrossover_data <- diet_grouped |>\n    filter(category %in% c(\"Fad Diets\", \"GLP-1 Drugs\")) |>\n    pivot_wider(names_from = category, values_from = hits) |>\n    filter(`GLP-1 Drugs` > `Fad Diets`) |>\n    slice_min(date, n = 1)\n\ncrossover_date <- crossover_data$date\ncrossover_date\n\n# Get the intersection y-value for annotation\ncrossover_y <- crossover_data$`GLP-1 Drugs`\n\n# Create label data for end of lines \nlabel_data <- diet_grouped |>\n    filter(date == max(date)) |>\n    mutate(\n        label = case_when(\n            category == \"GLP-1 Drugs\" ~ \"GLP-1 Drugs\\n(Ozempic, Wegovy, Mounjaro)\",\n            category == \"Fad Diets\" ~ \"Fad Diets\\n(keto, Paleo)\",\n            TRUE ~ category\n        )\n    )\n\n# Define prescription era start\nprescription_era_start <- as.Date(\"2023-10-01\")\n```\n````\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"2022-10-01\"\n```\n\n\n:::\n:::\n\n\n#### 5. Visualization Parameters\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: params\n#| include: true\n#| warning: false\n\n### |-  plot aesthetics ----\ncolors <- get_theme_colors(\n  palette = list(\n      \"diet\" = \"gray50\",\n      \"Fad Diets\" = \"#3498db\",\n      \"GLP-1 Drugs\" = \"#e74c3c\"\n  )\n)\n\n### |- titles and caption ----\ntitle_text <- str_glue(\"The Prescription Takeover\")\n\nsubtitle_text <- str_glue(\n    \"U.S. Google searches show a dramatic shift: combined interest in <span style='color:#e74c3c;'>**GLP-1 drugs**</span><br>\",\n    \"(Ozempic, Wegovy, Mounjaro) has overtaken <span style='color:#3498db;'>**fad diets**</span> (keto, Paleo) since late 2023.\"\n)\n\ncaption_text <- create_social_caption(\n    tt_year = 2026,\n    tt_week = 01,\n    source_text = \"Google Trends (US), 2016-2025 via { gtrendsR }\"\n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n  base_theme,\n  theme(\n    # Text styling\n    plot.title = element_text(\n      face = \"bold\", family = fonts$title, size = rel(1.4),\n      color = colors$title, margin = margin(b = 10), hjust = 0\n    ),\n    plot.subtitle = element_markdown(\n      face = \"italic\", family = fonts$subtitle, lineheight = 1.2,\n      color = colors$subtitle, size = rel(0.9), margin = margin(b = 20), hjust = 0\n    ),\n\n    # Grid\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n    panel.grid.major = element_line(color = \"gray90\", linewidth = 0.25),\n\n    # Axes\n    axis.title = element_text(size = rel(0.8), color = \"gray30\"),\n    axis.text = element_text(color = \"gray30\"),\n    axis.text.y = element_text(size = rel(0.85)),\n    axis.ticks = element_blank(),\n\n    # Facets\n    strip.background = element_rect(fill = \"gray95\", color = NA),\n    strip.text = element_text(\n      face = \"bold\",\n      color = \"gray20\",\n      size = rel(0.9),\n      margin = margin(t = 6, b = 4)\n    ),\n    panel.spacing = unit(1.5, \"lines\"),\n\n    # Legend elements\n    legend.position = \"plot\",\n    legend.title = element_text(\n      family = fonts$subtitle,\n      color = colors$text, size = rel(0.8), face = \"bold\"\n    ),\n    legend.text = element_text(\n      family = fonts$tsubtitle,\n      color = colors$text, size = rel(0.7)\n    ),\n    legend.margin = margin(t = 15),\n\n    # Plot margin\n    plot.margin = margin(20, 20, 20, 20),\n    \n  )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n````\n:::\n\n\n#### 6. Plot\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: plot\n#| warning: false\n\n### |- Plot ----\np <- diet_grouped |>\n    ggplot(aes(x = date, y = hits, color = category)) +\n    \n    # Geoms\n    geom_line(linewidth = 0.4, alpha = 0.25) +\n    geom_smooth(\n        method = \"loess\",\n        span = 0.2,\n        se = FALSE,\n        linewidth = 1.8\n    ) +\n    geom_text_repel(\n        data = label_data |> \n            filter(category == \"GLP-1 Drugs\"),\n        aes(label = label),\n        hjust = 0,\n        direction = \"y\",\n        nudge_x = 50,\n        nudge_y = 5,\n        segment.color = NA,\n        family = fonts$text,\n        fontface = \"bold\",\n        size = 3,\n        lineheight = 0.85,\n        box.padding = 0.5\n    ) +\n    geom_text_repel(\n        data = label_data |> \n            filter(category != \"GLP-1 Drugs\"),\n        aes(label = label),\n        hjust = 0,\n        direction = \"y\",\n        nudge_x = 50,\n        # nudge_y = 5,\n        segment.color = NA,\n        family = fonts$text,\n        fontface = \"bold\",\n        size = 3,\n        lineheight = 0.85,\n        box.padding = 0.5\n    ) +\n    \n    # Annotate\n    annotate(\n        \"rect\",\n        xmin = prescription_era_start,\n        xmax = max(diet_grouped$date) + 60,\n        ymin = -Inf,\n        ymax = Inf,\n        fill = \"#e74c3c\",\n        alpha = 0.05\n    ) +\n    annotate(\n        \"text\",\n        x = prescription_era_start + 200,\n        y = 130,\n        label = \"Prescription Era\",\n        family = fonts$text,\n        size = 3,\n        color = \"gray30\",\n        fontface = \"bold.italic\"\n    ) +\n    annotate(\n        \"point\",\n        x = crossover_date,\n        y = crossover_y,\n        size = 3,\n        color = \"gray20\"\n    ) +\n    annotate(\n        \"text\",\n        x = crossover_date - 90,\n        y = crossover_y + 15,\n        label = \"GLP-1 surpasses\\nfad diets\",\n        family = fonts$text,\n        size = 2.8,\n        color = \"gray30\",\n        hjust = 1,\n        lineheight = 0.9\n    ) +\n    annotate(\n        \"curve\",\n        x = crossover_date - 80,\n        y = crossover_y + 10,\n        xend = crossover_date - 10,\n        yend = crossover_y + 2,\n        curvature = 0.2,\n        arrow = arrow(length = unit(0.15, \"cm\"), type = \"closed\"),\n        color = \"gray40\",\n        linewidth = 0.4\n    ) +\n    \n    # Scales\n    scale_color_manual(\n        values = c(\n            \"diet\" = \"gray50\",\n            \"Fad Diets\" = \"#3498db\",\n            \"GLP-1 Drugs\" = \"#e74c3c\"\n        )\n    ) +\n    scale_x_date(\n        date_breaks = \"2 years\",\n        date_labels = \"%Y\",\n        expand = expansion(mult = c(0.02, 0.18))\n    ) +\n    scale_y_continuous(\n        breaks = seq(0, 100, 25),\n        limits = c(0, 130),\n        expand = expansion(mult = c(0, 0.02))\n    ) +\n    coord_cartesian(clip = \"off\") +\n    \n    # Labs\n    labs(\n        title = title_text,\n        subtitle = subtitle_text,\n        caption = caption_text,\n        y = \"Combined Search Interest\"\n    ) +\n    \n    # Theme\n    theme(\n    plot.title = element_markdown(\n        size = rel(2.3),\n        family = fonts$title,\n        face = \"bold\",\n        color = colors$title,\n        lineheight = 1.15,\n        margin = margin(t = 8, b = 5)\n    ),\n    plot.subtitle = element_markdown(\n        size = rel(0.9),\n        family = fonts$subtitle,\n        color = alpha(colors$subtitle, 0.88),\n        lineheight = 1.5,\n        margin = margin(t = 5, b = 20)\n    ),\n    plot.caption = element_markdown(\n        size = rel(0.65),\n        family = fonts$subtitle,\n        color = colors$caption,\n        hjust = 0,\n        lineheight = 1.4,\n        margin = margin(t = 20, b = 5)\n    )\n)\n```\n````\n:::\n\n\n#### 7. Save\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: save\n#| warning: false\n\n### |-  plot image ----  \nsave_plot(\n  plot = p, \n  type = \"tidytuesday\", \n  year = 2026, \n  week = 01, \n  width  = 8,\n  height = 6,\n  )\n```\n````\n:::\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 26100)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/La_Paz\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] here_1.0.1      glue_1.8.0      scales_1.3.0    janitor_2.2.0  \n [5] ggrepel_0.9.6   showtext_0.9-7  showtextdb_3.0  sysfonts_0.8.9 \n [9] ggtext_0.1.2    lubridate_1.9.3 forcats_1.0.0   stringr_1.5.1  \n[13] dplyr_1.1.4     purrr_1.0.2     readr_2.1.5     tidyr_1.3.1    \n[17] tibble_3.2.1    ggplot2_3.5.1   tidyverse_2.0.0 pacman_0.5.1   \n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.6      xfun_0.49         htmlwidgets_1.6.4 lattice_0.22-6   \n [5] tzdb_0.5.0        vctrs_0.6.5       tools_4.4.0       generics_0.1.3   \n [9] curl_6.0.0        parallel_4.4.0    gifski_1.32.0-1   fansi_1.0.6      \n[13] pkgconfig_2.0.3   Matrix_1.7-0      lifecycle_1.0.4   farver_2.1.2     \n[17] compiler_4.4.0    textshaping_0.4.0 munsell_0.5.1     codetools_0.2-20 \n[21] snakecase_0.11.1  htmltools_0.5.8.1 yaml_2.3.10       crayon_1.5.3     \n[25] pillar_1.9.0      camcorder_0.1.0   magick_2.8.5      nlme_3.1-164     \n[29] commonmark_1.9.2  tidyselect_1.2.1  digest_0.6.37     stringi_1.8.4    \n[33] splines_4.4.0     rsvg_2.6.1        rprojroot_2.0.4   fastmap_1.2.0    \n[37] grid_4.4.0        colorspace_2.1-1  cli_3.6.4         magrittr_2.0.3   \n[41] utf8_1.2.4        withr_3.0.2       bit64_4.5.2       timechange_0.3.0 \n[45] rmarkdown_2.29    bit_4.5.0         ragg_1.3.3        hms_1.1.3        \n[49] evaluate_1.0.1    knitr_1.49        markdown_1.13     mgcv_1.9-1       \n[53] rlang_1.1.6       gridtext_0.1.5    Rcpp_1.0.13-1     xml2_1.3.6       \n[57] renv_1.0.3        svglite_2.1.3     rstudioapi_0.17.1 vroom_1.6.5      \n[61] jsonlite_1.8.9    R6_2.5.1          systemfonts_1.1.0\n```\n\n\n:::\n:::\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`tt_2026_01.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/TidyTuesday/2025/tt_2026_01.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n#### 10. References\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1.  **Data Source:**\n    -   TidyTuesday 2026 Week 01: [Bring your own data](https://github.com/rfordatascience/tidytuesday/blob/main/data/2026/2026-01-06/readme.md)\n    -   [Google Trends](https://trends.google.com/) - Search interest data for U.S., 2016-2025\n    -   Search terms: \"diet\", \"keto\", \"Paleo\", \"Ozempic\", \"Wegovy\", \"Mounjaro\"\n\n2.  **R Package:**\n    -   Massicotte, P. and Eddelbuettel, D. (2024). gtrendsR: Perform and Display Google Trends Queries. R package. [CRAN](https://cran.r-project.org/package=gtrendsR) | [GitHub](https://github.com/PMassicotte/gtrendsR)\n\n:::\n\n#### 11. Custom Functions Documentation\n\n::: {.callout-note collapse=\"true\"}\n##### ðŸ“¦ Custom Helper Functions\n\nThis analysis uses custom functions from my personal module library for efficiency and consistency across projects.\n\n**Functions Used:**\n\n-   **`fonts.R`**: `setup_fonts()`, `get_font_families()` - Font management with showtext\n-   **`social_icons.R`**: `create_social_caption()` - Generates formatted social media captions\n-   **`image_utils.R`**: `save_plot()` - Consistent plot saving with naming conventions\n-   **`base_theme.R`**: `create_base_theme()`, `extend_weekly_theme()`, `get_theme_colors()` - Custom ggplot2 themes\n\n**Why custom functions?**\\\nThese utilities standardize theming, fonts, and output across all my data visualizations. The core analysis (data tidying and visualization logic) uses only standard tidyverse packages.\n\n**Source Code:**\\\nView all custom functions â†’ [GitHub: R/utils](https://github.com/poncest/personal-website/tree/master/R)\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}