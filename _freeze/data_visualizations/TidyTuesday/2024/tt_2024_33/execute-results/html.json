{
  "hash": "4cdf9ab45302bca20b46e419f928b527",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Visitor Distribution by Start Month at World's Fairs\"\nsubtitle: \"Density of visitor counts across fairs held from 1851 to 2021\"\nauthor: \"Steven Ponce\"\ndate: \"2024-08-13\"\ncategories:\n  - \"#TidyTuesday\"\nimage: \"thumbnails/tt_2024_33.png\"\nformat:\n  html:\n    code-fold: true\neditor_options: \n  chunk_output_type: console\nexecute: \n  error: false\n  message: false\n  warning: false\n  eval: false\n\n# filters:\n#   - social-share\n \nshare:\n  permalink: \"https://stevenponce.netlify.app/data_visualizations.html\"\n  linkedin: true\n  twitter: true\n  email: true\n---\n\n\n![This is a ridge chart showing the distribution of visitors to World's Fairs, organized by the month they started from January to December between 1851 and 2021. Each ridge represents a different month, with varying peaks indicating the number of visitors in millions. The chart uses shades of purple for higher visitor months and warmer colors for lower ones.](tt_2024_33.png){#fig-1}\n\n### <mark> __Steps to Create this Graphic__ </mark>\n\n#### 1. Load Packages & Setup \n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(\n  tidyverse,     # Easily Install and Load the 'Tidyverse'\n  ggtext,        # Improved Text Rendering Support for 'ggplot2'\n  showtext,      # Using Fonts More Easily in R Graphs\n  janitor,       # Simple Tools for Examining and Cleaning Dirty Data\n  skimr,         # Compact and Flexible Summaries of Data\n  scales,        # Scale Functions for Visualization\n  lubridate,     # Make Dealing with Dates a Little Easier\n  MetBrewer,     # Color Palettes Inspired by Works at the Metropolitan Museum of Art\n  ggridges       # Ridgeline Plots in 'ggplot2' # Ridgeline Plots in 'ggplot2'\n )  \n\n### |- figure size ----\ncamcorder::gg_record(\n  dir    = here::here(\"temp_plots\"),\n  device = \"png\",\n  width  =  8,\n  height =  6,\n  units  = \"in\",\n  dpi    = 320\n)\n\n### |- resolution ----\nshowtext_opts(dpi = 320, regular.wt = 300, bold.wt = 800)\n```\n:::\n\n\n#### 2. Read in the Data \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntt <-tidytuesdayR::tt_load(2024, week = 33) \n\nworlds_fairs <- tt$worlds_fairs |> clean_names() |> glimpse()\n\ntidytuesdayR::readme(tt)\nrm(tt)\n```\n:::\n\n\n#### 3. Examing the Data \n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(worlds_fairs)\nskim(worlds_fairs)\n```\n:::\n\n\n#### 4. Tidy Data \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Tidy\nworlds_fairs <- worlds_fairs |>\n    mutate(start_month = factor(start_month, levels = 1:12, labels = month.abb))\n\n# Create a data frame with all months\nall_months <- data.frame(start_month = factor(month.abb, levels = month.abb))\n\n# Left join with plot_data\ndata_plot <- all_months |> \n    left_join(worlds_fairs, by = \"start_month\")\n```\n:::\n\n\n\n#### 5. Visualization Parameters \n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |- plot aesthetics ----\nbkg_col      <- colorspace::lighten('#f7f5e9', 0.05)    \ntitle_col    <- \"gray20\"           \nsubtitle_col <- \"gray20\"     \ncaption_col  <- \"gray30\"   \ntext_col     <- \"gray20\"    \n\n### |-  titles and caption ----\n# icons\ntt <- str_glue(\"#TidyTuesday: { 2024 } Week { 33 } &bull; Source: List of world expositions (Wikipedia)<br>\")\nli <- str_glue(\"<span style='font-family:fa6-brands'>&#xf08c;</span>\")\ngh <- str_glue(\"<span style='font-family:fa6-brands'>&#xf09b;</span>\")\nmn <- str_glue(\"<span style='font-family:fa6-brands'>&#xf4f6;</span>\")\n\n# text\ntitle_text    <- str_glue(\"Visitor Distribution by Start Month at World\\\\'s Fairs\")\nsubtitle_text <- str_glue(\"Density of visitor counts across fairs held from 1851 to 2021\")\ncaption_text  <- str_glue(\"{tt} {li} stevenponce &bull; {mn} @sponce1(graphic.social) {gh} poncest &bull; #rstats #ggplot2\")\n\n\n### |-  fonts ----\nfont_add(\"fa6-brands\", \"fonts/6.4.2/Font Awesome 6 Brands-Regular-400.otf\")\nfont_add_google(\"Oswald\", regular.wt = 400, family = \"title\")\nfont_add_google(\"Merriweather Sans\", regular.wt = 400, family = \"subtitle\")\nfont_add_google(\"Merriweather Sans\", regular.wt = 400, family = \"text\")\nfont_add_google(\"Noto Sans\", regular.wt = 400, family = \"caption\")\nshowtext_auto(enable = TRUE)\n\n\n### |-  plot theme ----\ntheme_set(theme_minimal(base_size = 12, base_family = \"text\"))                \n\ntheme_update(\n    plot.title.position   = \"plot\",\n    plot.caption.position = \"plot\",\n    legend.position       = \"top\",\n    \n    legend.justification  = \"right\",\n    legend.title.position = \"top\",\n    legend.title.align    = 1,  \n    legend.box.just       = \"right\",\n    \n    legend.margin         = margin(5, 10, -65, 0),\n    \n    plot.background       = element_rect(fill = bkg_col, color = bkg_col),\n    panel.background      = element_rect(fill = bkg_col, color = bkg_col),\n    plot.margin           = margin(t = 20, r = 25, b = 20, l = 25),\n    axis.title.x          = element_text(margin = margin(10, 0, 0, 0), size = rel(1.2), \n                                         color = text_col, family = \"text\", face = \"bold\", hjust = 0.5),\n    axis.title.y          = element_text(margin = margin(0, 10, 0, 0), size = rel(1.2), \n                                         color = text_col, family = \"text\", face = \"bold\", vjust = 0.5),\n    axis.text             = element_text(size = rel(0.95), color = text_col, family = \"text\"),\n    axis.line.x           = element_line(color = \"gray40\", linewidth = 0.12),\n    panel.grid.minor.x    = element_blank(),\n    panel.grid.major.x    = element_blank(),\n    panel.grid.major.y    = element_line(linetype = \"dotted\", linewidth = 0.15, color = 'gray'),\n    panel.grid.minor.y    = element_blank(),\n)   \n```\n:::\n\n\n\n#### 6. Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  final plot ----  \np <- data_plot |>\n    ggplot(aes(x = visitors, y = start_month, fill = start_month)) +\n    \n    # Geom\n    geom_density_ridges_gradient(\n        scale = 3,\n        rel_min_height = 0.01,\n        gradient_lwd = 1.0,\n        aes(fill = ..x..), \n        color = \"gray10\", \n        linewidth = .25\n    ) +\n    \n    # Scales\n    scale_y_discrete() +\n    scale_x_continuous(labels = label_number(suffix = \" M\")) +\n    scale_fill_viridis_c(\n        name = \"Number of Visitors\",\n        option = \"C\",\n        direction = -1,\n        begin = 0.2,\n        end = 0.9,\n        guide = guide_colourbar(\n            title = \"Visitors (in millions)\",\n            title.position = \"top\",\n            barwidth = 12,\n            draw.ulim = 75,\n            barheight = 1,\n            frame.colour = NA)) +\n    coord_cartesian(clip = 'off') +\n    \n    # Labs\n    labs(\n        x = \"Number of Visitors\",\n        y = \"Start Month\",\n        fill = \"Number of Visitors\",\n        title    = title_text,\n        subtitle = subtitle_text,\n        caption  = caption_text,\n    ) +\n    \n    # Theme\n    theme(\n        plot.title      = element_markdown(\n            size        = rel(1.7),\n            family      = \"title\",\n            color       = title_col,\n            face        = \"bold\",\n            lineheight  = 0.85,\n            margin      = margin(t = 5, b = 5)\n        ),\n        plot.subtitle   = element_markdown(\n            size        = rel(1.1),\n            family      = \"subtitle\",\n            color       = title_col,\n            lineheight  = 1,\n            margin      = margin(t = 5, b = 15)\n        ),\n        plot.caption    = element_markdown(\n            size        = rel(.65),\n            family      = \"caption\",\n            color       = caption_col,\n            lineheight  = 0.6,\n            hjust       = 0,\n            halign      = 0,\n            margin      = margin(t = 10, b = 0)\n        )\n    )  \n```\n:::\n\n\n#### 7. Save\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot image ----  \nggsave(\n  filename = here::here(\"data_visualizations/TidyTuesday/2024/tt_2024_33.png\"),\n  plot = p,\n  width  =  8,\n  height =  6,\n  units  = \"in\",\n  dpi    = 320\n)\n\n### |-  plot thumbnail----  \nmagick::image_read(here::here(\"data_visualizations/TidyTuesday/2024/tt_2024_33.png\")) |> \n  magick::image_resize(geometry = \"400\") |> \n  magick::image_write(here::here(\"data_visualizations/TidyTuesday/2024/thumbnails/tt_2024_33.png\"))\n```\n:::\n\n\n\n#### 8. Session Info\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nloaded via a namespace (and not attached):\n [1] htmlwidgets_1.6.4 compiler_4.4.0    fastmap_1.2.0     cli_3.6.3        \n [5] htmltools_0.5.8.1 tools_4.4.0       rstudioapi_0.16.0 yaml_2.3.10      \n [9] rmarkdown_2.28    knitr_1.48        jsonlite_1.8.8    xfun_0.47        \n[13] digest_0.6.37     rlang_1.1.4       renv_1.0.3        evaluate_0.24.0  \n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}