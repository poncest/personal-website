{
  "hash": "5d4e68148e0b4696890377f40895acaf",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Judo’s Elite: Medal Achievements of the Top 10 Nations at the Summer Olympics Games, 1964 - 2016\"\nsubtitle: \"Overview of Olympic medal counts by gender across decades, highlighting judo's leading nations.\"\nauthor: \"Steven Ponce\"\ndate: \"2024-08-07\"\ncategories:\n  - \"#TidyTuesday\"\nimage: \"thumbnails/tt_2024_32.png\"\nformat:\n  html:\n    code-fold: true\neditor_options: \n  chunk_output_type: console\nexecute: \n  error: false\n  message: false\n  warning: false\n  eval: false\n\nfilters:\n  - social-share\nshare:\n  permalink: \"https://stevenponce.netlify.app/data_visualizations.html\"\n  linkedin: true\n  twitter: true\n  email: true\n---\n\n\n![This heatmap illustrates the medal achievements of the top 10 nations in Olympic judo competitions from 1962 to 2016. The x-axis represents Olympic years, while the y-axis lists countries. The heatmap is divided into two sections: one for men and another for women. The colors on the heatmap range from light teal to dark orange, representing the number of medals won, from zero to seven, respectively. ](tt_2024_32.png){#fig-1}\n\n### <mark> __Steps to Create this Graphic__ </mark>\n\n#### 1. Load Packages & Setup \n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(\n  tidyverse,     # Easily Install and Load the 'Tidyverse'\n  ggtext,        # Improved Text Rendering Support for 'ggplot2'\n  showtext,      # Using Fonts More Easily in R Graphs\n  janitor,       # Simple Tools for Examining and Cleaning Dirty Data\n  skimr,         # Compact and Flexible Summaries of Data\n  scales,        # Scale Functions for Visualization\n  lubridate,     # Make Dealing with Dates a Little Easier\n  MetBrewer      # Color Palettes Inspired by Works at the Metropolitan Museum of Art\n )  \n\n### |- figure size ----\ncamcorder::gg_record(\n  dir    = here::here(\"temp_plots\"),\n  device = \"png\",\n  width  =  8,\n  height =  10,\n  units  = \"in\",\n  dpi    = 320\n)\n\n### |- resolution ----\nshowtext_opts(dpi = 320, regular.wt = 300, bold.wt = 800)\n```\n:::\n\n\n#### 2. Read in the Data \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntt <-tidytuesdayR::tt_load(2024, week = 32) \n\nolympics <- tt$olympics |> clean_names() |> glimpse()\n\ntidytuesdayR::readme(tt)\nrm(tt)\n```\n:::\n\n\n#### 3. Examing the Data \n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(olympics)\nskim(olympics)\n```\n:::\n\n\n#### 4. Tidy Data \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Judo df\njudo <- olympics |> \n    filter(sport == \"Judo\") |> \n    mutate(\n        gender = case_when(\n            str_detect(event, \"Men's\")   ~ \"Men\",\n            str_detect(event, \"Women's\") ~ \"Women\",\n            TRUE ~ \"Unspecified\"  \n        ),\n        weight_class = str_replace_all(event, c(\"Men's \" = \"\", \"Women's \" = \"\")),\n        weight_class = str_replace_all(weight_class, c(\"Judo \" = \"\")),\n        weight_class = factor(weight_class, \n                              levels = c(\"Extra-Lightweight\", \"Half-Lightweight\", \"Lightweight\", \n                                         \"Half-Middleweight\", \"Middleweight\" , \"Half-Heavyweight\", \n                                         \"Heavyweight\", \"Open Class\"))\n        )  \n\n# Judo medals\njudo_medals <- judo |>\n    filter(medal %in% c(\"Gold\", \"Silver\", \"Bronze\")) |>\n    count(country = team, year, gender, medal)\n\n# Count medals for top countries\ntop_countries_medals <- judo_medals |>\n    group_by(country) |>\n    summarize(total_medals = sum(n)) |>\n    slice_max(total_medals, n = 10) |>\n    pull(country)\n\n# Filter for the top 10 countries and calculate medals count\nfiltered_judo_medals <- judo |>\n    filter(team %in% top_countries_medals) |>\n    group_by(country = team, year, gender) |>\n    summarise(\n        medal_count = sum(medal %in% c(\"Gold\", \"Silver\", \"Bronze\")), \n        .groups = \"drop\"\n        ) |>\n    arrange(country, year, gender)\n```\n:::\n\n\n\n#### 5. Visualization Parameters \n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |- plot aesthetics ----\nbkg_col      <- colorspace::lighten('#f7f5e9', 0.05)    \ntitle_col    <- \"#3d3d3d\"           \nsubtitle_col <- \"#3d3d3d\"     \ncaption_col  <- \"gray30\"   \ntext_col     <- colorspace::darken(\"#8e8a7b\" , 0.2)   \n\n### |-  titles and caption ----\n# icons\ntt <- str_glue(\"#TidyTuesday: { 2024 } Week { 32 } &bull; Source: Kaggle Olypmic history data <br>\")\nli <- str_glue(\"<span style='font-family:fa6-brands'>&#xf08c;</span>\")\ngh <- str_glue(\"<span style='font-family:fa6-brands'>&#xf09b;</span>\")\nmn <- str_glue(\"<span style='font-family:fa6-brands'>&#xf4f6;</span>\")\n\n# text\ntitle_text    <- str_glue(\"Judo’s Elite: Medal Achievements of the Top 10 Nations at the<br>\n                          Summer Olympics Games, 1964 - 2016\")\nsubtitle_text <- str_glue(\"Overview of Olympic medal counts by gender across decades,<br>\n                          highlighting judo's leading nations.\")\ncaption_text  <- str_glue(\"{tt} {li} stevenponce &bull; {mn} @sponce1(graphic.social) {gh} poncest &bull; #rstats #ggplot2\")\n\n\n### |-  fonts ----\nfont_add(\"fa6-brands\", \"fonts/6.4.2/Font Awesome 6 Brands-Regular-400.otf\")\nfont_add_google(\"Oswald\", regular.wt = 400, family = \"title\")\nfont_add_google(\"Merriweather Sans\", regular.wt = 400, family = \"subtitle\")\nfont_add_google(\"Merriweather Sans\", regular.wt = 400, family = \"text\")\nfont_add_google(\"Noto Sans\", regular.wt = 400, family = \"caption\")\nfont_add_google(\"Shadows Into Light\", regular.wt = 400, family = \"anotation\")\nshowtext_auto(enable = TRUE)\n\n\n### |-  plot theme ----\ntheme_set(theme_minimal(base_size = 14, base_family = \"text\"))                \n\ntheme_update(\n    plot.title.position   = \"plot\",\n    plot.caption.position = \"plot\",\n    legend.position       = 'top',\n    legend.justification  = \"right\",\n    legend.title.position = \"top\",\n    legend.title.align    = 1,  \n    legend.box.just       = \"right\",  \n    \n    plot.background       = element_rect(fill = bkg_col, color = bkg_col),\n    panel.background      = element_rect(fill = bkg_col, color = bkg_col),\n    plot.margin           = margin(t = 20, r = 25, b = 20, l = 25),\n    axis.title.x          = element_text(margin = margin(10, 0, 0, 0), size = rel(1.2), \n                                         color = text_col, family = \"text\", face = \"bold\", hjust = 0.5),\n    axis.title.y          = element_text(margin = margin(0, 10, 0, 0), size = rel(1.2), \n                                         color = text_col, family = \"text\", face = \"bold\", hjust = 0.5),\n    axis.text             = element_text(size = rel(0.8), color = text_col, family = \"text\"),\n    axis.line.x           = element_line(color = \"gray40\", linewidth = .15),\n    panel.grid.minor.x    = element_blank(),\n    panel.grid.major.x    = element_line(linetype = \"dotted\", linewidth = 0.1, color = 'gray'),\n    panel.grid.minor.y    = element_blank(),\n    panel.grid.major.y    = element_blank(),\n    \n    strip.text            = element_textbox(size     = rel(1.1),\n                                            face     = 'bold',\n                                            color    = text_col,\n                                            hjust    = 0.5,\n                                            halign   = 0.5,\n                                            r        = unit(5, \"pt\"),\n                                            width    = unit(5.5, \"npc\"),\n                                            padding  = margin(3, 0, 3, 0),\n                                            margin   = margin(3, 3, 3, 3),\n                                            fill     = \"transparent\"),\n    \n    panel.spacing       = unit(3, 'lines'),\n)  \n```\n:::\n\n\n\n#### 6. Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  initial plot ----  \np <- filtered_judo_medals |>\n    ggplot(aes(x = year, y = fct_reorder(country, medal_count, .fun = sum), fill = medal_count)) +\n    \n  # Geoms\n  geom_tile(color = \"white\", linewidth = 0.15) +\n  geom_text(data = filtered_judo_medals |> filter(gender == \"Men\"),\n            aes(label = \"Country\", x = 1962, y = \"Japan\"),\n            size = 6.5, color = text_col, family = \"text\", fontface = \"bold\", \n            hjust = 1.4, vjust = -1.5) +\n\n  # Scales\n  scale_x_continuous(breaks = seq(\n      min(filtered_judo_medals$year), \n      max(filtered_judo_medals$year), \n      by = 4), \n      labels = function(x) paste0(\"'\", substr(x, 3, 4))) +\n  scale_y_discrete() +\n  coord_cartesian(clip = \"off\") +\n  scale_fill_stepsn(\n    colors = c('#DFEDEB', \"#A1FCDF\", \"#7FD8BE\", \"#FCD29F\", \"#FCAB64\"),\n    limits = c(0, 7), \n    breaks = 0:7,\n    labels = as.character(0:7),\n    guide = guide_colorsteps(\n        direction = \"horizontal\",\n        barwidth = unit(10, \"cm\"),\n        barheight = unit(0.5, \"cm\"),\n        frame.colour = NA,\n        title.position = \"top\",\n        title.hjust = 1\n        )\n    ) +\n\n  # Labs\n  labs(\n    title    = title_text,\n    subtitle = subtitle_text,\n    caption  = caption_text,\n    x = \"Year\",\n    y = \"\",\n    fill = \"Medal Count\"\n    ) +\n\n  # Facet\n  facet_wrap(vars(gender), nrow = 2, axes = \"all\") +\n\n  # Theme\n  theme(\n      plot.title      = element_markdown(\n          size        = rel(1.5),\n          family      = \"title\",\n          color       = title_col,\n          face        = \"bold\",\n          lineheight  = 0.85,\n          margin      = margin(t = 5, b = 10)\n      ),\n      plot.subtitle   = element_markdown(\n          size        = rel(1.1),\n          family      = \"subtitle\",\n          color       = title_col,\n          lineheight  = 1,\n          margin      = margin(t = 5, b = 10)\n      ),\n      plot.caption    = element_markdown(\n          size        = rel(.6),\n          family      = \"caption\",\n          color       = caption_col,\n          lineheight  = 0.6,\n          hjust       = 0,\n          halign      = 0,\n          margin      = margin(t = 10, b = 5)\n      ),\n  )  \n    \n### |-  annotated plot ----  \n\nmen_text <- str_glue(\"Judo made its first Olympic appearance in 1964,\\nbut was not included on the program of\\nthe 1968 Olympic Games.\")\n\nwomen_text <- str_glue(\"Women's judo made its first appearance at the\\n1988 Olympic Games, as a demonstration sport.\\nWomen's Judo became an official part of the\\nOlympic games from the 1992 Barcelona games\")\n\n### |-  final plot ----  \np <- p + \n    \n    # Men's Judo History Note\n    geom_text(data = filtered_judo_medals |> filter(gender == \"Men\"),\n              aes(x = 1964, y = Inf, label = men_text),\n              hjust = .6, vjust = -1.2, \n              size = 3.5, color = text_col,  family = \"anotation\", \n              lineheight = 0.9) +\n    \n    # Curved Arrow for Men's Note\n    geom_curve(data = filtered_judo_medals |> filter(gender == \"Men\"),\n               aes(x = 1968, y = \"Japan\", xend = 1968, yend = \"South Korea\"), \n               curvature = 0, arrow = arrow(type = \"closed\", length = unit(0.08, \"inches\")),\n               linewidth = .5,  \n               color = text_col, size = 0.7) +\n    \n    # Women's Judo History Note\n    geom_text(data = filtered_judo_medals %>% filter(gender == \"Women\"),\n              aes(label = women_text, x = 1962, y = \"Japan\"),\n              hjust = 0, vjust = 1, size = 3.5, color = text_col, family = \"anotation\", \n              lineheight = 0.9) \n```\n:::\n\n\n#### 7. Save\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot image ----  \nggsave(\n  filename = here::here(\"data_visualizations/TidyTuesday/2024/tt_2024_32.png\"),\n  plot = p,\n  width  =  8,\n  height =  6,\n  units  = \"in\",\n  dpi    = 320\n)\n\n### |-  plot thumbnail----  \nmagick::image_read(here::here(\"data_visualizations/TidyTuesday/2024/tt_2024_32.png\")) |> \n  magick::image_resize(geometry = \"400\") |> \n  magick::image_write(here::here(\"data_visualizations/thumbnails/tt_2024_32.png\"))\n```\n:::\n\n\n\n#### 8. Session Info\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nloaded via a namespace (and not attached):\n [1] htmlwidgets_1.6.4 compiler_4.4.0    fastmap_1.2.0     cli_3.6.3        \n [5] htmltools_0.5.8.1 tools_4.4.0       rstudioapi_0.16.0 yaml_2.3.10      \n [9] rmarkdown_2.28    knitr_1.48        jsonlite_1.8.8    xfun_0.47        \n[13] digest_0.6.37     rlang_1.1.4       renv_1.0.3        evaluate_0.24.0  \n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}