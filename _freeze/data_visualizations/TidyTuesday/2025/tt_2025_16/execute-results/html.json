{
  "hash": "473acbee1667fa7ac57580dc9fc06edf",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"April 20th Fatal Crashes Compared to Yearly Average (1992-2016)\"\nsubtitle: \"Difference between April 20th fatalities and the yearly average for each year\"\ndescription: \"Analyzing 25 years of traffic fatality data (1992-2016) to examine the alleged connection between April 20th ('4/20') and increased fatal car crashes.\"\nauthor: \"Steven Ponce\"\ndate: \"2025-04-20\" \ncategories: [\"TidyTuesday\", \"Data Visualization\", \"R Programming\", \"2025\"]\ntags: [\n\"fatal crashes\", \"road safety\", \"4/20\", \"traffic fatalities\", \"data myths\", \"statistical analysis\", \"time series\", \"seasonal patterns\", \"vehicle accidents\", \"public health\", \"holiday effects\", \"temporal analysis\"\n]\nimage: \"thumbnails/tt_2025_16.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                                  \n  cache: true                                                   \n  error: false\n  message: false\n  warning: false\n  eval: true\nfilters:\n  - social-share\nshare:\n  permalink: \"https://stevenponce.netlify.app/data_visualizations/TidyTuesday/2025/tt_2025_16.html\"\n  description: \"My visualization of 25 years of traffic data challenges the '4/20 effect' on fatal crashes. Data shows April 20th had fewer crashes than yearly average in 16 of 25 years studied. #DataScience #TidyTuesday\"\n\n  twitter: true\n  linkedin: true\n  email: true\n  facebook: false\n  reddit: false\n  stumble: false\n  tumblr: false\n  mastodon: true\n  bsky: true\n---\n\n\n\n![Bar chart showing the difference between April 20th fatal crashes and yearly averages from 1992 to 2016. Orange bars represent years above average (9 years total), with 2007 showing the highest peak at +57. Blue bars represent years below average (16 years total), with 2004's lowest point at -60. The visualization suggests no consistent pattern of increased crashes on April 20th compared to yearly averages.](tt_2025_16.png){#fig-1}\n\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\n     tidyverse,      # Easily Install and Load the 'Tidyverse'\n    ggtext,         # Improved Text Rendering Support for 'ggplot2'\n    showtext,       # Using Fonts More Easily in R Graphs\n    janitor,        # Simple Tools for Examining and Cleaning Dirty Data\n    skimr,          # Compact and Flexible Summaries of Data\n    scales,         # Scale Functions for Visualization\n    glue,           # Interpreted String Literals\n    here,           # A Simpler Way to Find Your Files\n    camcorder       # Record Your Plot History \n    )\n})\n\n### |- figure size ----\ngg_record(\n    dir    = here::here(\"temp_plots\"),\n    device = \"png\",\n    width  =  8,\n    height =  8,\n    units  = \"in\",\n    dpi    = 320\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n:::\n\n\n\n#### 2. Read in the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntt <- tidytuesdayR::tt_load(2025, week = 16) \n\ndaily_accidents <- tt$daily_accidents |> clean_names()\n# daily_accidents_420 <- tt$daily_accidents_420 |> clean_names()\n\ntidytuesdayR::readme(tt)\nrm(tt)\n```\n:::\n\n\n\n#### 3. Examine the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(daily_accidents)\nskim(daily_accidents)\n```\n:::\n\n\n\n#### 4. Tidy Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  tidy data ----\n# Add date components to daily accidents data  \ndaily_accidents_tidy <- daily_accidents |>\n    mutate(\n        year = year(date),\n        month = month(date),\n        day = day(date),\n        is_april_20 = (month == 4 & day == 20)\n    )\n\n# Calculate yearly averages\nyearly_averages <- daily_accidents_tidy |>\n    group_by(year) |>\n    summarize(\n        yearly_avg = mean(fatalities_count),\n        .groups = \"drop\"\n    )\n\n# Extract April 20th data for each year\napril_20_yearly <- daily_accidents_tidy |>\n    filter(is_april_20) |>\n    select(year, fatalities_count) |>\n    arrange(year) |>\n    # Join with yearly averages\n    left_join(yearly_averages, by = \"year\") |>\n    # Calculate difference from yearly average\n    mutate(\n        diff_from_avg = fatalities_count - yearly_avg,\n        above_avg = diff_from_avg > 0\n    )\n\n# Find key statistics for annotations\nmax_year_data <- april_20_yearly |> \n    filter(diff_from_avg == max(diff_from_avg))\nmax_year <- max_year_data$year\nmax_diff <- max_year_data$diff_from_avg\n\nmin_year_data <- april_20_yearly |> \n    filter(diff_from_avg == min(diff_from_avg))\nmin_year <- min_year_data$year\nmin_diff <- min_year_data$diff_from_avg\n\n# Count years above and below average\nn_above <- sum(april_20_yearly$above_avg)\nn_below <- nrow(april_20_yearly) - n_above\n```\n:::\n\n\n\n#### 5. Visualization Parameters\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot aesthetics ----\ncolors <- get_theme_colors(\n    palette = c(\n        \"FALSE\" = \"#3A6CA4\", \"TRUE\" = \"#F05E23\"\n    )\n)\n\n### |-  titles and caption ----\ntitle_text <- str_glue(\"April 20th Fatal Crashes Compared to Yearly Average (1992-2016)\")\nsubtitle_text <- str_glue(\"Difference between April 20th fatalities and the yearly average for each year\")\n\n# Create caption\ncaption_text <- create_social_caption(\n    tt_year = 2025,\n    tt_week = 16,\n    source_text =  \"420 raw-data via OSF\" \n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n    base_theme,\n    theme(\n        # Text styling \n        plot.title = element_text(face = \"bold\", family = fonts$title, size = rel(1.14), margin = margin(b = 10)),\n        plot.subtitle = element_text(family = fonts$subtitle, color = colors$text, size = rel(0.78), margin = margin(b = 20)),\n        \n        # Axis elements\n        axis.title = element_text(color = colors$text, face = \"bold\", size = rel(0.8)),\n        axis.text = element_text(color = colors$text, size = rel(0.7)),\n        \n        # Grid elements\n        panel.grid.minor = element_line(color = \"gray50\", linewidth = 0.05),\n        panel.grid.major = element_line(color = \"gray50\", linewidth = 0.02),\n        \n        # Legend elements\n        legend.position = \"plot\",\n        legend.direction = \"horizontal\",\n        legend.title = element_text(family = fonts$text, size = rel(0.8), face = \"bold\"),\n        legend.text = element_text(family = fonts$text, size = rel(0.7)),\n        \n        # two-row legend\n        legend.box.spacing = unit(0.4, \"cm\"),\n        legend.key.width = unit(1.5, \"cm\"),\n        legend.spacing.x = unit(0.2, \"cm\"),\n \n        legend.box = \"horizontal\",\n        legend.box.just = \"left\",\n        \n        # Plot margins \n        plot.margin = margin(t = 20, r = 20, b = 20, l = 20),\n    )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n:::\n\n\n\n#### 6. Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  Plot  ----\np <- ggplot(april_20_yearly, aes(x = year, y = diff_from_avg, fill = above_avg)) +\n    # Geoms\n    geom_col(width = 0.7) +\n    geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray50\", linewidth = 0.5) +\n    # Annotate\n    annotate(\n        \"text\", x = max_year, y = max_diff + 7, \n        label = paste0(\"Peak: \", max_year, \" (+\", round(max_diff), \")\"),\n        color = colors$palette[2], fontface = \"bold\", size = 3.5\n        ) +\n    annotate(\n        \"text\", x = min_year, y = min_diff - 7, \n        label = paste0(\"Low: \", min_year, \" (\", round(min_diff), \")\"),\n        color = colors$palette[1], fontface = \"bold\", size = 3.5\n        ) +\n    annotate(\n        \"text\", x = max(april_20_yearly$year) - 3, y = 43, \n        label = paste0(n_above, \" years above avg\"),\n        color = colors$palette[2], size = 3.5, hjust = 1\n        ) +\n    annotate(\n        \"text\", x = max(april_20_yearly$year) - 3, y = -43, \n        label = paste0(n_below, \" years below avg\"),\n        color = colors$palette[1], size = 3.5, hjust = 1\n        ) +\n    # Scales\n    scale_fill_manual(\n        values = colors$palette,\n        labels = c(\"Below Average\", \"Above Average\")\n    ) +\n    scale_x_continuous(\n        breaks = seq(\n            min(april_20_yearly$year),\n            max(april_20_yearly$year), \n            by = 5)\n        ) +\n    # Labs\n    labs(\n        title = title_text,\n        subtitle = subtitle_text,\n        caption = caption_text,\n        x = NULL,\n        y = \"Difference from Yearly Average\",\n    ) +\n    # Theme\n    theme(\n        plot.title = element_text(\n            size = rel(1.4),\n            family = fonts$title,\n            face = \"bold\",\n            color = colors$title,\n            lineheight = 1.1,\n            margin = margin(t = 5, b = 5)\n        ),\n        plot.subtitle = element_text(\n            size = rel(0.85),\n            family = fonts$subtitle,\n            color = alpha(colors$subtitle, 0.9),\n            lineheight = 1.2,\n            margin = margin(t = 5, b = 10)\n        ),\n        plot.caption = element_markdown(\n            size = rel(0.65),\n            family = fonts$caption,\n            color = colors$caption,\n            hjust = 0.5,\n            margin = margin(t = 10)\n        )\n    )  \n```\n:::\n\n\n\n#### 7. Save\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot image ----  \nsave_plot(\n  plot = p, \n  type = \"tidytuesday\", \n  year = 2025, \n  week = 16, \n  width = 8,\n  height = 8\n)\n```\n:::\n\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 22631)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] camcorder_0.1.0 here_1.0.1      glue_1.8.0      scales_1.3.0   \n [5] skimr_2.1.5     janitor_2.2.0   showtext_0.9-7  showtextdb_3.0 \n [9] sysfonts_0.8.9  ggtext_0.1.2    lubridate_1.9.3 forcats_1.0.0  \n[13] stringr_1.5.1   dplyr_1.1.4     purrr_1.0.2     readr_2.1.5    \n[17] tidyr_1.3.1     tibble_3.2.1    ggplot2_3.5.1   tidyverse_2.0.0\n[21] pacman_0.5.1   \n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.6       httr2_1.0.6        xfun_0.49          htmlwidgets_1.6.4 \n [5] gh_1.4.1           tzdb_0.5.0         vctrs_0.6.5        tools_4.4.0       \n [9] generics_0.1.3     parallel_4.4.0     curl_6.0.0         gifski_1.32.0-1   \n[13] fansi_1.0.6        pkgconfig_2.0.3    lifecycle_1.0.4    farver_2.1.2      \n[17] compiler_4.4.0     textshaping_0.4.0  munsell_0.5.1      repr_1.1.7        \n[21] codetools_0.2-20   snakecase_0.11.1   htmltools_0.5.8.1  yaml_2.3.10       \n[25] crayon_1.5.3       pillar_1.9.0       magick_2.8.5       commonmark_1.9.2  \n[29] tidyselect_1.2.1   digest_0.6.37      stringi_1.8.4      labeling_0.4.3    \n[33] rsvg_2.6.1         rprojroot_2.0.4    fastmap_1.2.0      grid_4.4.0        \n[37] colorspace_2.1-1   cli_3.6.4          magrittr_2.0.3     base64enc_0.1-3   \n[41] utf8_1.2.4         withr_3.0.2        rappdirs_0.3.3     bit64_4.5.2       \n[45] timechange_0.3.0   rmarkdown_2.29     tidytuesdayR_1.1.2 gitcreds_0.1.2    \n[49] bit_4.5.0          ragg_1.3.3         hms_1.1.3          evaluate_1.0.1    \n[53] knitr_1.49         markdown_1.13      rlang_1.1.6        gridtext_0.1.5    \n[57] Rcpp_1.0.13-1      xml2_1.3.6         renv_1.0.3         vroom_1.6.5       \n[61] svglite_2.1.3      rstudioapi_0.17.1  jsonlite_1.8.9     R6_2.5.1          \n[65] systemfonts_1.1.0 \n```\n\n\n:::\n:::\n\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`tt_2025_16.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/TidyTuesday/2025/tt_2025_16.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n\n#### 10. References\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1. Data Sources:\n\n   - TidyTuesday 2025 Week 16: [Fatal Car Crashes on 4/20](https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/2025-04-01)\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}