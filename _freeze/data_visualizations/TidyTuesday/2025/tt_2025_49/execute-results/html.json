{
  "hash": "76e962900317bf3c515548cb9d35947c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Qatar Cars: A Modern, Global Dataset Reveals Four Market Segments\"\nsubtitle: \"Price-power positioning from 105 vehicles shows distinct clustering from<br>budget ($12k-25k) through mid-range ($25k-75k) and premium ($75k-250k) to ultra-luxury ($250k+)\" \ndescription: \"Exploring the Qatar Cars datasetâ€”a modern, internationally-focused alternative to mtcarsâ€”through price-power positioning analysis. This scatter plot visualization reveals four distinct market segments and demonstrates how the dataset captures the full automotive spectrum from budget vehicles to multi-million dollar hypercars.\"\ndate: \"2025-12-08\"\nauthor:\n  - name: \"Steven Ponce\"\n    url: \"https://stevenponce.netlify.app\"\ncitation:\n  url: \"https://stevenponce.netlify.app/data_visualizations/TidyTuesday/2025/tt_2025_49.html\" \ncategories: [\"TidyTuesday\", \"Data Visualization\", \"R Programming\", \"2025\"]\ntags: [\n  \"Qatar Cars\",\n  \"Automotive Data\",\n  \"Market Segmentation\",\n  \"Scatter Plot\",\n  \"Log Scale\",\n  \"Density Contours\",\n  \"ggplot2\",\n  \"ggrepel\",\n  \"Electric Vehicles\",\n  \"Luxury Cars\",\n  \"International Dataset\",\n  \"Price Analysis\",\n  \"Horsepower\",\n  \"Modern mtcars Alternative\"\n]\nimage: \"thumbnails/tt_2025_49.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                    \n  cache: true                                       \n  error: false\n  message: false\n  warning: false\n  eval: true\n---\n\n![A scatter plot of 105 vehicles, plotted by price (USD, log-scale x-axis) versus horsepower (y-axis). Density contours reveal four distinct market segments divided by vertical lines: Budget ($12k-25k), Mid-Range ($25k-75k), Premium ($75k-250k), and Ultra-Luxury ($250k+). Points are colored by engine type (teal for electric, orange for hybrid, dark gray for petrol). The majority of vehicles cluster in the budget and mid-range segments below 500 horsepower. Four ultra-luxury outliers are labeled in the upper right: Lotus Evija ($2.2M), Bugatti Centodieci ($9.1M), Bugatti Chiron ($3.6M), and McLaren Senna ($1.4M).](tt_2025_49.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: load\n#| warning: false\n#| message: false\n#| results: \"hide\"\n\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\n    tidyverse,     # Easily Install and Load the 'Tidyverse'\n    ggtext,        # Improved Text Rendering Support for 'ggplot2'\n    showtext,      # Using Fonts More Easily in R Graphs\n    janitor,       # Simple Tools for Examining and Cleaning Dirty Data\n    scales,        # Scale Functions for Visualization\n    glue,          # Interpreted String Literals\n    ggrepel        # Automatically Position Non-Overlapping Text Labels\n)\n})\n\n### |- figure size ----\ncamcorder::gg_record(\n  dir    = here::here(\"temp_plots\"),\n  device = \"png\",\n  width  = 10,\n  height = 10,\n  units  = \"in\",\n  dpi    = 320\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n````\n:::\n\n\n#### 2. Read in the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: read\n#| include: true\n#| eval: true\n#| warning: false\n\ntt <- tidytuesdayR::tt_load(2025, week = 49)\n\nqatarcars <- tt$qatarcars |> clean_names()\n\ntidytuesdayR::readme(tt)\nrm(tt)\n```\n````\n:::\n\n\n#### 3. Examine the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: examine\n#| include: true\n#| eval: true\n#| results: 'hide'\n#| warning: false\n\nglimpse(qatarcars)\nskimr::skim(qatarcars) |> summary()\n```\n````\n:::\n\n\n#### 4. Tidy Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: tidy-fixed\n#| warning: false\n\nqatarcars_tidy <- qatarcars |>\n  mutate(\n    price_usd = price / 3.64,\n    price_eur = price / 4.15\n  )\n\n# Identify top 4 most expensive cars\ntop4_cars <- qatarcars_tidy |>\n  arrange(desc(price_usd)) |>\n  head(4) |>\n  mutate(\n    label = paste0(make, \" \", model, \"\\n$\", label_comma(accuracy = 1)(price_usd))\n  )\n\n# Define market segments\nsegment_labels <- tibble(\n  segment = c(\"Budget Segment\", \"Mid-Range\", \"Premium\", \"Ultra-Luxury\"),\n  price_usd = c(15000, 40000, 120000, 400000),\n  horsepower = c(1950, 1950, 1950, 1950),\n  price_range = c(\"$12k-25k\", \"$25k-75k\", \"$75k-250k\", \"$250k+\")\n)\n```\n````\n:::\n\n\n#### 5. Visualization Parameters\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: params\n#| include: true\n#| warning: false\n\n### |- plot aesthetics ----\ncolors <- get_theme_colors(\n    palette = list(\n        \"Electric\" = \"#06AED5\",\n        \"Hybrid\" = \"#F77F00\", \n        \"Petrol\" = \"#2C3E50\",\n        col_gray = \"gray70\"\n    )\n)\n\n### |- titles and caption ----\ntitle_text <- str_glue(\"Qatar Cars: A Modern, Global Dataset Reveals Four Market Segments\")\nsubtitle_text <- str_glue(\n    \"Price-power positioning from 105 vehicles shows distinct clustering from<br>\",\n    \"**budget** ($12k-25k) through **mid-range** ($25k-75k) and **premium** ($75k-250k) to **ultra-luxury** ($250k+)\"\n)\n\ncaption_text <- create_social_caption(\n    tt_year  = 2025,\n    tt_week  = 49,  \n    source_text = str_glue(\n        \"Qatar Cars Dataset\",\n    )\n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n  base_theme,\n  theme(\n    # Text styling\n    plot.title = element_markdown(\n      face = \"bold\", family = fonts$title, size = rel(1.4),\n      color = colors$title, margin = margin(b = 10), hjust = 0\n    ),\n    plot.subtitle = element_markdown(\n      face = \"italic\", family = fonts$subtitle, lineheight = 1.2,\n      color = colors$subtitle, size = rel(0.9), margin = margin(b = 20), hjust = 0\n    ),\n\n    # Grid\n    panel.grid.minor = element_blank(),\n    # panel.grid.major.x = element_blank(),\n    panel.grid.major = element_line(color = \"gray90\", linewidth = 0.3),\n\n    # Axes\n    axis.title = element_text(size = rel(0.8), color = \"gray30\"),\n    axis.text = element_text(color = \"gray30\"),\n    axis.text.y = element_text(size = rel(0.85)),\n    axis.ticks = element_blank(),\n\n    # Facets\n    strip.background = element_rect(fill = \"gray95\", color = NA),\n    strip.text = element_text(\n      face = \"bold\",\n      color = \"gray20\",\n      size = rel(0.9),\n      margin = margin(t = 6, b = 4)\n    ),\n    panel.spacing = unit(1.5, \"lines\"),\n\n    # Legend elements\n    legend.position = \"plot\",\n    legend.title = element_text(\n      family = fonts$subtitle,\n      color = colors$text, size = rel(0.8), face = \"bold\"\n    ),\n    legend.text = element_text(\n      family = fonts$tsubtitle,\n      color = colors$text, size = rel(0.7)\n    ),\n    legend.margin = margin(t = 15),\n\n    # Plot margin\n    plot.margin = margin(20, 20, 20, 20)\n  )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n````\n:::\n\n\n#### 6. Plot\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: plot\n#| warning: false\n\n# labeling function for x-axis (k for thousands, M for millions)\ncustom_dollar_labels <- function(x) {\n    case_when(\n        x >= 1e6 ~ paste0(\"$\", x / 1e6, \"M\"),\n        x >= 1e3 ~ paste0(\"$\", x / 1e3, \"k\"),\n        TRUE ~ paste0(\"$\", x)\n    )\n}\n\n### |-  main plot ----\np <- qatarcars_tidy |>\n  ggplot(aes(x = price_usd, y = horsepower)) +\n  # Geoms\n  geom_density2d(color = \"gray50\", alpha = 0.5, linewidth = 0.6) +\n  geom_vline(xintercept = 25000, linetype = \"dotted\", color = \"gray20\", alpha = 0.4) +\n  geom_vline(xintercept = 75000, linetype = \"dotted\", color = \"gray20\", alpha = 0.4) +\n  geom_vline(xintercept = 250000, linetype = \"dotted\", color = \"gray20\", alpha = 0.4) +\n  geom_text(\n    data = segment_labels,\n    aes(x = price_usd, y = horsepower, label = segment),\n    size = 3,\n    fontface = \"bold\",\n    color = \"gray30\",\n    alpha = 0.9,\n    family = fonts$text\n  ) +\n  geom_text(\n    data = segment_labels,\n    aes(x = price_usd, y = 1850, label = price_range),\n    size = 2.8,\n    color = \"gray40\",\n    alpha = 0.9,\n    family = fonts$text\n  ) +\n  geom_point(aes(color = enginetype), alpha = 0.7, size = 3) +\n  geom_text_repel(\n    data = top4_cars,\n    aes(label = label),\n    size = 3,\n    fontface = \"bold\",\n    box.padding = 0.5,\n    point.padding = 0.3,\n    segment.color = \"gray40\",\n    segment.size = 0.3,\n    min.segment.length = 0,\n    family = fonts$text,\n    seed = 1234\n  ) +\n  # Scales\n  scale_x_log10(\n    labels = custom_dollar_labels,\n    breaks = c(10000, 25000, 50000, 100000, 250000, 500000, 1e6, 3e6, 10e6)\n  ) +\n  scale_y_continuous(labels = label_comma(), limits = c(0, 2050)) +\n  scale_color_manual(\n    values = colors$palette,\n    name = \"Engine Type\"\n  ) +\n  # Labs\n  labs(\n    title = title_text,\n    subtitle = subtitle_text,\n    x = \"Price (USD, log scale)\",\n    y = \"Horsepower\",\n    caption = caption_text\n  ) +\n  # Theme\n  theme(\n    plot.title = element_markdown(\n      size = rel(1.6),\n      family = fonts$title,\n      face = \"bold\",\n      color = colors$title,\n      lineheight = 1.15,\n      margin = margin(t = 8, b = 5)\n    ),\n    plot.subtitle = element_markdown(\n      size = rel(0.9),\n      family = fonts$subtitle,\n      color = alpha(colors$subtitle, 0.88),\n      lineheight = 1.4,\n      margin = margin(t = 5, b = 20)\n    ),\n    plot.caption = element_markdown(\n      size = rel(0.65),\n      family = fonts$subtitle,\n      color = colors$caption,\n      hjust = 0,\n      lineheight = 1.4,\n      margin = margin(t = 20, b = 5)\n    ),\n    panel.grid.minor.x = element_blank(),\n    panel.grid.major.x = element_blank(),\n  )\n```\n````\n:::\n\n\n#### 7. Save\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: save\n#| warning: false\n\n### |-  plot image ----  \nsave_plot(\n  plot = p, \n  type = \"tidytuesday\", \n  year = 2025, \n  week = 49, \n  width  = 10,\n  height = 10,\n  )\n```\n````\n:::\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 26100)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] here_1.0.1      ggrepel_0.9.6   glue_1.8.0      scales_1.3.0   \n [5] janitor_2.2.0   showtext_0.9-7  showtextdb_3.0  sysfonts_0.8.9 \n [9] ggtext_0.1.2    lubridate_1.9.3 forcats_1.0.0   stringr_1.5.1  \n[13] dplyr_1.1.4     purrr_1.0.2     readr_2.1.5     tidyr_1.3.1    \n[17] tibble_3.2.1    ggplot2_3.5.1   tidyverse_2.0.0 pacman_0.5.1   \n\nloaded via a namespace (and not attached):\n [1] tidyselect_1.2.1   farver_2.1.2       fastmap_1.2.0      gh_1.4.1          \n [5] digest_0.6.37      timechange_0.3.0   lifecycle_1.0.4    rsvg_2.6.1        \n [9] magrittr_2.0.3     compiler_4.4.0     rlang_1.1.6        tools_4.4.0       \n[13] utf8_1.2.4         yaml_2.3.10        knitr_1.49         skimr_2.1.5       \n[17] labeling_0.4.3     htmlwidgets_1.6.4  bit_4.5.0          curl_6.0.0        \n[21] xml2_1.3.6         camcorder_0.1.0    repr_1.1.7         tidytuesdayR_1.1.2\n[25] withr_3.0.2        grid_4.4.0         fansi_1.0.6        colorspace_2.1-1  \n[29] gitcreds_0.1.2     MASS_7.3-60.2      isoband_0.2.7      cli_3.6.4         \n[33] rmarkdown_2.29     crayon_1.5.3       ragg_1.3.3         generics_0.1.3    \n[37] rstudioapi_0.17.1  tzdb_0.5.0         commonmark_1.9.2   parallel_4.4.0    \n[41] base64enc_0.1-3    vctrs_0.6.5        jsonlite_1.8.9     hms_1.1.3         \n[45] bit64_4.5.2        systemfonts_1.1.0  magick_2.8.5       gifski_1.32.0-1   \n[49] codetools_0.2-20   stringi_1.8.4      gtable_0.3.6       munsell_0.5.1     \n[53] pillar_1.9.0       rappdirs_0.3.3     htmltools_0.5.8.1  R6_2.5.1          \n[57] httr2_1.0.6        textshaping_0.4.0  rprojroot_2.0.4    vroom_1.6.5       \n[61] evaluate_1.0.1     markdown_1.13      gridtext_0.1.5     snakecase_0.11.1  \n[65] renv_1.0.3         Rcpp_1.0.13-1      svglite_2.1.3      xfun_0.49         \n[69] pkgconfig_2.0.3   \n```\n\n\n:::\n:::\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`tt_2025_49.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/TidyTuesday/2025/tt_2025_49.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n#### 10. References\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1.  **Data Source:**\n    -   TidyTuesday 2025 Week 49: [CCars in Qatar](https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/2025-12-09/readme.md)\n:::\n\n#### 11. Custom Functions Documentation\n\n::: {.callout-note collapse=\"true\"}\n##### ðŸ“¦ Custom Helper Functions\n\nThis analysis uses custom functions from my personal module library for efficiency and consistency across projects.\n\n**Functions Used:**\n\n-   **`fonts.R`**: `setup_fonts()`, `get_font_families()` - Font management with showtext\n-   **`social_icons.R`**: `create_social_caption()` - Generates formatted social media captions\n-   **`image_utils.R`**: `save_plot()` - Consistent plot saving with naming conventions\n-   **`base_theme.R`**: `create_base_theme()`, `extend_weekly_theme()`, `get_theme_colors()` - Custom ggplot2 themes\n\n**Why custom functions?**\\\nThese utilities standardize theming, fonts, and output across all my data visualizations. The core analysis (data tidying and visualization logic) uses only standard tidyverse packages.\n\n**Source Code:**\\\nView all custom functions â†’ [GitHub: R/utils](https://github.com/poncest/personal-website/tree/master/R)\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}