{
  "hash": "ad35596b88b1530b3a1332d1e6dc684e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Global language endangerment: scale and geographic concentration\"\nsubtitle: \"Nearly half of the worldâ€™s critically endangered languages are concentrated in the Pacific region, making Papunesia the global epicenter of language loss risk.\" \ndescription: \"This visualization examines the global distribution of 8,612 documented languages from Glottolog 5.2.1, revealing critical patterns in language endangerment. A treemap shows that only 31% of languages are considered safe, while 745 are critically endangered (moribund or nearly extinct). Geographic analysis demonstrates that 303 of these critically endangered languages (41%) are concentrated in the Pacific region, particularly across Indonesia, Papua New Guinea, Philippines, and Pacific islands.\"\ndate: \"2025-12-14\"\nauthor:\n  - name: \"Steven Ponce\"\n    url: \"https://stevenponce.netlify.app\"\ncitation:\n  url: \"https://stevenponce.netlify.app/data_visualizations/TidyTuesday/2025/tt_2025_51.html\" \ncategories: [\"TidyTuesday\", \"Data Visualization\", \"R Programming\", \"2025\"]\ntags: [\n  \"Linguistic Diversity\",\n  \"Endangered Languages\",\n  \"Language Preservation\",\n  \"Papunesia\",\n  \"Pacific Region\",\n  \"Geographic Analysis\",\n  \"Treemap\",\n  \"Cartography\",\n  \"Glottolog\",\n  \"Cultural Heritage\",\n  \"ggplot2\",\n  \"treemapify\",\n  \"patchwork\",\n  \"Data Storytelling\"\n]\nimage: \"thumbnails/tt_2025_51.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                    \n  cache: true                                       \n  error: false\n  message: false\n  warning: false\n  eval: true\n---\n\n![Two-panel visualization showing global language endangerment. Left panel: treemap displaying distribution of 8,612 languages by status - 2,704 not endangered (light blue-gray), 1,835 shifting (light gray), 1,629 threatened (medium gray), 1,225 extinct (dark gray), 434 moribund (red), and 311 nearly extinct (dark red). Right panel: map of the Pacific region showing 303 critically endangered languages (41% of the global total) concentrated in Papunesia, represented as red dots clustered across Indonesia, Papua New Guinea, the Philippines, and the Pacific islands. ](tt_2025_51.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: load\n#| warning: false\n#| message: false\n#| results: \"hide\"\n\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\n    tidyverse,     # Easily Install and Load the 'Tidyverse'\n    ggtext,        # Improved Text Rendering Support for 'ggplot2'\n    showtext,      # Using Fonts More Easily in R Graphs\n    janitor,       # Simple Tools for Examining and Cleaning Dirty Data\n    skimr,         # Compact and Flexible Summaries of Data\n    scales,        # Scale Functions for Visualization\n    glue,          # Interpreted String Literals\n    treemapify,    # Create Treemap Visualizations\n    patchwork,     # The Composer of Plots\n    maps           # Draw Geographical Maps\n)\n})\n\n### |- figure size ----\ncamcorder::gg_record(\n  dir    = here::here(\"temp_plots\"),\n  device = \"png\",\n  width  = 14,\n  height = 12,\n  units  = \"in\",\n  dpi    = 320\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n````\n:::\n\n\n#### 2. Read in the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: read\n#| include: true\n#| eval: true\n#| warning: false\n\ntt <- tidytuesdayR::tt_load(2025, week = 51)\n\nendangered_status <- tt$endangered_status |> clean_names()\nfamilies <- tt$families |> clean_names()\nlanguages <- tt$languages |> clean_names()\n\n# tidytuesdayR::readme(tt)\nrm(tt)\n```\n````\n:::\n\n\n#### 3. Examine the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: examine\n#| include: true\n#| eval: true\n#| results: 'hide'\n#| warning: false\n\nglimpse(endangered_status)\nglimpse(families)\nglimpse(languages)\n```\n````\n:::\n\n\n#### 4. Tidy Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: tidy-fixed\n#| warning: false\n\n### |- Join all datasets ----\nlanguages_combined <- languages |>\n  left_join(endangered_status, by = \"id\") |>\n  left_join(families, by = c(\"family_id\" = \"id\")) |>\n  mutate(\n    status_label = case_when(\n      status_code == 1 ~ \"Not Endangered\",\n      status_code == 2 ~ \"Threatened\",\n      status_code == 3 ~ \"Shifting\",\n      status_code == 4 ~ \"Moribund\",\n      status_code == 5 ~ \"Nearly Extinct\",\n      status_code == 6 ~ \"Extinct\",\n      TRUE ~ \"Unknown\"\n    ),\n    endangerment_broad = case_when(\n      status_code == 1 ~ \"Safe\",\n      status_code %in% 2:3 ~ \"Threatened/Shifting\",\n      status_code %in% 4:5 ~ \"Critical\",\n      status_code == 6 ~ \"Extinct\",\n      TRUE ~ \"Unknown\"\n    ),\n    is_endangered = status_code %in% 2:5,\n    n_countries = str_count(countries, \";\") + 1\n  )\n\n### |- Overall endangerment summary ----\nendangerment_summary <- languages_combined |>\n  count(status_label, endangerment_broad, sort = TRUE) |>\n  mutate(pct = n / sum(n))\n\n### |- Pacific region critical languages ----\npacific_critical <- languages_combined |>\n  filter(\n    endangerment_broad == \"Critical\",\n    !is.na(latitude), !is.na(longitude),\n    longitude >= 100, longitude <= 180,\n    latitude >= -50, latitude <= 20\n  )\n\n# Calculate total critical languages globally \ntotal_critical <- languages_combined |>\n  filter(endangerment_broad == \"Critical\") |>\n  nrow()\n\npacific_pct <- round(nrow(pacific_critical) / total_critical * 100)\n\n### |- data for treemap labels  ----\nendangerment_summary2 <- endangerment_summary |>\n  filter(endangerment_broad != \"Unknown\") |>\n  group_by(status_label) |>\n  summarise(n = sum(n), .groups = \"drop\") |>\n  mutate(\n    pct = n / sum(n),\n    status_label = fct_reorder(status_label, -n),\n    label_txt = glue(\"{status_label}\\n{comma(n)} ({scales::percent(pct, accuracy = 0.1)})\"),\n    text_color = if_else(status_label %in% c(\"Moribund\", \"Nearly Extinct\"), \"white\", \"gray10\")\n  )\n```\n````\n:::\n\n\n#### 5. Visualization Parameters\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: params\n#| include: true\n#| warning: false\n\n### |-  plot aesthetics ----\ncolors <- get_theme_colors(\n    palette = list(\n      col_not_endangered = \"#E8EEF2\",\n      col_shifting = \"#D0D0D0\",\n      col_threatened = \"#A8A8A8\",\n      col_extinct = \"#8A8A8A\",\n      col_moribund = \"#E63946\",\n      col_nearly_extinct = \"#C41E3A\",\n      col_map_bg = \"gray96\",\n      col_map_border = \"gray65\",\n      col_ink = \"gray10\",\n      col_rule = \"gray85\"\n  )\n)\n\n### |- titles and caption ----\nmain_title <- \"Global language endangerment: scale and geographic concentration\"\n\ntreemap_subtitle <- \"Share of 8,612 documented languages by endangerment status (Glottolog 5.2.1)\"\n\nmap_title <- \"Papunesia: a global hotspot for critical endangerment\"\nmap_subtitle <- glue(\n    \"{comma(nrow(pacific_critical))} of {comma(total_critical)} critically endangered languages \",\n    \"({pacific_pct}%) fall within the Pacific focus region\"\n)\n\ncaption_text <- create_social_caption(\n    tt_year = 2025,\n    tt_week = 51,\n    source_text = \"Glottolog 5.2.1 | Max Planck Institute for Evolutionary Anthropology\"\n)\n\nkey_takeaway <- glue(\n    \"Nearly **half of the worldâ€™s critically endangered languages** \",\n    \"are concentrated in the **Pacific region**, making **Papunesia** the global epicenter of language loss risk.\"\n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n  base_theme,\n  theme(\n    # Text styling\n    plot.title = element_text(\n      face = \"bold\", family = fonts$title, size = rel(1.4),\n      color = colors$title, margin = margin(b = 10), hjust = 0\n    ),\n    plot.subtitle = element_text(\n      face = \"italic\", family = fonts$subtitle, lineheight = 1.2,\n      color = colors$subtitle, size = rel(0.8), margin = margin(b = 20), hjust = 0\n    ),\n\n    # Grid\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n    panel.grid.major = element_line(color = \"gray90\", linewidth = 0.25),\n\n    # Axes\n    axis.title = element_text(size = rel(0.8), color = \"gray30\"),\n    axis.text = element_text(color = \"gray30\"),\n    axis.text.y = element_text(size = rel(0.85)),\n    axis.ticks = element_blank(),\n\n    # Facets\n    strip.background = element_rect(fill = \"gray95\", color = NA),\n    strip.text = element_text(\n      face = \"bold\",\n      color = \"gray20\",\n      size = rel(0.9),\n      margin = margin(t = 6, b = 4)\n    ),\n    panel.spacing = unit(1.5, \"lines\"),\n\n    # Legend elements\n    legend.position = \"plot\",\n    legend.title = element_text(\n      family = fonts$subtitle,\n      color = colors$text, size = rel(0.8), face = \"bold\"\n    ),\n    legend.text = element_text(\n      family = fonts$tsubtitle,\n      color = colors$text, size = rel(0.7)\n    ),\n    legend.margin = margin(t = 15),\n\n    # Plot margin\n    plot.margin = margin(20, 20, 20, 20),\n    \n    # Panel framing (subtle  containers) \n    panel.border     = element_rect(color = colors$palette$col_rule, fill = NA, linewidth = 0.8),\n  )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n````\n:::\n\n\n#### 6. Plot\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: plot\n#| warning: false\n\n### |- Plot 1: Treemap ----\np1 <- ggplot(\n    endangerment_summary2,\n    aes(area = n, fill = status_label)\n) +\n    geom_treemap(color = \"white\", size = 2) +\n    geom_treemap_text(\n        aes(label = label_txt, color = text_color),\n        place = \"centre\",\n        fontface = \"bold\",\n        size = 12,\n        grow = FALSE,\n        family = fonts$text,\n        reflow = TRUE\n    ) +\n    scale_fill_manual(\n        values = c(\n            \"Not Endangered\"  = colors$palette$col_not_endangered,\n            \"Shifting\"        = colors$palette$col_shifting,\n            \"Threatened\"      = colors$palette$col_threatened,\n            \"Extinct\"         = colors$palette$col_extinct,\n            \"Moribund\"        = colors$palette$col_moribund,\n            \"Nearly Extinct\"  = colors$palette$col_nearly_extinct\n        )\n    ) +\n    scale_color_identity() +\n    labs(\n        # tag = \"A\",\n        title = \"Endangerment status distribution\",\n        subtitle = treemap_subtitle\n    ) +\n    theme(\n        legend.position = \"none\",\n        plot.margin = margin(t = 6, r = 10, b = 6, l = 6)\n    )\n\n### |- Plot 2: Map  ----\nworld_map <- map_data(\"world\")\n\np2 <- ggplot() +\n    geom_polygon(\n        data = world_map,\n        aes(x = long, y = lat, group = group),\n        fill = colors$palette$col_map_bg,\n        color = colors$palette$col_map_border,\n        linewidth = 0.28\n    ) +\n    geom_point(\n        data = pacific_critical,\n        aes(x = longitude, y = latitude),\n        shape = 21,\n        fill  = colors$palette$col_moribund,\n        color = \"white\",\n        stroke = 0.35,\n        alpha = 0.75,\n        size  = 1.9\n    ) +\n    coord_fixed(\n        xlim = c(100, 180),\n        ylim = c(-50, 20),\n        ratio = 1.3,\n        expand = FALSE\n    ) +\n    labs(\n        # tag = \"B\",\n        title = map_title,\n        subtitle = map_subtitle\n    ) +\n    theme_void() +\n    theme(\n        plot.title = element_text(\n            face = \"bold\", family = fonts$title, size = 19.6,\n            color = colors$title, margin = margin(b = 10), hjust = 0\n        ),\n        plot.subtitle = element_text(\n            face = \"italic\", family = fonts$subtitle, lineheight = 1.2,\n            color = colors$subtitle, size = 11.2, margin = margin(b = 20), hjust = 0\n        ),\n        panel.border = element_rect(color = colors$palette$col_rule, fill = NA, linewidth = 0.8),\n        plot.margin = margin(t = 6, r = 6, b = 6, l = 10)\n    )\n\n### |- Combine plots ----\ncombined_plots <- p1 + p2 +\n    plot_annotation(\n        title    = main_title,\n        subtitle = key_takeaway,\n        caption  = caption_text,\n        theme =  theme(\n            plot.title = element_text(\n                size = rel(2.3),\n                family = fonts$title,\n                face = \"bold\",\n                color = colors$title,\n                lineheight = 1.15,\n                margin = margin(t = 8, b = 5)\n            ),\n            plot.subtitle = element_markdown(\n                size = rel(0.80),\n                family = fonts$subtitle,\n                color = alpha(colors$subtitle, 0.88),\n                lineheight = 1.5,\n                margin = margin(t = 5, b = 20)\n            ),\n            plot.caption = element_markdown(\n                size = rel(0.65),\n                family = fonts$subtitle,\n                color = colors$caption,\n                hjust = 0,\n                lineheight = 1.4,\n                margin = margin(t = 20, b = 5)\n            )\n        )\n    )\n```\n````\n:::\n\n\n#### 7. Save\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: save\n#| warning: false\n\n### |-  plot image ----  \nsave_plot_patchwork(\n  plot = combined_plots, \n  type = \"tidytuesday\", \n  year = 2025, \n  week = 51, \n  width  = 14,\n  height = 12,\n  )\n```\n````\n:::\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 26100)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] here_1.0.1       maps_3.4.2.1     patchwork_1.3.0  treemapify_2.5.6\n [5] glue_1.8.0       scales_1.3.0     skimr_2.1.5      janitor_2.2.0   \n [9] showtext_0.9-7   showtextdb_3.0   sysfonts_0.8.9   ggtext_0.1.2    \n[13] lubridate_1.9.3  forcats_1.0.0    stringr_1.5.1    dplyr_1.1.4     \n[17] purrr_1.0.2      readr_2.1.5      tidyr_1.3.1      tibble_3.2.1    \n[21] ggplot2_3.5.1    tidyverse_2.0.0  pacman_0.5.1    \n\nloaded via a namespace (and not attached):\n [1] tidyselect_1.2.1   farver_2.1.2       fastmap_1.2.0      gh_1.4.1          \n [5] digest_0.6.37      timechange_0.3.0   lifecycle_1.0.4    rsvg_2.6.1        \n [9] magrittr_2.0.3     compiler_4.4.0     rlang_1.1.6        tools_4.4.0       \n[13] utf8_1.2.4         yaml_2.3.10        knitr_1.49         labeling_0.4.3    \n[17] htmlwidgets_1.6.4  bit_4.5.0          curl_6.0.0         xml2_1.3.6        \n[21] camcorder_0.1.0    repr_1.1.7         tidytuesdayR_1.1.2 withr_3.0.2       \n[25] grid_4.4.0         fansi_1.0.6        colorspace_2.1-1   gitcreds_0.1.2    \n[29] cli_3.6.4          rmarkdown_2.29     crayon_1.5.3       generics_0.1.3    \n[33] rstudioapi_0.17.1  tzdb_0.5.0         commonmark_1.9.2   parallel_4.4.0    \n[37] ggplotify_0.1.2    base64enc_0.1-3    vctrs_0.6.5        yulab.utils_0.1.8 \n[41] jsonlite_1.8.9     gridGraphics_0.5-1 hms_1.1.3          bit64_4.5.2       \n[45] systemfonts_1.1.0  magick_2.8.5       gifski_1.32.0-1    codetools_0.2-20  \n[49] stringi_1.8.4      gtable_0.3.6       munsell_0.5.1      pillar_1.9.0      \n[53] rappdirs_0.3.3     htmltools_0.5.8.1  ggfittext_0.10.2   R6_2.5.1          \n[57] httr2_1.0.6        rprojroot_2.0.4    vroom_1.6.5        evaluate_1.0.1    \n[61] markdown_1.13      gridtext_0.1.5     snakecase_0.11.1   renv_1.0.3        \n[65] Rcpp_1.0.13-1      svglite_2.1.3      xfun_0.49          fs_1.6.5          \n[69] pkgconfig_2.0.3   \n```\n\n\n:::\n:::\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`tt_2025_51.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/TidyTuesday/2025/tt_2025_51.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n#### 10. References\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1.  **Data Source:**\n    -   TidyTuesday 2025 Week 50: [The Languages of the World](https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/2025-12-23/readme.md)\n:::\n\n#### 11. Custom Functions Documentation\n\n::: {.callout-note collapse=\"true\"}\n##### ðŸ“¦ Custom Helper Functions\n\nThis analysis uses custom functions from my personal module library for efficiency and consistency across projects.\n\n**Functions Used:**\n\n-   **`fonts.R`**: `setup_fonts()`, `get_font_families()` - Font management with showtext\n-   **`social_icons.R`**: `create_social_caption()` - Generates formatted social media captions\n-   **`image_utils.R`**: `save_plot()` - Consistent plot saving with naming conventions\n-   **`base_theme.R`**: `create_base_theme()`, `extend_weekly_theme()`, `get_theme_colors()` - Custom ggplot2 themes\n\n**Why custom functions?**\\\nThese utilities standardize theming, fonts, and output across all my data visualizations. The core analysis (data tidying and visualization logic) uses only standard tidyverse packages.\n\n**Source Code:**\\\nView all custom functions â†’ [GitHub: R/utils](https://github.com/poncest/personal-website/tree/master/R)\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}