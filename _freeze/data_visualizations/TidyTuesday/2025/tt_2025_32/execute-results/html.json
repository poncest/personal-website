{
  "hash": "698e1314610b83f4207b2a4aef951de4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Regional evolution of extreme weather attribution science\"\nsubtitle: \"How different regions developed attribution research over time (2010–2024)\"\ndescription: \"Regional analysis of extreme weather attribution science development (2010-2024) reveals distinct patterns in research volume and rapid attribution methodology adoption across global regions. Using normalized comparisons of TidyTuesday data, the visualization shows how some regions emerged as early adopters while others maintained traditional approaches.\"\nauthor: \"Steven Ponce\"\ndate: \"2025-08-12\" \ncategories: [\"TidyTuesday\", \"Data Visualization\", \"R Programming\", \"2025\"]\ntags: [\n  \"extreme weather\",\n  \"climate attribution\",\n  \"regional analysis\", \n  \"time series\",\n  \"faceted visualization\",\n  \"normalized comparison\",\n  \"rapid attribution\",\n  \"climate science\",\n  \"research trends\",\n  \"scientific methodology\",\n  \"carbon brief\",\n  \"ggplot2\",\n  \"data normalization\",\n  \"moving averages\"\n]\nimage: \"thumbnails/tt_2025_32.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                    \n  cache: true                                       \n  error: false\n  message: false\n  warning: false\n  eval: true\n---\n\n![A faceted line chart illustrating the regional evolution of extreme weather attribution science from 2010 to 2024 across eight regions. Each panel displays two metrics: study volume (green solid/dashed lines) normalized within each region, and rapid attribution adoption rates (orange dashed lines). Europe leads with 163 studies, followed by Eastern/South-Eastern Asia (161) and North America (135). The chart reveals distinct regional patterns: some regions, such as North America, exhibit early and rapid adoption peaks around 2018-2020, while others, like Eastern Asia, display steady volume growth with late-emerging rapid adoption. Background shading indicates three development phases: Emergence (2010-2013), Growth (2014-2018), and Maturation (2019-2024). Thin lines represent annual data, while thick lines show 3-year moving averages that exclude partial years.)](tt_2025_32.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: load\n#| warning: false\n#| message: false\n#| results: \"hide\"\n\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\n        tidyverse,  # Easily Install and Load the 'Tidyverse'\n    tidyverse,   # Easily Install and Load the 'Tidyverse'\n    ggtext,      # Improved Text Rendering Support for 'ggplot2'\n    showtext,    # Using Fonts More Easily in R Graphs\n    janitor,     # Simple Tools for Examining and Cleaning Dirty Data\n    scales,      # Scale Functions for Visualization\n    glue,        # Interpreted String Literals\n    zoo          # S3 Infrastructure for Regular and Irregular Time Series\n  )})\n\n### |- figure size ----\ncamcorder::gg_record(\n  dir    = here::here(\"temp_plots\"),\n  device = \"png\",\n  width  = 12,\n  height = 8,\n  units  = \"in\",\n  dpi    = 320\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n````\n:::\n\n\n#### 2. Read in the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: read\n#| include: true\n#| eval: true\n#| warning: false\n\ntt <- tidytuesdayR::tt_load(2025, week = 32)\n\nattribution_studies <- tt$attribution_studies |> clean_names()\n\ntidytuesdayR::readme(tt)\nrm(tt)\n```\n````\n:::\n\n\n#### 3. Examine the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: examine\n#| include: true\n#| eval: true\n#| results: 'hide'\n#| warning: false\n\nglimpse(attribution_studies)\n```\n````\n:::\n\n\n#### 4. Tidy Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: tidy\n#| warning: false\n\nattribution_clean <- attribution_studies |>\n  clean_names() |>\n  mutate(publication_year = as.integer(publication_year)) |>\n  mutate(\n    cb_region = str_to_title(cb_region),\n    cb_region = case_when(\n      cb_region == \"Usa\" ~ \"USA\",\n      cb_region == \"Northern Hemisphere\" ~ \"Northern Hemisphere\",\n      TRUE ~ cb_region\n    ),\n    rapid_study = factor(rapid_study, levels = c(\"Yes\", \"No\"))\n  )\n\n# how many ending years to treat as potentially partial\nPARTIAL_YEARS <- 1\n\nregional_evolution_data <- attribution_clean |>\n  filter(!is.na(publication_year), !is.na(cb_region), publication_year >= 2010) |>\n  group_by(cb_region) |>\n  mutate(region_total_studies = n()) |>\n  ungroup() |>\n  filter(region_total_studies >= 30) |>\n  # Annual counts by region/year/rapid\n  count(cb_region, publication_year, rapid_study, name = \"studies\") |>\n  # Complete years ONLY within each region up to its own last observed year\n  group_by(cb_region, rapid_study) |>\n  complete(\n    publication_year = seq(min(publication_year, na.rm = TRUE),\n      max(publication_year, na.rm = TRUE),\n      by = 1\n    ),\n    fill = list(studies = 0)\n  ) |>\n  ungroup() |>\n  # yearly totals & rapid adoption\n  group_by(cb_region, publication_year) |>\n  summarise(\n    total_studies = sum(studies),\n    rapid_studies = sum(studies[rapid_study == \"Yes\"], na.rm = TRUE),\n    .groups = \"drop\"\n  ) |>\n  mutate(rapid_adoption_rate = rapid_studies / pmax(total_studies, 1)) |>\n  # Normalize + Smoothing (centered, but exclude partial-year leakage)\n  group_by(cb_region) |>\n  mutate(\n    total_normalized = if (max(total_studies) > min(total_studies)) {\n      (total_studies - min(total_studies)) / (max(total_studies) - min(total_studies))\n    } else {\n      0.5\n    },\n    # region-wise bounds\n    min_y = min(publication_year),\n    max_y = max(publication_year),\n    # last year to be treated as \"complete\" for smoothing windows\n    last_complete_y = max_y - PARTIAL_YEARS\n  ) |>\n  arrange(cb_region, publication_year) |>\n  # compute centered rollmean across full series\n  mutate(\n    total_smooth_tmp = zoo::rollmean(total_normalized, k = 3, fill = NA, align = \"center\"),\n    rapid_smooth_tmp = zoo::rollmean(rapid_adoption_rate, k = 3, fill = NA, align = \"center\")\n  ) |>\n  # Mask smoothed values whose 3-yr window would include partial years\n  mutate(\n    valid_center = publication_year >= (min_y + 1) & publication_year <= (last_complete_y - 1),\n    total_smooth = ifelse(valid_center, total_smooth_tmp, NA_real_),\n    rapid_smooth = ifelse(valid_center, rapid_smooth_tmp, NA_real_)\n  ) |>\n  # context metrics & labels\n  mutate(\n    total_regional_studies = sum(total_studies),\n    avg_rapid_adoption = mean(rapid_adoption_rate, na.rm = TRUE),\n    research_start_year = min(publication_year[total_studies > 0]),\n    development_pattern = case_when(\n      avg_rapid_adoption > 0.30 ~ \"Early Adopter\",\n      avg_rapid_adoption > 0.15 ~ \"Moderate Adopter\",\n      TRUE ~ \"Traditional\"\n    )\n  ) |>\n  ungroup() |>\n  # field development phases (for backdrop)\n  mutate(\n    development_phase = case_when(\n      publication_year <= 2013 ~ \"Emergence\",\n      publication_year <= 2018 ~ \"Growth\",\n      TRUE ~ \"Maturation\"\n    ),\n    phase_color = case_when(\n      development_phase == \"Emergence\" ~ \"#f0f0f0\",\n      development_phase == \"Growth\" ~ \"#f5f5f5\",\n      TRUE ~ \"#fafafa\"\n    ),\n    facet_order_metric = total_regional_studies * (2024 - research_start_year),\n    region_label = paste0(cb_region, \"\\n(\", total_regional_studies, \" studies)\")\n  ) |>\n  arrange(development_pattern, desc(total_regional_studies)) |>\n  ungroup()\n```\n````\n:::\n\n\n#### 5. Visualization Parameters\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: params\n#| include: true\n#| warning: false\n\n### |-  plot aesthetics ----\ncolors <- get_theme_colors(\n    palette = c(\n      \"Study Volume\" = \"#2E8B57\", \n      \"Rapid Adoption\" = \"#FF8C00\" \n    )\n)\n\n### |- titles and caption ----\ntitle_text <- str_glue(\"Regional evolution of extreme weather attribution science\")\n\nsubtitle_text <- str_glue(\n    \"How different regions developed attribution research over time (2010–2024)\\n\",\n    \"Study volume normalized within each region for fair comparison\\n\",\n    \"Thin lines = annual data • Thick lines = centered 3-year MA (excludes partial years)\"\n)\n\ncaption_text <- create_social_caption(\n    tt_year = 2025,\n    tt_week = 32,\n    source_text =  \"Our World in Data\"\n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n    base_theme,\n    theme(\n        # Text styling\n        plot.title = element_text(face = \"bold\", family = fonts$title, size = rel(1.2), color  = colors$title, margin = margin(b = 10)),\n        plot.subtitle = element_text(family = fonts$subtitle, lineheight = 1.2, color = colors$subtitle, size = rel(0.78), margin = margin(b = 20)),\n        \n        # Axis elements\n        axis.line = element_blank(), \n        axis.ticks = element_blank(), \n        \n        # Grid elements\n        panel.grid.major = element_line(color = \"gray90\",linetype = \"solid\", linewidth = 0.3),\n        panel.grid.minor = element_blank(), \n   \n        # Axis elements\n        axis.text = element_text(color = colors$text, size = rel(0.7)),\n        axis.title.x = element_text(color = colors$text, face = \"bold\", size = rel(0.8), margin = margin(t = 15)),\n        axis.title.y = element_text(color = colors$text, face = \"bold\", size = rel(0.8), margin = margin(r = 10)),\n        \n        # Legend elements\n        legend.position = \"top\",\n        legend.title = element_text(family = fonts$tsubtitle, color = colors$text, size = rel(0.8), face = \"bold\"),\n        legend.text = element_text(family = fonts$tsubtitle, color = colors$text, size = rel(0.7)),\n        legend.margin = margin(t = 15),\n        \n        # Plot margin\n        plot.margin = margin(t = 15, r = 15, b = 15, l = 15),\n    )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n````\n:::\n\n\n#### 6. Plot\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: plot\n#| warning: false\n\n### |-  final plot ----\np <- ggplot(regional_evolution_data, aes(x = publication_year)) +\n  # Annotate (bkg phases)\n  annotate(\"rect\",\n    xmin = 2010, xmax = 2013.5, ymin = -Inf, ymax = Inf,\n    fill = \"#f0f0f0\", alpha = 0.6\n  ) +\n  annotate(\"rect\",\n    xmin = 2013.5, xmax = 2018.5, ymin = -Inf, ymax = Inf,\n    fill = \"#f8f8f8\", alpha = 0.6\n  ) +\n  annotate(\"rect\",\n    xmin = 2018.5, xmax = 2024, ymin = -Inf, ymax = Inf,\n    fill = \"#fdfdfd\", alpha = 0.6\n  ) +\n  # Geoms\n  geom_line(aes(y = total_normalized, color = \"Study Volume\", linetype = \"Study Volume\"),\n    alpha = 0.4, linewidth = 0.7\n  ) +\n  geom_line(aes(y = rapid_adoption_rate, color = \"Rapid Adoption\", linetype = \"Rapid Adoption\"),\n    alpha = 0.4, linewidth = 0.7\n  ) +\n  geom_line(aes(y = total_smooth, color = \"Study Volume\", linetype = \"Study Volume\"),\n    linewidth = 2, na.rm = TRUE\n  ) +\n  geom_line(aes(y = rapid_smooth, color = \"Rapid Adoption\", linetype = \"Rapid Adoption\"),\n    linewidth = 2, na.rm = TRUE\n  ) +\n  # Annotate (phase labels)\n  annotate(\"text\",\n    x = 2011.75, y = 0.95, label = \"Emergence\",\n    size = 3, alpha = 0.5, fontface = \"italic\"\n  ) +\n  annotate(\"text\",\n    x = 2016, y = 0.95, label = \"Growth\",\n    size = 3, alpha = 0.5, fontface = \"italic\"\n  ) +\n  annotate(\"text\",\n    x = 2021, y = 0.95, label = \"Maturation\",\n    size = 3, alpha = 0.5, fontface = \"italic\"\n  ) +\n  # Scales\n  scale_color_manual(\n    values = colors$palette,\n    name = \"Metric (Normalized)\",\n    labels = c(\n      \"Rapid Adoption\" = \"Rapid Adoption Rate\",\n      \"Study Volume\" = \"Study Volume (Normalized)\"\n    )\n  ) +\n  scale_linetype_manual(\n    values = c(\"Study Volume\" = \"solid\", \"Rapid Adoption\" = \"22\"),\n    name = \"Metric (Normalized)\",\n    labels = c(\n      \"Rapid Adoption\" = \"Rapid Adoption Rate\",\n      \"Study Volume\" = \"Study Volume (Normalized)\"\n    )\n  ) +\n  scale_y_continuous(\n    labels = percent_format(),\n    limits = c(0, 1), breaks = seq(0, 1, 0.25)\n  ) +\n  scale_x_continuous(breaks = seq(2010, 2024, 4)) +\n  # Labs\n  labs(\n    title = title_text,\n    subtitle = subtitle_text,\n    x = \"Publication Year\",\n    y = \"Normalized Scale (0–100%)\",\n    caption = paste0(\n      \"Background shading shows field development phases • \",\n      \"Facets ordered by research maturity & volume • \",\n      \"Numbers in region labels = total studies<br><br>\",\n      caption_text\n    )\n  ) +\n  # Facets\n  facet_wrap(~ fct_reorder(region_label, facet_order_metric, .desc = TRUE),\n    ncol = 4, scales = \"free_x\"\n  ) +\n  # Theme\n  theme(\n    plot.title = element_text(\n      size = rel(1.65),\n      family = fonts$title,\n      face = \"bold\",\n      color = colors$title,\n      lineheight = 1.1,\n      margin = margin(t = 5, b = 10)\n    ),\n    plot.subtitle = element_text(\n      size = rel(0.85),\n      family = fonts$subtitle,\n      color = alpha(colors$subtitle, 0.9),\n      lineheight = 1.2,\n      margin = margin(t = 0, b = 10)\n    ),\n    plot.caption = element_markdown(\n      size = rel(0.55),\n      family = fonts$caption,\n      color = colors$caption,\n      hjust = 1,\n      margin = margin(t = 10)\n    ),\n    strip.text = element_text(size = rel(0.70), face = \"bold\", margin = margin(b = 10)),\n    panel.spacing.x = unit(1.5, \"cm\"),\n    panel.spacing.y = unit(1.2, \"cm\"),\n  )\n```\n````\n:::\n\n\n#### 7. Save\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: save\n#| warning: false\n\n### |-  plot image ----  \nsave_plot(\n  plot = p, \n  type = \"tidytuesday\", \n  year = 2025, \n  week = 32, \n  width  = 12,\n  height = 8\n  )\n```\n````\n:::\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 22631)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] here_1.0.1      zoo_1.8-12      glue_1.8.0      scales_1.3.0   \n [5] janitor_2.2.0   showtext_0.9-7  showtextdb_3.0  sysfonts_0.8.9 \n [9] ggtext_0.1.2    lubridate_1.9.3 forcats_1.0.0   stringr_1.5.1  \n[13] dplyr_1.1.4     purrr_1.0.2     readr_2.1.5     tidyr_1.3.1    \n[17] tibble_3.2.1    ggplot2_3.5.1   tidyverse_2.0.0 pacman_0.5.1   \n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.6       httr2_1.0.6        xfun_0.49          htmlwidgets_1.6.4 \n [5] gh_1.4.1           lattice_0.22-6     tzdb_0.5.0         vctrs_0.6.5       \n [9] tools_4.4.0        generics_0.1.3     parallel_4.4.0     curl_6.0.0        \n[13] gifski_1.32.0-1    fansi_1.0.6        pkgconfig_2.0.3    lifecycle_1.0.4   \n[17] farver_2.1.2       compiler_4.4.0     textshaping_0.4.0  munsell_0.5.1     \n[21] codetools_0.2-20   snakecase_0.11.1   htmltools_0.5.8.1  yaml_2.3.10       \n[25] crayon_1.5.3       pillar_1.9.0       camcorder_0.1.0    magick_2.8.5      \n[29] commonmark_1.9.2   tidyselect_1.2.1   digest_0.6.37      stringi_1.8.4     \n[33] rsvg_2.6.1         rprojroot_2.0.4    fastmap_1.2.0      grid_4.4.0        \n[37] colorspace_2.1-1   cli_3.6.4          magrittr_2.0.3     utf8_1.2.4        \n[41] withr_3.0.2        rappdirs_0.3.3     bit64_4.5.2        timechange_0.3.0  \n[45] rmarkdown_2.29     tidytuesdayR_1.1.2 gitcreds_0.1.2     bit_4.5.0         \n[49] ragg_1.3.3         hms_1.1.3          evaluate_1.0.1     knitr_1.49        \n[53] markdown_1.13      rlang_1.1.6        gridtext_0.1.5     Rcpp_1.0.13-1     \n[57] xml2_1.3.6         renv_1.0.3         vroom_1.6.5        svglite_2.1.3     \n[61] rstudioapi_0.17.1  jsonlite_1.8.9     R6_2.5.1           systemfonts_1.1.0 \n```\n\n\n:::\n:::\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`tt_2025_32.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/TidyTuesday/2025/tt_2025_32.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n#### 10. References\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1.  Data Sources:\n\n-   TidyTuesday 2025 Week 32: \\[Extreme Weather Attribution Studies\\](https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/2025-08-12)\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}