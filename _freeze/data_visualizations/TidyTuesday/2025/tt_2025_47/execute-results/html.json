{
  "hash": "3aa06744de280810a6e9d7aaff694910",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"The Statistical Performance Gap: High vs. Low Income Countries\"\nsubtitle: \"Based on 27 low-income and 56 high-income countries (2023) â€¢ Pillars ordered by gap size (largest to smallest)\"\ndescription: \"Analyzing inequality in statistical capacity using World Bank's Statistical Performance Indicators. High-income countries outperform low-income peers across all five pillars, with the largest gaps in data sources and infrastructure.\"\ndate: \"2025-11-22\" \ncategories: [\"TidyTuesday\", \"Data Visualization\", \"R Programming\", \"2025\"]\ntags: [\n  \"World Bank\",\n  \"Statistical Capacity\",\n  \"Income Inequality\",\n  \"Development Indicators\",\n  \"Faceted Plots\",\n  \"Gap Analysis\",\n  \"ggplot2\",\n  \"Data Literacy\",\n  \"Global Development\",\n  \"Statistical Systems\",\n  \"Data Infrastructure\",\n  \"Public Policy\"\n]\nimage: \"thumbnails/tt_2025_47.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                    \n  cache: true                                       \n  error: false\n  message: false\n  warning: false\n  eval: true\n---\n\n![Faceted line chart showing statistical performance gaps between high-income (teal) and low-income (purple) countries across five pillars from 2016 to 2023. Gray ribbons highlight the gaps between income groups. Data Sources shows the most significant gap at 43 points, followed by Data Infrastructure at 34 points and Data Services at 27 points. Data Use and Data Products show smaller gaps of 14 and 6 points, respectively. High-income countries consistently score higher across all pillars, with most gaps remaining stable or widening over time, except Data Products, which shows slight convergence.](tt_2025_47.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: load\n#| warning: false\n#| message: false\n#| results: \"hide\"\n\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\n    tidyverse,     # Easily Install and Load the 'Tidyverse'\n    ggtext,        # Improved Text Rendering Support for 'ggplot2'\n    showtext,      # Using Fonts More Easily in R Graphs\n    janitor,       # Simple Tools for Examining and Cleaning Dirty Data\n    scales,        # Scale Functions for Visualization\n    ggrepel,       # Automatically Position Non-Overlapping Text Labels with 'ggplot2'\n    glue           # Interpreted String Literals\n)\n})\n\n### |- figure size ----\ncamcorder::gg_record(\n  dir    = here::here(\"temp_plots\"),\n  device = \"png\",\n  width  = 10,\n  height = 10,\n  units  = \"in\",\n  dpi    = 320\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n````\n:::\n\n\n#### 2. Read in the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: read\n#| include: true\n#| eval: true\n#| warning: false\n\ntt <- tidytuesdayR::tt_load(2025, week = 47)\n\nspi_indicators <- tt$spi_indicators |> clean_names()\n\ntidytuesdayR::readme(tt)\nrm(tt)\n```\n````\n:::\n\n\n#### 3. Examine the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: examine\n#| include: true\n#| eval: true\n#| results: 'hide'\n#| warning: false\n\nglimpse(spi_indicators)\nskimr::skim(spi_indicators) |> summary()\n```\n````\n:::\n\n\n#### 4. Tidy Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: tidy-fixed\n#| warning: false\n\n# clean base data\nspi_tidy <- spi_indicators |>\n  mutate(\n    year = as.integer(year),\n    income = factor(\n      income,\n      levels = c(\n        \"Low income\", \"Lower middle income\",\n        \"Upper middle income\", \"High income\"\n      )\n    )\n  ) |>\n  filter(!is.na(overall_score))\n\n# reshape to long format for pillar analysis\npillar_long <- spi_tidy |>\n  pivot_longer(\n    cols = ends_with(\"_score\") & !contains(\"overall\"),\n    names_to = \"pillar\",\n    values_to = \"score\"\n  ) |>\n  mutate(\n    pillar = str_remove(pillar, \"_score\") |>\n      str_replace_all(\"_\", \" \") |>\n      str_to_title()\n  )\n\n# Focus on High and Low income, calculate averages\npillar_gap_data <- pillar_long |>\n  filter(income %in% c(\"Low income\", \"High income\")) |>\n  group_by(year, income, pillar) |>\n  summarize(\n    avg_score = mean(score, na.rm = TRUE),\n    n_countries = n(),\n    .groups = \"drop\"\n  )\n\n# Calculate gaps and create ordering\npillar_gaps <- pillar_gap_data |>\n  select(year, income, pillar, avg_score) |>\n  pivot_wider(names_from = income, values_from = avg_score) |>\n  mutate(gap = `High income` - `Low income`)\n\n# Get pillar order and apply to both datasets\npillar_order <- pillar_gaps |>\n  filter(year == 2023) |>\n  arrange(desc(gap)) |>\n  pull(pillar)\n\n# Apply ordering to both datasets\npillar_gap_data <- pillar_gap_data |>\n  mutate(pillar = factor(pillar, levels = pillar_order))\n\nribbon_data <- pillar_gaps |>\n  mutate(pillar = factor(pillar, levels = pillar_order))\n\n# create facet labels with gap sizes\nfacet_labels_vec <- pillar_gaps |>\n  filter(year == 2023) |>\n  mutate(\n    gap_rounded = round(gap, 0),\n    facet_label = glue(\"{pillar}\\n(Gap: {gap_rounded} pts)\")\n  ) |>\n  select(pillar, facet_label) |>\n  deframe()\n```\n````\n:::\n\n\n#### 5. Visualization Parameters\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: params\n#| include: true\n#| warning: false\n\n### |-  plot aesthetics ----\ncolors <- get_theme_colors(\n    palette = list(\n        low_income = \"#9b59b6\"  ,\n        high_income = \"#0f9a8a\",\n        gap_fill = \"#c9d0d8\"\n    )\n)\n\n### |- titles and caption ----\ntitle_text <- \"The Statistical Performance Gap: High vs. Low Income Countries\"\n\nsubtitle_text <- str_glue(\n    \"Based on 27 low-income and 56 high-income countries (2023) â€¢ Pillars ordered by gap size (largest to smallest)<br>\",\n    \"High-income countries consistently outperform low-income peers across all pillars.<br><br>\",\n    \"Think of this as a **health checkup for a country's data ecosystem:**<br><br>\",\n    \"**Data Sources** = Census, surveys, admin data quality â€¢ **Data Infrastructure** = Laws, IT systems, trained staff<br>\",\n    \"**Data Services** = Open portals, timely releases â€¢ **Data Use** = Are stats used by policymakers? â€¢ **Data Products** = GDP, health, SDG indicators\"\n)\n\ncaption_text <- create_social_caption(\n    tt_year = 2025,\n    tt_week = 46,\n    source_text = \"World Bank Statistical Performance Indicators\"\n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n  base_theme,\n  theme(\n    # Text styling\n    plot.title = element_markdown(\n      face = \"bold\", family = fonts$title, size = rel(1.4),\n      color = colors$title, margin = margin(b = 10), hjust = 0\n    ),\n    plot.subtitle = element_text(\n      face = \"italic\", family = fonts$subtitle, lineheight = 1.2,\n      color = colors$subtitle, size = rel(0.9), margin = margin(b = 20), hjust = 0\n    ),\n\n    # Grid\n    panel.grid.minor = element_blank(),\n    panel.grid.major.x = element_blank(),\n    panel.grid.major.y = element_line(color = \"gray90\", linewidth = 0.3),\n\n    # Axes\n    axis.title = element_text(size = rel(0.8), color = \"gray30\"),\n    axis.text = element_text(color = \"gray30\"),\n    axis.text.y = element_text(size = rel(0.85)),\n    axis.ticks = element_blank(),\n\n    # Facets\n    strip.background = element_rect(fill = \"gray95\", color = NA),\n    strip.text = element_text(\n      face = \"bold\",\n      color = \"gray20\",\n      size = rel(0.9),\n      margin = margin(t = 6, b = 4)\n    ),\n    panel.spacing = unit(1.5, \"lines\"),\n\n    # Legend elements\n    legend.position = \"plot\",\n    legend.title = element_text(\n      family = fonts$tsubtitle,\n      color = colors$text, size = rel(0.8), face = \"bold\"\n    ),\n    legend.text = element_text(\n      family = fonts$tsubtitle,\n      color = colors$text, size = rel(0.7)\n    ),\n    legend.margin = margin(t = 15),\n\n    # Plot margin\n    plot.margin = margin(20, 20, 20, 20)\n  )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n````\n:::\n\n\n#### 6. Plot\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: plot\n#| warning: false\n\n### |-  main plot ----\np <- \n  ggplot() +\n  # Geoms\n  geom_ribbon(\n    data = ribbon_data,\n    aes(x = year, ymin = `Low income`, ymax = `High income`),\n    fill = colors$palette$gap_fill,\n    alpha = 0.6\n  ) +\n  geom_line(\n    data = pillar_gap_data,\n    aes(x = year, y = avg_score, color = income, group = income),\n    linewidth = 1.2,\n    alpha = 0.9\n  ) +\n  geom_point(\n    data = pillar_gap_data,\n    aes(x = year, y = avg_score, color = income),\n    size = 2.5\n  ) +\n  # Facets\n  facet_wrap(\n    ~pillar,\n    ncol = 3,\n    labeller = labeller(pillar = facet_labels_vec)\n  ) +\n  # Scales\n  scale_x_continuous(breaks = c(2016, 2020, 2023)) +\n  scale_y_continuous(\n    limits = c(0, 100),\n    breaks = seq(0, 100, 25),\n    labels = label_number()\n  ) +\n  scale_color_manual(\n    values = c(\n      \"Low income\" = colors$palette$low_income,\n      \"High income\" = colors$palette$high_income\n    )\n  ) +\n  # Labs\n  labs(\n    title = title_text,\n    subtitle = subtitle_text,\n    caption = caption_text,\n    x = NULL,\n    y = \"Average SPI Score\",\n    # color = NULL,\n  ) +\n  # Theme\n  theme(\n    plot.title = element_markdown(\n      size = rel(1.8),\n      family = fonts$title,\n      face = \"bold\",\n      color = colors$title,\n      lineheight = 1.15,\n      margin = margin(t = 8, b = 5)\n    ),\n    plot.subtitle = element_markdown(\n      size = rel(0.7),\n      family = fonts$subtitle,\n      color = alpha(colors$subtitle, 0.88),\n      lineheight = 1.2,\n      margin = margin(t = 4, b = 0)\n    ),\n    plot.caption = element_markdown(\n      size = rel(0.56),\n      family = \"Arial\",\n      color = colors$caption,\n      hjust = 0,\n      lineheight = 1.4,\n      margin = margin(t = 15, b = 5)\n    ),\n    # Legend\n    legend.position = \"top\",\n    legend.justification = \"left\",\n    legend.text = element_text(size = 11),\n  )\n```\n````\n:::\n\n\n#### 7. Save\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: save\n#| warning: false\n\n### |-  plot image ----  \nsave_plot(\n  plot = p, \n  type = \"tidytuesday\", \n  year = 2025, \n  week = 47, \n  width  = 10,\n  height = 10,\n  )\n```\n````\n:::\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 26100)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] here_1.0.1      glue_1.8.0      ggrepel_0.9.6   scales_1.3.0   \n [5] janitor_2.2.0   showtext_0.9-7  showtextdb_3.0  sysfonts_0.8.9 \n [9] ggtext_0.1.2    lubridate_1.9.3 forcats_1.0.0   stringr_1.5.1  \n[13] dplyr_1.1.4     purrr_1.0.2     readr_2.1.5     tidyr_1.3.1    \n[17] tibble_3.2.1    ggplot2_3.5.1   tidyverse_2.0.0 pacman_0.5.1   \n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.6       xfun_0.49          httr2_1.0.6        htmlwidgets_1.6.4 \n [5] gh_1.4.1           tzdb_0.5.0         vctrs_0.6.5        tools_4.4.0       \n [9] generics_0.1.3     parallel_4.4.0     curl_6.0.0         gifski_1.32.0-1   \n[13] fansi_1.0.6        pkgconfig_2.0.3    skimr_2.1.5        lifecycle_1.0.4   \n[17] farver_2.1.2       compiler_4.4.0     textshaping_0.4.0  munsell_0.5.1     \n[21] repr_1.1.7         codetools_0.2-20   snakecase_0.11.1   htmltools_0.5.8.1 \n[25] yaml_2.3.10        crayon_1.5.3       pillar_1.9.0       camcorder_0.1.0   \n[29] magick_2.8.5       commonmark_1.9.2   tidyselect_1.2.1   digest_0.6.37     \n[33] stringi_1.8.4      rsvg_2.6.1         rprojroot_2.0.4    fastmap_1.2.0     \n[37] grid_4.4.0         colorspace_2.1-1   cli_3.6.4          magrittr_2.0.3    \n[41] base64enc_0.1-3    utf8_1.2.4         withr_3.0.2        rappdirs_0.3.3    \n[45] bit64_4.5.2        timechange_0.3.0   rmarkdown_2.29     tidytuesdayR_1.1.2\n[49] gitcreds_0.1.2     bit_4.5.0          ragg_1.3.3         hms_1.1.3         \n[53] evaluate_1.0.1     knitr_1.49         markdown_1.13      rlang_1.1.6       \n[57] gridtext_0.1.5     Rcpp_1.0.13-1      xml2_1.3.6         renv_1.0.3        \n[61] vroom_1.6.5        svglite_2.1.3      rstudioapi_0.17.1  jsonlite_1.8.9    \n[65] R6_2.5.1           systemfonts_1.1.0 \n```\n\n\n:::\n:::\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`tt_2025_47.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/TidyTuesday/2025/tt_2025_47.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n#### 10. References\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1.  **Data Source:**\n    -   TidyTuesday 2025 Week 47: [Statistical Performance Indicators](https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/2025-11-25/readme.md)\n:::\n\n#### 11. Custom Functions Documentation\n\n::: {.callout-note collapse=\"true\"}\n##### ðŸ“¦ Custom Helper Functions\n\nThis analysis uses custom functions from my personal module library for efficiency and consistency across projects.\n\n**Functions Used:**\n\n-   **`fonts.R`**: `setup_fonts()`, `get_font_families()` - Font management with showtext\n-   **`social_icons.R`**: `create_social_caption()` - Generates formatted social media captions\n-   **`image_utils.R`**: `save_plot()` - Consistent plot saving with naming conventions\n-   **`base_theme.R`**: `create_base_theme()`, `extend_weekly_theme()`, `get_theme_colors()` - Custom ggplot2 themes\n\n**Why custom functions?**\\\nThese utilities standardize theming, fonts, and output across all my data visualizations. The core analysis (data tidying and visualization logic) uses only standard tidyverse packages.\n\n**Source Code:**\\\nView all custom functions â†’ [GitHub: R/utils](https://github.com/poncest/personal-website/tree/master/R)\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}