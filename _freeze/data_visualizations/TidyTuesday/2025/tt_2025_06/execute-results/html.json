{
  "hash": "6798f5c3fa472c208fa17eaf0b985a01",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"CDC Dataset Purge: A Timeline of Public Health Data Removal\"\nsubtitle: \"Analysis of CDC datasets backed up on archive.org during the Trump administration's data purge\"\ndescription: \"A data visualization analysis exploring CDC dataset archival patterns from 2016 to 2025. The analysis reveals changing accessibility patterns and a significant increase in archival activity beginning in 2020, with a focus on public health data preservation.\"\nauthor: \"Steven Ponce\"\ndate: \"2025-02-08\" \ncategories: [\"TidyTuesday\", \"Data Visualization\", \"R Programming\", \"2025\"]\ntags: [\n    \"CDC\",\n   \"public health\",\n   \"data accessibility\",\n   \"data preservation\",\n   \"archive.org\",\n   \"ggplot2\",\n   \"time series\",\n   \"data analysis\",\n   \"health data\",\n   \"data visualization\",\n   \"R\",\n   \"tidyverse\"\n]\nimage: \"thumbnails/tt_2025_06.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                                  \n  cache: true                                                   \n  error: false\n  message: false\n  warning: false\n  eval: true\nfilters:\n  - social-share\nshare:\n  permalink: \"https://stevenponce.netlify.app/data_visualizations/TidyTuesday/2025/tt_2025_06.html\"\n  description: \"Exploring patterns in CDC dataset archival activity: A visual analysis of public health data accessibility and preservation efforts from 2016-2025. #TidyTuesday #rstats #DataViz\"\n\n  twitter: true\n  linkedin: true\n  email: true\n  facebook: false\n  reddit: false\n  stumble: false\n  tumblr: false\n  mastodon: true\n  bsky: true\n---\n\n\n\n![A two-panel visualization of CDC dataset archival patterns. Top panel: Bar chart showing distribution of 1,257 datasets by access level - majority are either Unspecified (51.5%) or Public Access (47.9%). Bottom panel: Area chart showing cumulative growth of archived datasets from 2016 to 2025, with a notable increase in archival activity starting 2020, marked by a vertical dashed line.](tt_2025_06.png){#fig-1}\n\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\n    tidyverse,      # Easily Install and Load the 'Tidyverse'\n    ggtext,         # Improved Text Rendering Support for 'ggplot2'\n    showtext,       # Using Fonts More Easily in R Graphs\n    janitor,        # Simple Tools for Examining and Cleaning Dirty Data\n    skimr,          # Compact and Flexible Summaries of Data\n    scales,         # Scale Functions for Visualization\n    glue,           # Interpreted String Literals\n    here,           # A Simpler Way to Find Your Files\n    patchwork,      # The Composer of Plots\n    camcorder       # Record Your Plot History \n    )\n})\n\n### |- figure size ----\ngg_record(\n    dir    = here::here(\"temp_plots\"),\n    device = \"png\",\n    width  =  10,\n    height =  10,\n    units  = \"in\",\n    dpi    = 320\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n:::\n\n\n\n#### 2. Read in the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntt <- tidytuesdayR::tt_load(2025, week = 06) \n\ncdc <- tt$cdc_datasets |> clean_names()\n\ntidytuesdayR::readme(tt)\nrm(tt)\n```\n:::\n\n\n\n#### 3. Examine the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(cdc)\nskim(cdc)\n```\n:::\n\n\n\n#### 4. Tidy Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# P1. Distribution plot  \ndistribution <- cdc |>\n  mutate(\n    access_category = case_when(\n      public_access_level %in% c(\"public\", \"public domain\") ~ \"Public Access\",\n      public_access_level == \"restricted public\" ~ \"Restricted Access\",\n      public_access_level == \"non-public\" ~ \"No Public Access\",\n      TRUE ~ \"Unspecified\"\n    )\n  ) |>\n  count(access_category) |>\n  mutate(\n    pct = n / sum(n) * 100,\n    label = sprintf(\"%.1f%%\\n(n=%d)\", pct, n),\n    # Conditional hjust and color based on count\n    hjust = ifelse(n > 200, 1.2, -0.2),\n    label_color = ifelse(n > 200, \"white\", \"gray30\")\n  )\n\n# P2. Timeline plot\ntimeline_data <- cdc |>\n  mutate(\n    access_category = case_when(\n      public_access_level %in% c(\"public\", \"public domain\") ~ \"Public Access\",\n      public_access_level == \"restricted public\" ~ \"Restricted Access\",\n      public_access_level == \"non-public\" ~ \"No Public Access\",\n      TRUE ~ \"Unspecified\"\n    ),\n    issued = as.Date(issued)\n  ) |>\n  filter(!is.na(issued)) |>\n  arrange(issued) |>\n  group_by(access_category) |>\n  mutate(cumulative = row_number()) |>\n  ungroup()\n\n# Find the inflection point around 2020\ninflection_date <- as.Date(\"2020-04-01\")\n```\n:::\n\n\n\n#### 5. Visualization Parameters\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot aesthetics ----\n# Get base colors with custom palette\ncolors <- get_theme_colors(\n    palette = c(\n        \"Public Access\"     = \"#3498DB\",      \n        \"Restricted Access\" = \"#E67E22\",   \n        \"No Public Access\"  = \"#C0392B\",    \n        \"Unspecified\"       = \"#7F8C8D\" \n    )\n)\n\n### |-  titles and caption ----\ntitle_text <- str_glue(\"CDC Dataset Purge: A Timeline of Public Health Data Removal\")\nsubtitle_text <- str_glue(\"Analysis of CDC datasets backed up on archive.org during the Trump administration's data purge\")\n\n# Create caption\ncaption_text <- create_social_caption(\n    tt_year = 2025,\n    tt_week = 06,\n    source_text = \"archive.org/details/20250128-cdc-datasets\"\n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n    base_theme,\n    theme(\n        # Axis elements\n        axis.title = element_text(color = colors$text, size = rel(0.8)),\n        axis.text = element_text(color = colors$text, size = rel(0.7)),\n        \n        # Grid elements\n        panel.grid.minor = element_blank(),\n        panel.grid.major = element_line(color = \"grey80\", linewidth = 0.1),\n        \n        # Legend elements\n        legend.position = \"right\",\n        legend.title = element_text(family = fonts$text, size = rel(0.8)),\n        legend.text = element_text(family = fonts$text, size = rel(0.7)),\n        \n        # Plot margins \n        plot.margin = margin(t = 10, r = 10, b = 10, l = 10),\n\n    )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n```\n:::\n\n\n\n#### 6. Plot \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  Plot ----\n\n# P1. Distribution plot \np1 <- ggplot(distribution,\n             aes(x = reorder(access_category, n), \n                 y = n, \n                 fill = access_category)\n) +\n    \n    # Geoms\n    geom_col() +\n    geom_text(\n        aes(label = label,\n            hjust = hjust,\n            color = label_color),\n        size = 3.5,\n        fontface = \"bold\",\n        family = fonts$text\n    ) +\n    coord_flip() +\n    \n    # Scales\n    scale_fill_manual(values = colors$palette) +\n    scale_color_identity() +  \n    scale_x_discrete() +\n    scale_y_continuous(\n        expand = expansion(mult = c(0, 0.25)) \n    ) +\n    \n    # Labs\n    labs(\n        title = \"Distribution of Dataset Access Levels\",\n        x = NULL,\n        y = \"Number of Datasets\"\n    ) +\n    \n    # Theme\n    theme(\n        legend.position = \"none\",\n        panel.grid.major.y = element_blank(),\n        \n        plot.title = element_text(\n            size   = rel(1.3),\n            family = fonts$title,\n            face   = \"bold\",\n            color  = colors$title,\n            lineheight = 1.1,\n            margin = margin(t = 5, b = 5)\n        )\n    )\n\n# P2. Timeline plot with enhancements\np2 <- ggplot(timeline_data,\n             aes(x = issued, \n                 y = cumulative, \n                 fill = access_category)\n) +\n    # Rectangle\n    annotate(\n        \"rect\",\n        xmin = inflection_date,\n        xmax = max(timeline_data$issued),\n        ymin = 0,\n        ymax = max(timeline_data$cumulative),\n        fill = \"gray85\",\n        alpha = 0.3\n    ) +\n    \n    # Geoms\n    geom_area(alpha = 0.8) +\n    geom_line(color = \"white\", linewidth = 0.5) +\n    geom_vline(\n        xintercept = inflection_date, \n        linetype = \"dashed\", \n        color = colors$caption,\n        alpha = 0.7\n    ) +\n    # Note\n    annotate(\n        \"text\", \n        x = inflection_date,\n        y = max(timeline_data$cumulative) * 0.9,\n        label = \"Notable increase in\\narchival activity\",\n        hjust = -0.1,\n        size = 3.5,\n        color = colors$caption,\n        family = fonts$caption\n    ) +\n    \n    # Scales\n    scale_fill_manual(values = colors$palette) +\n    scale_x_date(\n        date_breaks = \"1 year\",\n        date_labels = \"%Y\",\n    ) +\n    scale_y_continuous(\n        expand = expansion(mult = c(0, 0.1)),\n        breaks = function(x) seq(0, max(x), by = 50)\n    ) +\n    \n    # Labs\n    labs(\n        title = \"Cumulative Growth of Archived Datasets\",\n        subtitle = sprintf(\"Note: Only %d out of %d datasets (%.1f%%) have valid dates\",\n                           sum(!is.na(cdc$issued)),\n                           nrow(cdc),\n                           100 * sum(!is.na(cdc$issued)) / nrow(cdc)),\n        x = \"Year\",\n        y = \"Number of Datasets\"\n    ) +\n    \n    # Theme\n    theme(\n        legend.position = \"top\",\n        legend.title = element_blank(),\n        legend.spacing.x = unit(0.2, \"cm\"),\n        panel.grid.minor = element_blank(),\n        panel.grid.major.x = element_blank(),\n        \n        plot.title = element_text(\n            size = rel(1.3),\n            family = fonts$title,\n            face = \"bold\",\n            color = colors$title,\n            lineheight = 1.1,\n            margin = margin(t = 5, b = 5)\n        ),\n        plot.subtitle = element_text(\n            size = rel(0.9),\n            family = fonts$caption,\n            color = colors$caption,\n            margin = margin(b = 10)\n        ),\n        axis.title = element_text(\n            size = rel(0.9),\n            family = fonts$caption,\n            color = colors$caption\n        ),\n    )\n\n# Combine plots \ncombined_plot <- (p1 / p2) +\n    plot_layout(heights = c(0.8, 1.2)) \n\ncombined_plot <- combined_plot +\n    plot_annotation(\n        title = title_text,\n        subtitle = subtitle_text,\n        caption = caption_text, \n        theme = theme(\n            plot.title = element_text(\n                size   = rel(1.75),\n                family = fonts$title,\n                face   = \"bold\",\n                color  = colors$title,\n                lineheight = 1.1,\n                margin = margin(t = 5, b = 5)\n            ),   \n            plot.subtitle = element_text(\n                size   = rel(0.9),\n                family = fonts$subtitle,\n                color  = colors$subtitle,\n                lineheight = 1.2,\n                margin = margin(t = 5, b = 5)\n            ), \n            plot.caption = element_markdown(\n                size   = rel(0.6),\n                family = fonts$caption,\n                color  = colors$caption,\n                hjust  = 0.5,\n                margin = margin(t = 10)\n            ),\n            plot.margin = margin(t = 20, r = 10, b = 20, l = 10),\n        )\n    )\n```\n:::\n\n\n\n#### 7. Save\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n### |-  plot image ----  \n\nsave_plot_patchwork(\n  plot = combined_plot, \n  type = \"tidytuesday\", \n  year = 2025, \n  week = 6, \n  width = 10,\n  height = 10\n)\n```\n:::\n\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 22631)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] camcorder_0.1.0 patchwork_1.3.0 here_1.0.1      glue_1.8.0     \n [5] scales_1.3.0    skimr_2.1.5     janitor_2.2.0   showtext_0.9-7 \n [9] showtextdb_3.0  sysfonts_0.8.9  ggtext_0.1.2    lubridate_1.9.3\n[13] forcats_1.0.0   stringr_1.5.1   dplyr_1.1.4     purrr_1.0.2    \n[17] readr_2.1.5     tidyr_1.3.1     tibble_3.2.1    ggplot2_3.5.1  \n[21] tidyverse_2.0.0 pacman_0.5.1   \n\nloaded via a namespace (and not attached):\n [1] tidyselect_1.2.1   farver_2.1.2       fastmap_1.2.0      gh_1.4.1          \n [5] digest_0.6.37      timechange_0.3.0   lifecycle_1.0.4    rsvg_2.6.1        \n [9] magrittr_2.0.3     compiler_4.4.0     rlang_1.1.4        tools_4.4.0       \n[13] utf8_1.2.4         yaml_2.3.10        knitr_1.49         labeling_0.4.3    \n[17] htmlwidgets_1.6.4  bit_4.5.0          curl_6.0.0         xml2_1.3.6        \n[21] repr_1.1.7         tidytuesdayR_1.1.2 withr_3.0.2        grid_4.4.0        \n[25] fansi_1.0.6        colorspace_2.1-1   gitcreds_0.1.2     cli_3.6.3         \n[29] rmarkdown_2.29     crayon_1.5.3       generics_0.1.3     rstudioapi_0.17.1 \n[33] tzdb_0.4.0         commonmark_1.9.2   parallel_4.4.0     ggplotify_0.1.2   \n[37] base64enc_0.1-3    vctrs_0.6.5        yulab.utils_0.1.8  jsonlite_1.8.9    \n[41] gridGraphics_0.5-1 hms_1.1.3          bit64_4.5.2        systemfonts_1.1.0 \n[45] magick_2.8.5       gifski_1.32.0-1    codetools_0.2-20   stringi_1.8.4     \n[49] gtable_0.3.6       munsell_0.5.1      pillar_1.9.0       rappdirs_0.3.3    \n[53] htmltools_0.5.8.1  R6_2.5.1           httr2_1.0.6        rprojroot_2.0.4   \n[57] vroom_1.6.5        evaluate_1.0.1     markdown_1.13      gridtext_0.1.5    \n[61] snakecase_0.11.1   renv_1.0.3         Rcpp_1.0.13-1      svglite_2.1.3     \n[65] xfun_0.49          fs_1.6.5           pkgconfig_2.0.3   \n```\n\n\n:::\n:::\n\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`tt_2025_06.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/TidyTuesday/2025/tt_2025_06.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n\n#### 10. References\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1. Data Sources:\n   - TidyTuesday 2025 Week 06: [CDC Datasets](https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/2025-02-11)\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}