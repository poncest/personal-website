{
  "hash": "803bdbb9693b0f76dcbd277ee099462a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Recipe Complexity Correlates with Higher Ratings\"\nsubtitle: \"Analysis of 14,426 AllRecipes.com recipes shows consistent rating patterns\"\ndescription: \"A heat map analysis revealing that recipe complexity—measured by ingredient count and cooking time—correlates with higher user ratings across 14,426 AllRecipes.com recipes. The visualization shows a clear pattern where more complex recipes consistently achieve better ratings.\"\nauthor: \"Steven Ponce\"\ndate: \"2025-09-14\" \ncategories: [\"TidyTuesday\", \"Data Visualization\", \"R Programming\", \"2025\"]\ntags: [\n  \"recipe-analysis\",\n  \"heat-map\", \n  \"correlation-analysis\",\n  \"cooking-data\",\n  \"food-ratings\",\n  \"complexity-patterns\",\n  \"allrecipes\",\n  \"ggplot2\",\n  \"data-mining\"\n]\nimage: \"thumbnails/tt_2025_37.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n    theme: \n      light: [flatly, assets/styling/custom_styles.scss]\n      dark: [darkly, assets/styling/custom_styles_dark.scss]\neditor_options: \n  chunk_output_type: inline\nexecute: \n  freeze: true                                    \n  cache: true                                       \n  error: false\n  message: false\n  warning: false\n  eval: true\n---\n\n![Heat map showing recipe ratings by complexity, with cooking time on y-axis (≤30 min to 4+ hours) and ingredient count on x-axis (1-5 to 20+ ingredients). Color scale from dark blue (4.45 rating) to light green (4.63 rating) reveals higher ratings for recipes with more ingredients and longer cooking times. Each cell shows the average rating and recipe count from 14,426 AllRecipes.com recipes.](tt_2025_37.png){#fig-1}\n\n### <mark> **Steps to Create this Graphic** </mark>\n\n#### 1. Load Packages & Setup\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: load\n#| warning: false\n#| message: false\n#| results: \"hide\"\n\n## 1. LOAD PACKAGES & SETUP ----\nsuppressPackageStartupMessages({\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\n    tidyverse,   # Easily Install and Load the 'Tidyverse'\n    ggtext,      # Improved Text Rendering Support for 'ggplot2'\n    showtext,    # Using Fonts More Easily in R Graphs\n    janitor,     # Simple Tools for Examining and Cleaning Dirty Data\n    scales,      # Scale Functions for Visualization\n    glue,        # Interpreted String Literals,\n    viridis      # Colorblind-Friendly Color Maps for R\n  )})\n\n### |- figure size ----\ncamcorder::gg_record(\n  dir    = here::here(\"temp_plots\"),\n  device = \"png\",\n  width  = 8,\n  height = 8,\n  units  = \"in\",\n  dpi    = 300\n)\n\n# Source utility functions\nsuppressMessages(source(here::here(\"R/utils/fonts.R\")))\nsource(here::here(\"R/utils/social_icons.R\"))\nsource(here::here(\"R/utils/image_utils.R\"))\nsource(here::here(\"R/themes/base_theme.R\"))\n```\n````\n:::\n\n\n#### 2. Read in the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: read\n#| include: true\n#| eval: true\n#| warning: false\n\ntt <- tidytuesdayR::tt_load(2025, week = 37)\n\nall_recipes <- tt$all_recipes |> clean_names()\ncuisines <- tt$cuisines |> clean_names()\n\ntidytuesdayR::readme(tt)\nrm(tt)\n```\n````\n:::\n\n\n#### 3. Examine the Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: examine\n#| include: true\n#| eval: true\n#| results: 'hide'\n#| warning: false\n\nglimpse(all_recipes)\nglimpse(cuisines)\n```\n````\n:::\n\n\n#### 4. Tidy Data\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: tidy\n#| warning: false\n\ncomplexity_analysis <- all_recipes |>\n  # Drop rows with missing key fields\n  filter(\n    !is.na(ingredients),\n    !is.na(prep_time),\n    !is.na(cook_time),\n    !is.na(avg_rating)\n  ) |>\n  mutate(\n    # Count ingredients (#commas + 1)\n    ingredient_count = str_count(ingredients, \",\") + 1,\n\n    # Bin total time (minutes)\n    total_time_binned = cut(\n      total_time,\n      breaks = c(0, 30, 60, 120, 240, Inf),\n      labels = c(\"≤30 min\", \"31-60 min\", \"1-2 hours\", \"2-4 hours\", \"4+ hours\"),\n      include.lowest = TRUE\n    ),\n\n    # Bin ingredient count\n    ingredient_binned = cut(\n      ingredient_count,\n      breaks = c(0, 5, 10, 15, 20, Inf),\n      labels = c(\"1-5\", \"6-10\", \"11-15\", \"16-20\", \"20+\"),\n      include.lowest = TRUE\n    )\n  ) |>\n  # Keep only rows with valid bins\n  filter(!is.na(total_time_binned), !is.na(ingredient_binned)) |>\n  # Aggregate by bins\n  group_by(total_time_binned, ingredient_binned) |>\n  summarise(\n    avg_rating = mean(avg_rating, na.rm = TRUE),\n    recipe_count = n(),\n    median_rating = median(avg_rating, na.rm = TRUE),\n    .groups = \"drop\"\n  ) |>\n  # Keep cells with ≥10 recipes\n  filter(recipe_count >= 10)\n```\n````\n:::\n\n\n#### 5. Visualization Parameters\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: params\n#| include: true\n#| warning: false\n\n### |-  plot aesthetics ----\n# Get basic theme colors\ncolors <- get_theme_colors()\n\n### |- titles and caption ----\ntitle_text <- str_glue(\"Recipe Complexity Correlates with Higher Ratings\")\n\nsubtitle_text <- str_glue(\n  \"Analysis of **14,426 AllRecipes.com recipes** shows consistent rating patterns<br><br>\",\n  \"Cells show average rating and recipe count• Color scale = observed range: 4.45-4.63\"\n)\n\ncaption_text <- create_social_caption(\n  tt_year = 2025,\n  tt_week = 37,\n  source_text = \"tastyR (AllRecipes.com)\"\n)\n\n### |-  fonts ----\nsetup_fonts()\nfonts <- get_font_families()\n\n### |-  plot theme ----\n# Start with base theme\nbase_theme <- create_base_theme(colors)\n\n# Add weekly-specific theme elements\nweekly_theme <- extend_weekly_theme(\n  base_theme,\n  theme(\n    # Text styling\n    plot.title = element_text(face = \"bold\", family = fonts$title, size = rel(1.2), color = colors$title, margin = margin(b = 10)),\n    plot.subtitle = element_text(family = fonts$subtitle, lineheight = 1.2, color = colors$subtitle, size = rel(0.78), margin = margin(b = 20)),\n\n    # Axis elements\n    axis.line = element_blank(),\n    axis.ticks = element_blank(),\n\n    # Grid elements\n    panel.grid.major = element_line(color = \"gray90\", linetype = \"solid\", linewidth = 0.3),\n    # panel.grid.major.y = element_blank(),\n    panel.grid.minor.x = element_blank(),\n    panel.grid.minor.y = element_blank(),\n\n    # Axis elements\n    axis.text = element_text(color = colors$text, size = rel(0.7)),\n    axis.title.x = element_text(color = colors$text, face = \"bold\", size = rel(0.8), margin = margin(t = 15)),\n    axis.title.y = element_text(color = colors$text, face = \"bold\", size = rel(0.8), margin = margin(r = 10)),\n\n    # Legend elements\n    legend.position = \"right\",\n    legend.title = element_text(family = fonts$tsubtitle, color = colors$text, size = rel(0.8), face = \"bold\"),\n    legend.text = element_text(family = fonts$tsubtitle, color = colors$text, size = rel(0.7)),\n    legend.margin = margin(t = 15),\n\n    # Plot margin\n    plot.margin = margin(t = 15, r = 15, b = 15, l = 15),\n  )\n)\n\n# Set theme\ntheme_set(weekly_theme)\n\n# Viz parameters for heatmap color scale \n\n# Min and max observed average ratings\nr_min <- min(complexity_analysis$avg_rating, na.rm = TRUE)\nr_max <- max(complexity_analysis$avg_rating, na.rm = TRUE)\n\n# Padding to avoid clipping at legend edges\npad   <- 0.005\n\n# Scale limits (min/max + padding)\nlimits <- c(r_min - pad, r_max + pad)\n\n# Midpoint (useful for diverging palettes)\nr_mid <- mean(limits)\n```\n````\n:::\n\n\n#### 6. Plot\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: plot\n#| warning: false\n\n### |-  Final plot ----\np <- complexity_analysis |>\n  ggplot(aes(x = ingredient_binned, y = total_time_binned, fill = avg_rating)) +\n\n  # Geoms\n  geom_tile(color = \"white\", linewidth = 0.6) +\n  geom_text(\n    aes(\n      label = paste0(sprintf(\"%.2f\", avg_rating), \"\\n(n=\", comma(recipe_count), \")\"),\n      color = ifelse(avg_rating <= r_mid, \"white\", \"#1a1a1a\")\n    ),\n    fontface = \"bold\", size = 3.2, lineheight = 0.9, show.legend = FALSE\n  ) +\n\n  # Scales\n  scale_color_identity() +\n  scale_fill_viridis_c(\n    option = \"mako\",\n    limits = limits,\n    oob = squish,\n    breaks = pretty_breaks(4),\n    labels = number_format(accuracy = 0.01),\n    name = \"Average Rating\"\n  ) +\n\n  # Labs\n  labs(\n    title = title_text,\n    subtitle = subtitle_text,\n    caption = caption_text,\n    x = \"Number of Ingredients\",\n    y = \"Total Cooking Time\",\n  ) +\n\n  # Theme\n  theme(\n    panel.grid = element_blank(),\n    legend.title = element_text(size = 10, face = \"bold\"),\n    legend.key.width = unit(0.7, \"cm\"),\n    legend.key.height = unit(1.0, \"cm\"),\n    plot.title = element_text(\n      size = rel(1.4),\n      family = fonts$title,\n      face = \"bold\",\n      color = colors$title,\n      lineheight = 1.1,\n      margin = margin(t = 5, b = 5)\n    ),\n    plot.subtitle = element_markdown(\n      size = rel(0.80),\n      family = fonts$subtitle,\n      color = alpha(colors$subtitle, 0.9),\n      lineheight = 1.2,\n      margin = margin(t = 5, b = 10)\n    ),\n    plot.caption = element_markdown(\n      size = rel(0.55),\n      family = fonts$caption,\n      color = colors$caption,\n      hjust = 0.5,\n      margin = margin(t = 10)\n    )\n  )\n```\n````\n:::\n\n\n#### 7. Save\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| label: save\n#| warning: false\n\n### |-  plot image ----  \nsave_plot(\n  plot = p, \n  type = \"tidytuesday\", \n  year = 2025, \n  week = 37, \n  width  = 8,\n  height = 8\n  )\n```\n````\n:::\n\n\n#### 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 22631)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] here_1.0.1        viridis_0.6.5     viridisLite_0.4.2 glue_1.8.0       \n [5] scales_1.3.0      janitor_2.2.0     showtext_0.9-7    showtextdb_3.0   \n [9] sysfonts_0.8.9    ggtext_0.1.2      lubridate_1.9.3   forcats_1.0.0    \n[13] stringr_1.5.1     dplyr_1.1.4       purrr_1.0.2       readr_2.1.5      \n[17] tidyr_1.3.1       tibble_3.2.1      ggplot2_3.5.1     tidyverse_2.0.0  \n[21] pacman_0.5.1     \n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.6       httr2_1.0.6        xfun_0.49          htmlwidgets_1.6.4 \n [5] gh_1.4.1           tzdb_0.5.0         vctrs_0.6.5        tools_4.4.0       \n [9] generics_0.1.3     parallel_4.4.0     curl_6.0.0         gifski_1.32.0-1   \n[13] fansi_1.0.6        pkgconfig_2.0.3    lifecycle_1.0.4    farver_2.1.2      \n[17] compiler_4.4.0     textshaping_0.4.0  munsell_0.5.1      codetools_0.2-20  \n[21] snakecase_0.11.1   htmltools_0.5.8.1  yaml_2.3.10        crayon_1.5.3      \n[25] pillar_1.9.0       camcorder_0.1.0    magick_2.8.5       commonmark_1.9.2  \n[29] tidyselect_1.2.1   digest_0.6.37      stringi_1.8.4      rsvg_2.6.1        \n[33] rprojroot_2.0.4    fastmap_1.2.0      grid_4.4.0         colorspace_2.1-1  \n[37] cli_3.6.4          magrittr_2.0.3     utf8_1.2.4         withr_3.0.2       \n[41] rappdirs_0.3.3     bit64_4.5.2        timechange_0.3.0   rmarkdown_2.29    \n[45] tidytuesdayR_1.1.2 gitcreds_0.1.2     bit_4.5.0          gridExtra_2.3     \n[49] ragg_1.3.3         hms_1.1.3          evaluate_1.0.1     knitr_1.49        \n[53] markdown_1.13      rlang_1.1.6        gridtext_0.1.5     Rcpp_1.0.13-1     \n[57] xml2_1.3.6         renv_1.0.3         vroom_1.6.5        svglite_2.1.3     \n[61] rstudioapi_0.17.1  jsonlite_1.8.9     R6_2.5.1           systemfonts_1.1.0 \n```\n\n\n:::\n:::\n\n:::\n\n#### 9. GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`tt_2025_37.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/TidyTuesday/2025/tt_2025_37.qmd).\n\nFor the full repository, [click here](https://github.com/poncest/personal-website/).\n:::\n\n#### 10. References\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for References\n\n1.  Data Sources:\n\n-   TidyTuesday 2025 Week 36: \\[Allrecipes Data\\](https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/2025-09-16\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}