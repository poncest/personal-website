---
title: "Small Nations Lead in Roundabout Adoption"
subtitle: "Per capita analysis of countries with 10+ roundabouts shows New Zealand and Sweden clearly leading. Despite having 12,952 roundabouts, the USA sits near the median of these countries once population is accounted for (39 per million people)." 
description: "Analyzing global roundabout adoption patterns through population-adjusted metrics reveals an unexpected story: small nations dominate per capita rankings while the USA's massive infrastructure count becomes average when normalized."
date: "2025-12-14"
author:
  - name: "Steven Ponce"
    url: "https://stevenponce.netlify.app"
citation:
  url: "https://stevenponce.netlify.app/data_visualizations/TidyTuesday/2025/tt_2025_50.html" 
categories: ["TidyTuesday", "Data Visualization", "R Programming", "2025"]
tags: [
  "Roundabouts",
  "Infrastructure",
  "Per Capita Analysis",
  "Population Normalization",
  "Comparative Statistics",
  "Scatter Plot",
  "Log Scale",
  "Global Comparison",
  "New Zealand",
  "Sweden",
  "USA",
  "ggplot2",
  "ggrepel",
  "World Bank Data"
]
image: "thumbnails/tt_2025_50.png"
format:
  html:
    toc: true
    toc-depth: 5
    code-link: true
    code-fold: true
    code-tools: true
    code-summary: "Show code"
    self-contained: true
    theme: 
      light: [flatly, assets/styling/custom_styles.scss]
      dark: [darkly, assets/styling/custom_styles_dark.scss]
editor_options: 
  chunk_output_type: inline
execute: 
  freeze: true                                    
  cache: true                                       
  error: false
  message: false
  warning: false
  eval: true
---

![Scatter plot showing roundabouts per million people versus population (log scale) for 13 countries. New Zealand leads at ~165 per million, followed by Sweden (~147) and Australia (~137). Although the USA has the highest total number of roundabouts at 12,952 (represented by the largest bubble on the plot), it ranks near the median with only 39 roundabouts per million residents due to its large population. In contrast, smaller nations consistently demonstrate higher per capita adoption rates of roundabouts.](tt_2025_50.png){#fig-1}

### <mark> **Steps to Create this Graphic** </mark>

#### 1. Load Packages & Setup

```{r}
#| label: load
#| warning: false
#| message: false      
#| results: "hide"     

## 1. LOAD PACKAGES & SETUP ----
suppressPackageStartupMessages({
if (!require("pacman")) install.packages("pacman")
pacman::p_load(
    tidyverse,     # Easily Install and Load the 'Tidyverse'
    ggtext,        # Improved Text Rendering Support for 'ggplot2'
    showtext,      # Using Fonts More Easily in R Graphs
    janitor,       # Simple Tools for Examining and Cleaning Dirty Data
    scales,        # Scale Functions for Visualization
    glue,          # Interpreted String Literals
    ggrepel        # Automatically Position Non-Overlapping Text Labels
)
})

### |- figure size ----
camcorder::gg_record(
  dir    = here::here("temp_plots"),
  device = "png",
  width  = 12,
  height = 10,
  units  = "in",
  dpi    = 320
)

# Source utility functions
suppressMessages(source(here::here("R/utils/fonts.R")))
source(here::here("R/utils/social_icons.R"))
source(here::here("R/utils/image_utils.R"))
source(here::here("R/themes/base_theme.R"))
```

#### 2. Read in the Data

```{r}
#| label: read
#| include: true
#| eval: true
#| warning: false

tt <- tidytuesdayR::tt_load(2025, week = 50)

roundabouts <- tt$roundabouts_clean |> clean_names()

tidytuesdayR::readme(tt)
rm(tt)
```

#### 3. Examine the Data

```{r}
#| label: examine
#| include: true
#| eval: true
#| results: 'hide'
#| warning: false

glimpse(roundabouts)
skimr::skim(roundabouts) |> summary()
```

#### 4. Tidy Data

```{r}
#| label: tidy-fixed
#| warning: false

### |-  Clean roundabouts data ----
roundabouts_clean <- roundabouts |>
  clean_names() |>
  mutate(
    # Standardize country names
    country = case_when(
      country == "United States" ~ "USA",
      country == "United Kingdom" ~ "UK",
      TRUE ~ country
    )
  )

### |-  Population data for normalization ----
# Source: World Bank Open Data (data.worldbank.org/indicator/SP.POP.TOTL)
# 2024 estimates - Selected countries with 10+ roundabouts for meaningful comparison
country_populations <- tibble(
  country = c(
    "USA", "Australia", "UK", "Sweden", "Canada",
    "New Zealand", "Netherlands", "Norway", "France",
    "Russia", "Japan", "Poland", "Croatia"
  ),
  population_millions = c(
    336.7, 27.0, 68.3, 10.6, 39.7,
    5.3, 18.0, 5.6, 68.2,
    143.5, 123.3, 36.6, 3.9
  )
)

### |-  Calculate per capita rates ----
per_capita_analysis <- roundabouts_clean |>
  count(country, name = "total_roundabouts") |>
  inner_join(country_populations, by = "country") |>
  mutate(
    per_million = total_roundabouts / population_millions,
    # Categorize for emphasis
    highlight = case_when(
      per_million > 100 ~ "High adopters",
      per_million > 30 ~ "Moderate adopters",
      TRUE ~ "Lower adopters"
    ),
    highlight = factor(
      highlight,
      levels = c("High adopters", "Moderate adopters", "Lower adopters")
    )
  ) |>
  arrange(desc(per_million))

# Median reference
median_per_million <- median(per_capita_analysis$per_million)

median_label <- glue(
  "Median among\nshown countries â‰ˆ {round(median_per_million, 1)}\nroundabouts per million"
)
```

#### 5. Visualization Parameters

```{r}
#| label: params
#| include: true
#| warning: false

### |-  plot aesthetics ----
colors <- get_theme_colors(
    palette = list(
        high  = "#004F6E",
        moderate = "#2A7F9E", 
        lower  = "#C4CBD3"
    )
)

### |- titles and caption ----
title_text <- "Small Nations Lead in Roundabout Adoption"

subtitle_text <- glue(
    "Per capita analysis of countries with 10+ roundabouts shows ",
    "**New Zealand** and **Sweden** clearly leading, and circle size represents<br>",
    "the total number of roundabouts. Despite having 12,952 roundabouts, the **USA** sits near the median ",
    "of these countries once population<br>",
    "is accounted for (39 per million people)."
)

caption_text <- create_social_caption(
    tt_year = 2025,
    tt_week = 50,
    source_text = paste(
        "Roundabout counts: Kittelson & Associates via { roundabouts } package.<br>",
        "Population: World Bank Open Data (2024 estimates)."
    )
)

### |-  fonts ----
setup_fonts()
fonts <- get_font_families()

### |-  plot theme ----
# Start with base theme
base_theme <- create_base_theme(colors)

# Add weekly-specific theme elements
weekly_theme <- extend_weekly_theme(
  base_theme,
  theme(
    # Text styling
    plot.title = element_markdown(
      face = "bold", family = fonts$title, size = rel(1.4),
      color = colors$title, margin = margin(b = 10), hjust = 0
    ),
    plot.subtitle = element_markdown(
      face = "italic", family = fonts$subtitle, lineheight = 1.2,
      color = colors$subtitle, size = rel(0.9), margin = margin(b = 20), hjust = 0
    ),

    # Grid
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.major = element_line(color = "gray90", linewidth = 0.25),

    # Axes
    axis.title = element_text(size = rel(0.8), color = "gray30"),
    axis.text = element_text(color = "gray30"),
    axis.text.y = element_text(size = rel(0.85)),
    axis.ticks = element_blank(),

    # Facets
    strip.background = element_rect(fill = "gray95", color = NA),
    strip.text = element_text(
      face = "bold",
      color = "gray20",
      size = rel(0.9),
      margin = margin(t = 6, b = 4)
    ),
    panel.spacing = unit(1.5, "lines"),

    # Legend elements
    legend.position = "plot",
    legend.title = element_text(
      family = fonts$subtitle,
      color = colors$text, size = rel(0.8), face = "bold"
    ),
    legend.text = element_text(
      family = fonts$tsubtitle,
      color = colors$text, size = rel(0.7)
    ),
    legend.margin = margin(t = 15),

    # Plot margin
    plot.margin = margin(20, 20, 20, 20)
  )
)

# Set theme
theme_set(weekly_theme)
```

#### 6. Plot

```{r}
#| label: plot
#| warning: false

### |-  main plot ----
p <- ggplot() +
  # Geoms
  geom_hline(
    yintercept = median_per_million,
    linetype = "dashed",
    color = "gray55",
    linewidth = 0.4
  ) +
  geom_point(
    data = per_capita_analysis |> filter(highlight == "Lower adopters"),
    aes(
      x = population_millions, y = per_million,
      size = total_roundabouts, fill = highlight
    ),
    shape = 21, color = "white", alpha = 0.75, stroke = 0.5
  ) +
  geom_point(
    data = per_capita_analysis |> filter(highlight == "Moderate adopters"),
    aes(
      x = population_millions, y = per_million,
      size = total_roundabouts, fill = highlight
    ),
    shape = 21, color = "white", alpha = 0.9, stroke = 0.6
  ) +
  geom_point(
    data = per_capita_analysis |> filter(highlight == "High adopters"),
    aes(
      x = population_millions, y = per_million,
      size = total_roundabouts, fill = highlight
    ),
    shape = 21, color = "white", alpha = 1, stroke = 0.7
  ) +
  geom_text_repel(
    data = per_capita_analysis,
    aes(
      x = population_millions,
      y = per_million,
      label = country,
      color = highlight
    ),
    size = 3.2,
    family = fonts$text,
    fontface = "bold",
    max.overlaps = 20,
    min.segment.length = 0,
    box.padding = 0.5,
    point.padding = 16.45,
    nudge_x = 0.02,
    force = 0.2,
    seed = 123
  ) +
  # Annotate
  annotate(
    "text",
    x = 6, y = median_per_million + 5,
    label = median_label,
    family = fonts$text,
    size = 3,
    hjust = 0,
    vjust = 0,
    color = "gray40"
  ) +
  # Scales
  scale_fill_manual(
    name = "Adoption\nlevel",
    values = c(
      "High adopters" = colors$palette$high,
      "Moderate adopters" = colors$palette$moderate,
      "Lower adopters" = colors$palette$lower
    )
  ) +
  scale_color_manual(
    name = "Adoption\nlevel",
    values = c(
      "High adopters" = colors$palette$high,
      "Moderate adopters" = colors$palette$moderate,
      "Lower adopters" = colors$palette$lower
    )
  ) +
  scale_size_continuous(
    name = "Total\nroundabouts",
    range = c(2.5, 14),
    breaks = c(500, 2500, 5000, 10000),
    labels = label_comma()
  ) +
  scale_x_log10(
    labels = label_comma(),
    breaks = c(5, 10, 25, 50, 100, 200, 300)
  ) +
  scale_y_continuous(
    labels = label_number(accuracy = 1),
    breaks = seq(0, 200, 50),
    limits = c(0, 175),
    expand = expansion(mult = c(0.05, 0.1))
  ) +
  # Labs
  labs(
    title = title_text,
    subtitle = subtitle_text,
    caption = caption_text,
    x = "Population (millions, log scale)",
    y = "Roundabouts per million people"
  ) +
  # Guides
  guides(
    fill = guide_legend(
      order = 1,
      nrow = 1,
      title.vjust = 0.8,
      override.aes = list(
        shape = 21,
        size = 5,
        stroke = 0.7,
        color = "grey40"
      )
    ),
    size = guide_legend(
      order = 2,
      nrow = 1,
      title.vjust = 0.8,
      override.aes = list(
        shape = 21,
        color = "grey40",
        fill  = "white",
        alpha = 1
      )
    ),
    color = "none"
  ) +
  # Theme
  theme(
    plot.title = element_markdown(
      size = rel(2.3),
      family = fonts$title,
      face = "bold",
      color = colors$title,
      lineheight = 1.15,
      margin = margin(t = 8, b = 5)
    ),
    plot.subtitle = element_markdown(
      size = rel(0.9),
      family = fonts$subtitle,
      color = alpha(colors$subtitle, 0.88),
      lineheight = 1.5,
      margin = margin(t = 5, b = 20)
    ),
    plot.caption = element_markdown(
      size = rel(0.65),
      family = fonts$subtitle,
      color = colors$caption,
      hjust = 0,
      lineheight = 1.4,
      margin = margin(t = 20, b = 5)
    ),
    panel.grid.minor.x = element_blank(),
    panel.grid.major.x = element_blank(),
    legend.position = "bottom",
    legend.box = "horizontal",
    legend.spacing.x = unit(3.5, "lines"),
    legend.box.spacing = unit(0.5, "lines"),
    legend.title = element_text(
      family = fonts$text, size = 9, hjust = 0,
      face = "bold", margin = margin(r = 8)
    ),
    legend.text = element_text(family = fonts$text, size = 9)
  )
```

#### 7. Save

```{r}
#| label: save
#| warning: false

### |-  plot image ----  
save_plot(
  plot = p, 
  type = "tidytuesday", 
  year = 2025, 
  week = 50, 
  width  = 12,
  height = 10,
  )
```

#### 8. Session Info

::: {.callout-tip collapse="true"}
##### Expand for Session Info

```{r, echo = FALSE}
#| eval: true
#| warning: false

sessionInfo()
```
:::

#### 9. GitHub Repository

::: {.callout-tip collapse="true"}
##### Expand for GitHub Repo

The complete code for this analysis is available in [`tt_2025_50.qmd`](https://github.com/poncest/personal-website/blob/master/data_visualizations/TidyTuesday/2025/tt_2025_50.qmd).

For the full repository, [click here](https://github.com/poncest/personal-website/).
:::

#### 10. References

::: {.callout-tip collapse="true"}
##### Expand for References

1.  **Data Source:**
    -   TidyTuesday 2025 Week 50: [Roundabouts across the world](https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/2025-12-16/readme.md)
:::

#### 11. Custom Functions Documentation

::: {.callout-note collapse="true"}
##### ðŸ“¦ Custom Helper Functions

This analysis uses custom functions from my personal module library for efficiency and consistency across projects.

**Functions Used:**

-   **`fonts.R`**: `setup_fonts()`, `get_font_families()` - Font management with showtext
-   **`social_icons.R`**: `create_social_caption()` - Generates formatted social media captions
-   **`image_utils.R`**: `save_plot()` - Consistent plot saving with naming conventions
-   **`base_theme.R`**: `create_base_theme()`, `extend_weekly_theme()`, `get_theme_colors()` - Custom ggplot2 themes

**Why custom functions?**\
These utilities standardize theming, fonts, and output across all my data visualizations. The core analysis (data tidying and visualization logic) uses only standard tidyverse packages.

**Source Code:**\
View all custom functions â†’ [GitHub: R/utils](https://github.com/poncest/personal-website/tree/master/R)
:::
